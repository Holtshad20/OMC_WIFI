[
    {
        "id": "1f35534c8fd78b65",
        "type": "tab",
        "label": "Gestion",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2e9d9a63f5843708",
        "type": "tab",
        "label": "Disp 1",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "6f4784e8cf2fe1e0",
        "type": "tab",
        "label": "Disp 2",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "960c0b986ae7e0fc",
        "type": "tab",
        "label": "Disp 3",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "3b3439c6de64720a",
        "type": "tab",
        "label": "Disp 4",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "e8f647337ed9dae4",
        "type": "tab",
        "label": "Disp 5",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "ae85575a21155d1c",
        "type": "tab",
        "label": "Disp 6",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "2fda3a02bb66fe0f",
        "type": "tab",
        "label": "Disp 7",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "3974a1c708eddb35",
        "type": "tab",
        "label": "Disp 8",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "73be0d245c0caa40",
        "type": "tab",
        "label": "Disp 9",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "3c7bdc336f76b0ee",
        "type": "tab",
        "label": "Disp 10",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "10e78a89.5b4fd5",
        "type": "mqtt-broker",
        "name": "",
        "broker": "localhost",
        "port": "1883",
        "clientid": "",
        "autoConnect": true,
        "usetls": false,
        "protocolVersion": 4,
        "keepalive": "60",
        "cleansession": true,
        "birthTopic": "",
        "birthQos": "0",
        "birthPayload": "",
        "closeTopic": "",
        "closeQos": "0",
        "closePayload": "",
        "willTopic": "",
        "willQos": "0",
        "willPayload": ""
    },
    {
        "id": "e7c46d5e.a1283",
        "type": "ui_tab",
        "name": "Resumen",
        "icon": "view_list",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "cf3f5f32c0b4bf65",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#004080",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#004080",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#333333",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#0066cc",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#004080",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Servidor OMC-WIFI",
            "hideToolbar": "false",
            "allowSwipe": "true",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "11810919457698fb",
        "type": "ui_tab",
        "name": "Dispositivo 1",
        "icon": "power",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "76cd008ee20ad04e",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "11810919457698fb",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "3ef4816e57556e06",
        "type": "ui_tab",
        "name": "Dispositivo 2",
        "icon": "power",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "aa88a6b9707e45ba",
        "type": "ui_tab",
        "name": "Dispositivo 3",
        "icon": "power",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "49fd72d0e249acf0",
        "type": "ui_tab",
        "name": "Dispositivo 4",
        "icon": "power",
        "order": 5,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "369054c763f7fbb4",
        "type": "ui_tab",
        "name": "Dispositivo 6",
        "icon": "power",
        "order": 7,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "0aae13674b884002",
        "type": "ui_tab",
        "name": "Dispositivo 7",
        "icon": "power",
        "order": 8,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "1bdb100ad2433277",
        "type": "ui_tab",
        "name": "Dispositivo 8",
        "icon": "power",
        "order": 9,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "59b7221d5c9bfcc8",
        "type": "ui_tab",
        "name": "Dispositivo 9",
        "icon": "power",
        "order": 10,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "4347d1310f237594",
        "type": "ui_tab",
        "name": "Dispositivo 10",
        "icon": "power",
        "order": 11,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "8a55ae788db337bb",
        "type": "ui_group",
        "name": "Control",
        "tab": "11810919457698fb",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "5dcfa381d1f525d2",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "11810919457698fb",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "c1ddd0629c8a913a",
        "type": "ui_group",
        "name": "Dispositivo 1",
        "tab": "e7c46d5e.a1283",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": true,
        "className": ""
    },
    {
        "id": "3af6d3cba2425ff8",
        "type": "ui_group",
        "name": "Dispositivo 2",
        "tab": "e7c46d5e.a1283",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "f9dfc9a220a82de7",
        "type": "ui_group",
        "name": "Dispositivo 3",
        "tab": "e7c46d5e.a1283",
        "order": 3,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "3ff394bd9036151f",
        "type": "ui_group",
        "name": "Dispositivo 4",
        "tab": "e7c46d5e.a1283",
        "order": 4,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "e00e4fc84f4e1bac",
        "type": "ui_group",
        "name": "Dispositivo 5",
        "tab": "e7c46d5e.a1283",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": true,
        "className": ""
    },
    {
        "id": "753065e3a360957e",
        "type": "ui_group",
        "name": "Dispositivo 6",
        "tab": "e7c46d5e.a1283",
        "order": 6,
        "disp": true,
        "width": "6",
        "collapse": true,
        "className": ""
    },
    {
        "id": "b70cc8a1b4cc3153",
        "type": "ui_group",
        "name": "Dispositivo 7",
        "tab": "e7c46d5e.a1283",
        "order": 7,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "3c08646986b553c8",
        "type": "ui_group",
        "name": "Dispositivo 8",
        "tab": "e7c46d5e.a1283",
        "order": 8,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "7157ec15d9059687",
        "type": "ui_group",
        "name": "Dispositivo 9",
        "tab": "e7c46d5e.a1283",
        "order": 9,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "1ab945836557152a",
        "type": "ui_group",
        "name": "Dispositivo 10",
        "tab": "e7c46d5e.a1283",
        "order": 10,
        "disp": true,
        "width": 6,
        "collapse": true,
        "className": ""
    },
    {
        "id": "a3cb0eccf6244471",
        "type": "ui_tab",
        "name": "Configuración",
        "icon": "settings",
        "order": 12,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "bf378dfbb8ffaa4c",
        "type": "ui_group",
        "name": "Cambiar orden de dispositivos",
        "tab": "a3cb0eccf6244471",
        "order": 2,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "5d454f4b0e2735c2",
        "type": "ui_group",
        "name": "Dispositivos asociados",
        "tab": "a3cb0eccf6244471",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4dc5ab4e1f917121",
        "type": "ui_group",
        "name": "Desvincular dispositivos",
        "tab": "a3cb0eccf6244471",
        "order": 4,
        "disp": true,
        "width": 6,
        "collapse": false,
        "className": ""
    },
    {
        "id": "417b5fa26e929b69",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "11810919457698fb",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "61ff5f682298fe1b",
        "type": "ui_group",
        "name": "Cambiar alias",
        "tab": "a3cb0eccf6244471",
        "order": 3,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8d73273d7f6bf478",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "3ef4816e57556e06",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "8b9036acdf4eec01",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "3ef4816e57556e06",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "fd39813e24d16e68",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "3ef4816e57556e06",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "18679a6dcefc7a0b",
        "type": "ui_group",
        "name": "Control",
        "tab": "3ef4816e57556e06",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bb47073ddf654a81",
        "type": "ui_tab",
        "name": "Dispositivo 5",
        "icon": "power",
        "order": 6,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "fd2c8392ccae51f8",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "aa88a6b9707e45ba",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "fb3d9bd6f82624a7",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "aa88a6b9707e45ba",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "d2d19e7b8177d7e3",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "aa88a6b9707e45ba",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "0fdff6ad838a93ce",
        "type": "ui_group",
        "name": "Control",
        "tab": "aa88a6b9707e45ba",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "7290dfb77542495b",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "49fd72d0e249acf0",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "5f484414b9f44515",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "49fd72d0e249acf0",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "939cd0c9a7b9374b",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "49fd72d0e249acf0",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "9d2fe912f04dd64c",
        "type": "ui_group",
        "name": "Control",
        "tab": "49fd72d0e249acf0",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "e57921436d10361e",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "bb47073ddf654a81",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "6bccdafe79a51bdb",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "bb47073ddf654a81",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "4529b587131fce93",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "bb47073ddf654a81",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "b401245d40a8da5c",
        "type": "ui_group",
        "name": "Control",
        "tab": "bb47073ddf654a81",
        "order": 4,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "f2becaebbb6e7c30",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "369054c763f7fbb4",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "64158f41d5f6a626",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "369054c763f7fbb4",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "6f691cce67042526",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "369054c763f7fbb4",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "e76ceef663ea0328",
        "type": "ui_group",
        "name": "Control",
        "tab": "369054c763f7fbb4",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "576dae3b804b0999",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "0aae13674b884002",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "49021c53a4a9ee9c",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "0aae13674b884002",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "1fa79125485aee1b",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "0aae13674b884002",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "0744241a857645e3",
        "type": "ui_group",
        "name": "Control",
        "tab": "0aae13674b884002",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "abaee78aa0a9f33c",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "1bdb100ad2433277",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "973a4177689d0f28",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "1bdb100ad2433277",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "12de173720176460",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "1bdb100ad2433277",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "20f18e81a018be4e",
        "type": "ui_group",
        "name": "Control",
        "tab": "1bdb100ad2433277",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "73c89f17db2fa1b5",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "59b7221d5c9bfcc8",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "2e4bce2f235fefcf",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "59b7221d5c9bfcc8",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "a83cfdc4d8cb11be",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "59b7221d5c9bfcc8",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "6130d08a9658aecf",
        "type": "ui_group",
        "name": "Control",
        "tab": "59b7221d5c9bfcc8",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "e92599370e509ead",
        "type": "ui_group",
        "name": "Monitoreo 1",
        "tab": "4347d1310f237594",
        "order": 1,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "150693ab317e3c64",
        "type": "ui_group",
        "name": "Monitoreo 2",
        "tab": "4347d1310f237594",
        "order": 2,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "217a93f66d9cc106",
        "type": "ui_group",
        "name": "Monitoreo 3",
        "tab": "4347d1310f237594",
        "order": 3,
        "disp": false,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "bda7e38372e6dfe8",
        "type": "ui_group",
        "name": "Control",
        "tab": "4347d1310f237594",
        "order": 4,
        "disp": true,
        "width": "7",
        "collapse": false,
        "className": ""
    },
    {
        "id": "5e98ca9a980e5866",
        "type": "ui_group",
        "name": "Reinicio",
        "tab": "e7c46d5e.a1283",
        "order": 11,
        "disp": true,
        "width": "6",
        "collapse": false,
        "className": ""
    },
    {
        "id": "ba3293eb3be612dd",
        "type": "ui_spacer",
        "z": "2e9d9a63f5843708",
        "name": "spacer",
        "group": "8a55ae788db337bb",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "a5d14cae0d8039b9",
        "type": "ui_spacer",
        "z": "2e9d9a63f5843708",
        "name": "spacer",
        "group": "8a55ae788db337bb",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "7902ce0640e1d3ce",
        "type": "ui_spacer",
        "z": "960c0b986ae7e0fc",
        "name": "spacer",
        "group": "18679a6dcefc7a0b",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "c0a776453bea7a32",
        "type": "ui_spacer",
        "z": "960c0b986ae7e0fc",
        "name": "spacer",
        "group": "18679a6dcefc7a0b",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "df0a182c9d97c1a9",
        "type": "ui_spacer",
        "z": "3b3439c6de64720a",
        "name": "spacer",
        "group": "9d2fe912f04dd64c",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "7c69408443492de7",
        "type": "ui_spacer",
        "z": "3b3439c6de64720a",
        "name": "spacer",
        "group": "9d2fe912f04dd64c",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "a4b0b2f7d14bf331",
        "type": "ui_spacer",
        "z": "3b3439c6de64720a",
        "name": "spacer",
        "group": "0fdff6ad838a93ce",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "cd7c215a9fd42a49",
        "type": "ui_spacer",
        "z": "3b3439c6de64720a",
        "name": "spacer",
        "group": "0fdff6ad838a93ce",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "96f4829de25627a1",
        "type": "ui_spacer",
        "z": "e8f647337ed9dae4",
        "name": "spacer",
        "group": "b401245d40a8da5c",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "4c47d34a47ac4d19",
        "type": "ui_spacer",
        "z": "e8f647337ed9dae4",
        "name": "spacer",
        "group": "b401245d40a8da5c",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "fb74632fc95f2dee",
        "type": "ui_spacer",
        "z": "ae85575a21155d1c",
        "name": "spacer",
        "group": "e76ceef663ea0328",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "f5ce43be9c392e18",
        "type": "ui_spacer",
        "z": "ae85575a21155d1c",
        "name": "spacer",
        "group": "e76ceef663ea0328",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "195d3663b106c6e9",
        "type": "ui_spacer",
        "z": "2fda3a02bb66fe0f",
        "name": "spacer",
        "group": "0744241a857645e3",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "90a18651085c5c78",
        "type": "ui_spacer",
        "z": "2fda3a02bb66fe0f",
        "name": "spacer",
        "group": "0744241a857645e3",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "b96c2db1e311c8a9",
        "type": "ui_spacer",
        "z": "3974a1c708eddb35",
        "name": "spacer",
        "group": "20f18e81a018be4e",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "d8a6457dafe6f531",
        "type": "ui_spacer",
        "z": "3974a1c708eddb35",
        "name": "spacer",
        "group": "20f18e81a018be4e",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "f350088ac7f55d4c",
        "type": "ui_spacer",
        "z": "73be0d245c0caa40",
        "name": "spacer",
        "group": "6130d08a9658aecf",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "3942b8dd6c43ca85",
        "type": "ui_spacer",
        "z": "73be0d245c0caa40",
        "name": "spacer",
        "group": "6130d08a9658aecf",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "5041dcd6b6fa4e27",
        "type": "ui_spacer",
        "z": "3c7bdc336f76b0ee",
        "name": "spacer",
        "group": "bda7e38372e6dfe8",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "24f0e31053e95ed1",
        "type": "ui_spacer",
        "z": "3c7bdc336f76b0ee",
        "name": "spacer",
        "group": "bda7e38372e6dfe8",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "1a7f1b9e1715c863",
        "type": "mqtt in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/peticion",
        "qos": "2",
        "datatype": "auto",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 130,
        "y": 520,
        "wires": [
            [
                "014da73047ad8f7c"
            ]
        ]
    },
    {
        "id": "014da73047ad8f7c",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "buscar en lista",
        "func": "let topic;\nlet payload;\nlet num = -1;\nlet id = msg.payload;\nlet dispositivos = global.get(\"dispositivos\");  // Arreglo\n\nnum = dispositivos.indexOf(id);\nif (num == -1){\n    topic = \"Dispositivo nuevo\";\n    payload = id;\n    // Si es dispositivo nuevo se manda el ID\n}\nelse {\n    topic = \"Dispositivo conocido\";\n    if (num == 10) {\n        payload = id + num;\n    }\n    else {\n        payload = id + '0' + num;\n    }\n    // Esto es lo que se enviará por MQTT\n    // AABBCCxx\n}\nmsg.topic = topic;\nmsg.payload = payload;\n\n// si el ID es 000000 entonces es el mecanismo de limpieza de MQTT\n// del servidor, por lo tanto no se pasa el mensaje al sig. nodo\nif (id != \"000000\") {\n    return msg;\n}\n\n\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "// Codigo que corre la primera vez que se inicia el nodo\n\nlet dispositivos = global.get(\"dispositivos\");\n\n// Si el arreglo no está declarado, decláralo\nif (dispositivos == undefined){\n    dispositivos = [0,null,null,null,null,null,\n                    null,null,null,null,null]\n    global.set(\"dispositivos\", dispositivos);\n}\n",
        "finalize": "",
        "libs": [],
        "x": 340,
        "y": 520,
        "wires": [
            [
                "3223f9641b497bf4"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "93ba2292148ef3b4",
        "type": "mqtt out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/respuesta",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1300,
        "y": 520,
        "wires": []
    },
    {
        "id": "49b06091b509a46f",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "Mensaje de peticion, ej. AABBCC",
        "info": "",
        "x": 130,
        "y": 480,
        "wires": []
    },
    {
        "id": "3223f9641b497bf4",
        "type": "switch",
        "z": "1f35534c8fd78b65",
        "name": "conocido?",
        "property": "topic",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Dispositivo conocido",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Dispositivo nuevo",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 530,
        "y": 520,
        "wires": [
            [
                "93ba2292148ef3b4"
            ],
            [
                "c5dbecb961485505"
            ]
        ]
    },
    {
        "id": "960faeff33d98017",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Rechazar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "Aceptar/rechazar",
        "x": 630,
        "y": 620,
        "wires": [
            [
                "ecc32b6e6233506b",
                "82780bfca8c779e1"
            ]
        ]
    },
    {
        "id": "33ecd779ded6d0b7",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "agregar a lista",
        "func": "let topic;\nlet payload;\nlet num;\nlet id = flow.get(\"ultimoID\");\nlet dispositivos = global.get(\"dispositivos\");\nlet msgMQTT;\n\nif (dispositivos.indexOf(id) == -1) {\n    \n    // Busca el primer indice sin dispositivo asignado\n    num = dispositivos.indexOf(null);\n    \n    \n    // Y se lo asigna\n    dispositivos[num] = id;\n    \n    global.set(\"dispositivos\", dispositivos);\n    \n    topic = \"Dispositivo agregado\";\n    payload = `El dispositivo OMC-WIFI-${id} \n    se ha registrado como Dispositivo ${num}`;\n        \n    msg.topic = topic;\n    msg.payload = payload;\n    \n    if (num == 10) {\n        msgMQTT = { payload: id + num };\n    }\n    else {\n        msgMQTT = { payload: id + '0' + num };\n    }\n    \n}\nelse {\n    topic = \"Error en registro\";\n    payload = `Reinicie el dispositivo para intentar nuevamente`;\n    msg.topic = topic;\n    msg.payload = payload;\n}\n\nreturn [msgMQTT, msg];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1020,
        "y": 600,
        "wires": [
            [
                "29aa94bf97fafd0e",
                "93ba2292148ef3b4"
            ],
            [
                "04ec58ea6a4769b3"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "ecc32b6e6233506b",
        "type": "switch",
        "z": "1f35534c8fd78b65",
        "name": "aceptar?",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "Rechazar",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 840,
        "y": 620,
        "wires": [
            [
                "33ecd779ded6d0b7"
            ],
            [
                "1b6a138a13dda395"
            ]
        ]
    },
    {
        "id": "04ec58ea6a4769b3",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "5",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "Aceptar",
        "cancel": "Rechazar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "mostrar mensaje",
        "x": 1310,
        "y": 640,
        "wires": []
    },
    {
        "id": "3fa3b83a6cebbf2e",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "limpiar lista",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet mensajesMQTT = [];\n\n\n//dispositivos = [0,\"ASDFGG\",\"QWERTY\",null,\"MNBVCX\",\"LKJHGF\",\n//                      \"POIUYT\",null,null,\"ZXCVBN\",\"ABCDEF\"]\n\n// almacenar mensajes mqtt con el rechazo en un solo arreglo\nfor (i = 0; i < 10; i++) {\n    if (dispositivos[i + 1] != null) {\n        mensajesMQTT[i] = { payload: dispositivos[i + 1] + \"99\" };\n    }\n}\n// se borra el ultimoID tambien para que no se trabe el buffer\nflow.set(\"ultimoID\",\"\");\n\n// borrar dipositivos de la lista\ndispositivos = [0,null,null,null,null,null,\n                null,null,null,null,null]\nnombres = [0,null,null,null,null,null,\n                null,null,null,null,null]\nglobal.set(\"dispositivos\", dispositivos);\nglobal.set(\"nombres\", nombres); \n\n\n\nreturn [mensajesMQTT,msg];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 810,
        "y": 920,
        "wires": [
            [
                "867ab9056a1803ae"
            ],
            [
                "ab5534ac288247af"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "38868c3a78284fe8",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "limpiar lista",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 600,
        "y": 860,
        "wires": [
            [
                "3fa3b83a6cebbf2e"
            ]
        ]
    },
    {
        "id": "952708e23619e65f",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "gestión de dispositivos",
        "info": "En este flow se hace la gestión de los dispositivos. Tales como:\n\n - Manejo de peticiones y asociación con servidor\n - Manejo de lista de dispositivos\n - Cambio de alias de dispositivos\n - Reinicio masivo de dispositivos",
        "x": 760,
        "y": 220,
        "wires": []
    },
    {
        "id": "ab5534ac288247af",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "mostrar lista",
        "func": "\nlet dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\n\nmsg.payload = [\n      { num: 1, id: dispositivos[1], nombre: nombres[1]},\n      { num: 2, id: dispositivos[2], nombre: nombres[2]},\n      { num: 3, id: dispositivos[3], nombre: nombres[3]},\n      { num: 4, id: dispositivos[4], nombre: nombres[4]},\n      { num: 5, id: dispositivos[5], nombre: nombres[5]},\n      { num: 6, id: dispositivos[6], nombre: nombres[6]},\n      { num: 7, id: dispositivos[7], nombre: nombres[7]},\n      { num: 8, id: dispositivos[8], nombre: nombres[8]},\n      { num: 9, id: dispositivos[9], nombre: nombres[9]},\n      { num: 10, id: dispositivos[10], nombre: nombres[10]},\n    ];\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1130,
        "y": 1160,
        "wires": [
            [
                "035bb364e4e5823b",
                "181143468b3a713a",
                "d566c1e447db19c9"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "55eb2c1d8e5c6138",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "mostrar lista",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "30",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 880,
        "y": 1160,
        "wires": [
            [
                "ab5534ac288247af"
            ]
        ]
    },
    {
        "id": "f6852b79ac2c63aa",
        "type": "ui_dropdown",
        "z": "1f35534c8fd78b65",
        "name": "Elegir 1",
        "label": "",
        "tooltip": "",
        "place": "Seleccione",
        "group": "bf378dfbb8ffaa4c",
        "order": 2,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "1",
                "value": 1,
                "type": "num"
            },
            {
                "label": "2",
                "value": 2,
                "type": "num"
            },
            {
                "label": "3",
                "value": 3,
                "type": "num"
            },
            {
                "label": "4",
                "value": 4,
                "type": "num"
            },
            {
                "label": "5",
                "value": 5,
                "type": "num"
            },
            {
                "label": "6",
                "value": 6,
                "type": "num"
            },
            {
                "label": "7",
                "value": 7,
                "type": "num"
            },
            {
                "label": "8",
                "value": 8,
                "type": "num"
            },
            {
                "label": "9",
                "value": 9,
                "type": "num"
            },
            {
                "label": "10",
                "value": 10,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "elegir1",
        "topicType": "str",
        "className": "",
        "x": 360,
        "y": 1740,
        "wires": [
            [
                "26ac5b81154e920c"
            ]
        ]
    },
    {
        "id": "b8096a2d4cd31640",
        "type": "ui_dropdown",
        "z": "1f35534c8fd78b65",
        "name": "Elegir 2",
        "label": "",
        "tooltip": "",
        "place": "Seleccione",
        "group": "bf378dfbb8ffaa4c",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "1",
                "value": 1,
                "type": "num"
            },
            {
                "label": "2",
                "value": 2,
                "type": "num"
            },
            {
                "label": "3",
                "value": 3,
                "type": "num"
            },
            {
                "label": "4",
                "value": 4,
                "type": "num"
            },
            {
                "label": "5",
                "value": 5,
                "type": "num"
            },
            {
                "label": "6",
                "value": 6,
                "type": "num"
            },
            {
                "label": "7",
                "value": 7,
                "type": "num"
            },
            {
                "label": "8",
                "value": 8,
                "type": "num"
            },
            {
                "label": "9",
                "value": 9,
                "type": "num"
            },
            {
                "label": "10",
                "value": 10,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "elegir2",
        "topicType": "str",
        "className": "",
        "x": 360,
        "y": 1820,
        "wires": [
            [
                "26ac5b81154e920c"
            ]
        ]
    },
    {
        "id": "0ef458bfa244cc7a",
        "type": "ui_button",
        "z": "1f35534c8fd78b65",
        "name": "",
        "group": "bf378dfbb8ffaa4c",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "swap_vert",
        "payload": "Cambiar",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "str",
        "x": 580,
        "y": 1860,
        "wires": [
            [
                "26ac5b81154e920c"
            ]
        ]
    },
    {
        "id": "5ad43563dba01f17",
        "type": "ui_text",
        "z": "1f35534c8fd78b65",
        "group": "bf378dfbb8ffaa4c",
        "order": 1,
        "width": 3,
        "height": 1,
        "name": "",
        "label": "Intercambiar dispositivo",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 410,
        "y": 1700,
        "wires": []
    },
    {
        "id": "0a0a723944800622",
        "type": "ui_text",
        "z": "1f35534c8fd78b65",
        "group": "bf378dfbb8ffaa4c",
        "order": 3,
        "width": 3,
        "height": 1,
        "name": "",
        "label": "Con dispositivo",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 1780,
        "wires": []
    },
    {
        "id": "26ac5b81154e920c",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "intercambiar numeros",
        "func": "if (msg.topic == \"elegir1\"){\n    flow.set(\"elegir1\", msg.payload); \n} \nelse if (msg.topic == \"elegir2\"){\n    flow.set(\"elegir2\", msg.payload); \n}\nelse {\n    let elegir1 = flow.get(\"elegir1\"); \n    let elegir2 = flow.get(\"elegir2\");\n    flow.set(\"elegir1\",\"000000\"); //Vacío los contenedores para\n    flow.set(\"elegir2\",\"000000\"); //evitar cambiar sin saber\n    if ((elegir1 != elegir2) && (elegir1 != 0) && (elegir2 != 0)){\n\n        let dispositivos = global.get(\"dispositivos\");\n        let aux = dispositivos[elegir1]\n        dispositivos[elegir1] = dispositivos[elegir2];\n        dispositivos[elegir2] = aux;\n        global.set(\"dispositivos\", dispositivos); \n        \n        let nombres = global.get(\"nombres\");\n        aux = nombres[elegir1]\n        nombres[elegir1] = nombres[elegir2];\n        nombres[elegir2] = aux;\n        global.set(\"nombres\", nombres); \n        \n        \n        let cambio1 = dispositivos[elegir1];\n        let cambio2 = dispositivos[elegir2];\n        \n        if (cambio1 == null) {\n            cambio1 = \"000000\";\n        } \n        \n        if (cambio2 == null) {\n            cambio2 = \"000000\";\n        }\n        \n        let num1;\n        let num2;\n        \n        if (elegir1 == 10) {\n            num1  = String(elegir1); \n        }\n        else{\n            num1 = \"0\" + String(elegir1);\n        }\n        \n        if (elegir2 == 10) {\n            num2  = String(elegir2); \n        }\n        else{\n            num2 = \"0\" + String(elegir2);\n        }\n    \n        msgMQTT1 = { payload: cambio1 + num1};\n        msgMQTT2 = { payload: cambio2 + num2};\n        \n        return [msgMQTT1, msgMQTT2];\n    }\n}\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "flow.set(\"elegir1\", 0);\nflow.set(\"elegir2\", 0);",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 1780,
        "wires": [
            [
                "dd0149188d4a0728",
                "0f6c0b3a873ac3c5"
            ],
            [
                "6a089b24186ca679"
            ]
        ]
    },
    {
        "id": "dd0149188d4a0728",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1080,
        "y": 1700,
        "wires": [
            [
                "00d377c6daaa72bb"
            ]
        ]
    },
    {
        "id": "294a58e59222f0a3",
        "type": "link in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "links": [
            "603512f1caae2630",
            "00d377c6daaa72bb"
        ],
        "x": 205,
        "y": 1820,
        "wires": [
            [
                "b8096a2d4cd31640",
                "f6852b79ac2c63aa"
            ]
        ]
    },
    {
        "id": "035bb364e4e5823b",
        "type": "ui_table",
        "z": "1f35534c8fd78b65",
        "group": "5d454f4b0e2735c2",
        "name": "",
        "order": 1,
        "width": 6,
        "height": 6,
        "columns": [
            {
                "field": "num",
                "title": "Disp.",
                "width": "25%",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "id",
                "title": "ID",
                "width": "25%",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "nombre",
                "title": "Alias",
                "width": "50%",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            }
        ],
        "outputs": 0,
        "cts": false,
        "x": 1350,
        "y": 1160,
        "wires": []
    },
    {
        "id": "1b6a138a13dda395",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "rechazar",
        "func": "let id = flow.get(\"ultimoID\");\nlet msgMQTT;\n\nmsg.topic = \"Dispositivo rechazado\";\nmsg.payload = `Se ha rechazado un dispositivo. \nReinicie dicho dispositivo para volver a hacer la petición.`;\n    \nmsgMQTT = { payload: id + \"99\" };\n\n// se borra el ultimoID tambien para que no se trabe el buffer\nflow.set(\"ultimoID\",\"\");\n\nreturn [msgMQTT, msg];\n",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1040,
        "y": 640,
        "wires": [
            [
                "93ba2292148ef3b4"
            ],
            [
                "04ec58ea6a4769b3"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "c5dbecb961485505",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "buffer",
        "func": "let buffer = flow.get(\"buffer\");\nlet id = 0;\n\n//node.warn(flow.get(\"buffer\"));\n\nif (msg.payload != \"\") {\n    //significa que llego un codigo nuevo que meteremos en el\n    //buffer (solo si no está repetido)\n\n    // verificamos que no esté repetido\n    if ((buffer.indexOf(msg.payload) == -1) && (msg.payload != flow.get(\"ultimoID\"))) {\n        // metemos en el buffer\n        \n        buffer.push(msg.payload);\n        flow.set(\"buffer\", buffer);\n        \n    }\n}\n\nif (flow.get(\"habilitador\") == 1) {\n    //significa que el usuario tocó un botón\n    //por lo tanto, puedo sacar del buffer un nuevo mensaje\n    \n    id = buffer.shift();\n    flow.set(\"buffer\", buffer);\n    \n    if (id != undefined){\n        flow.set(\"habilitador\", 0);\n        msg.payload = `El dispositivo OMC-WIFI-${id} \n                    se está intentando asociar con el servidor. \n                    ¿Desea agregar dicho dispositivo?`;\n        msg.topic = \"Dispositivo nuevo\"\n        \n        flow.set(\"ultimoID\", id);\n        return msg;\n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "flow.set(\"habilitador\",1);\n\nlet buffer = [];\nflow.set(\"buffer\",buffer);\nflow.set(\"ultimoID\",\"\");",
        "finalize": "",
        "libs": [],
        "x": 450,
        "y": 620,
        "wires": [
            [
                "960faeff33d98017"
            ]
        ]
    },
    {
        "id": "6a089b24186ca679",
        "type": "mqtt out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/respuesta",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1240,
        "y": 1780,
        "wires": []
    },
    {
        "id": "82780bfca8c779e1",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "habilitar paso",
        "func": "flow.set(\"habilitador\", 1);",
        "outputs": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 860,
        "y": 680,
        "wires": []
    },
    {
        "id": "63edca0416387526",
        "type": "ui_button",
        "z": "1f35534c8fd78b65",
        "name": "",
        "group": "4dc5ab4e1f917121",
        "order": 4,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Desvincular todos",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "cancel",
        "payload": "Presione Aceptar para eliminar todos los dispositivos registrados. Este proceso es irreversible.",
        "payloadType": "str",
        "topic": "Eliminar dispositivos",
        "topicType": "str",
        "x": 190,
        "y": 1000,
        "wires": [
            [
                "71fcdf01d246092c",
                "22f34f55b4f9dbf8"
            ]
        ]
    },
    {
        "id": "23040aa472acdd3f",
        "type": "link in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "links": [
            "29aa94bf97fafd0e",
            "00d377c6daaa72bb",
            "a95ef4b0858b6535"
        ],
        "x": 995,
        "y": 1160,
        "wires": [
            [
                "ab5534ac288247af"
            ]
        ]
    },
    {
        "id": "29aa94bf97fafd0e",
        "type": "link out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "mode": "link",
        "links": [
            "23040aa472acdd3f",
            "8c6e13cdddc75c7e",
            "5ed0ab0829c35c26",
            "1bd2b0f9d1cc1c11"
        ],
        "x": 1235,
        "y": 600,
        "wires": []
    },
    {
        "id": "00d377c6daaa72bb",
        "type": "link out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "mode": "link",
        "links": [
            "23040aa472acdd3f",
            "294a58e59222f0a3",
            "8c6e13cdddc75c7e",
            "5ed0ab0829c35c26",
            "1bd2b0f9d1cc1c11"
        ],
        "x": 1195,
        "y": 1700,
        "wires": []
    },
    {
        "id": "22f34f55b4f9dbf8",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 400,
        "y": 1000,
        "wires": [
            [
                "053a1656f6fcf8f0"
            ]
        ]
    },
    {
        "id": "ca8ce12ae269eefd",
        "type": "complete",
        "z": "1f35534c8fd78b65",
        "name": "sí dio aceptar",
        "scope": [
            "1d5a99640b02789c"
        ],
        "uncaught": false,
        "x": 170,
        "y": 920,
        "wires": [
            [
                "351989373cb74b52"
            ]
        ]
    },
    {
        "id": "351989373cb74b52",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 920,
        "wires": [
            [
                "71fcdf01d246092c"
            ]
        ]
    },
    {
        "id": "71fcdf01d246092c",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n        return msg;\n    }\n    else {\n        msg.payload = null; \n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 920,
        "wires": [
            [
                "3fa3b83a6cebbf2e"
            ]
        ]
    },
    {
        "id": "053a1656f6fcf8f0",
        "type": "switch",
        "z": "1f35534c8fd78b65",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 540,
        "y": 1000,
        "wires": [
            [
                "1d5a99640b02789c"
            ],
            [
                "429c472d841a8db4"
            ]
        ]
    },
    {
        "id": "1d5a99640b02789c",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se ha borrado el registro de todos los dispositivos",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 980,
        "wires": [
            [
                "40ff1856b62164a2"
            ]
        ]
    },
    {
        "id": "40ff1856b62164a2",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 860,
        "y": 980,
        "wires": []
    },
    {
        "id": "429c472d841a8db4",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "cancelar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 1020,
        "wires": [
            [
                "c1d37efac039853b"
            ]
        ]
    },
    {
        "id": "c1d37efac039853b",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 860,
        "y": 1020,
        "wires": []
    },
    {
        "id": "a181b1b2b0a987b5",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "manejo de peticiones",
        "info": "",
        "x": 760,
        "y": 460,
        "wires": []
    },
    {
        "id": "2b2e36cf16a332db",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "limpiar lista de dispositivos",
        "info": "",
        "x": 730,
        "y": 780,
        "wires": []
    },
    {
        "id": "d3d226c0d6e2aa20",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "modificar orden de dispositivos",
        "info": "",
        "x": 770,
        "y": 1640,
        "wires": []
    },
    {
        "id": "867ab9056a1803ae",
        "type": "delay",
        "z": "1f35534c8fd78b65",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1030,
        "y": 840,
        "wires": [
            [
                "dfbacf061e02c6c1"
            ]
        ]
    },
    {
        "id": "dfbacf061e02c6c1",
        "type": "mqtt out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/respuesta",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1220,
        "y": 840,
        "wires": []
    },
    {
        "id": "0f6c0b3a873ac3c5",
        "type": "delay",
        "z": "1f35534c8fd78b65",
        "name": "",
        "pauseType": "delay",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1060,
        "y": 1740,
        "wires": [
            [
                "6a089b24186ca679"
            ]
        ]
    },
    {
        "id": "181143468b3a713a",
        "type": "link out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "mode": "link",
        "links": [
            "43cef94410213f27",
            "918d0bd788580cf5",
            "84dedc89dec7624f",
            "0d4845a3bb13c77f",
            "e6897a12d4294daa",
            "0d1a3919072d9f93",
            "b4435e400b7e0d32",
            "9ea9c89185e21ee8",
            "f20664a708ce1be9",
            "8191f509c72131bf",
            "5ac40264aec23090",
            "8588cf60d651e4db",
            "4d00d247bea22886",
            "5e918491992569c3",
            "22ece330d2cf3deb",
            "1c086105fc64474b",
            "9029571b4071d1ec",
            "ad2715895493dde3"
        ],
        "x": 1255,
        "y": 1160,
        "wires": []
    },
    {
        "id": "3e102eca748a7361",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "eliminar dispositivo",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\n\nlet num = msg.payload;\n\nif (dispositivos[num] != null) {\n    msg.payload = dispositivos[num] + \"99\";\n    \n    // borrar dispositivo de la lista\n    dispositivos[num] = null;\n    nombres[num] = null;\n    global.set(\"dispositivos\", dispositivos);\n    global.set(\"nombres\", nombres); \n    \n    // se borra el ultimoID tambien para que no se trabe el buffer\n    flow.set(\"ultimoID\",\"\");\n    \n    return msg;\n}\n\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 1320,
        "wires": [
            [
                "ab5534ac288247af",
                "f7f58f4d23a04e02"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "def869ad0e350b75",
        "type": "complete",
        "z": "1f35534c8fd78b65",
        "name": "sí dio aceptar",
        "scope": [
            "20fcb97e947a99e0"
        ],
        "uncaught": false,
        "x": 170,
        "y": 1320,
        "wires": [
            [
                "7c01ea34392c867a"
            ]
        ]
    },
    {
        "id": "7c01ea34392c867a",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 1320,
        "wires": [
            [
                "97bcc0109324f3a5"
            ]
        ]
    },
    {
        "id": "97bcc0109324f3a5",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload == \"habilitador\") {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"disp\") != undefined && flow.get(\"disp\") != null) {\n        msg.payload = flow.get(\"disp\");\n        return msg;\n    }\n\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 1320,
        "wires": [
            [
                "3e102eca748a7361"
            ]
        ]
    },
    {
        "id": "f7f58f4d23a04e02",
        "type": "mqtt out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/respuesta",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1100,
        "y": 1320,
        "wires": []
    },
    {
        "id": "a9d8e47296b6b49b",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 400,
        "y": 1400,
        "wires": [
            [
                "15ed80f40e1bb09e"
            ]
        ]
    },
    {
        "id": "15ed80f40e1bb09e",
        "type": "switch",
        "z": "1f35534c8fd78b65",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 540,
        "y": 1400,
        "wires": [
            [
                "20fcb97e947a99e0"
            ],
            [
                "56460e2b83e265ef"
            ]
        ]
    },
    {
        "id": "20fcb97e947a99e0",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se ha borrado el registro del dispositivo seleccionado",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 1380,
        "wires": [
            [
                "4487122146c92666"
            ]
        ]
    },
    {
        "id": "4487122146c92666",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 860,
        "y": 1380,
        "wires": []
    },
    {
        "id": "56460e2b83e265ef",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "cancelar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 1420,
        "wires": [
            [
                "124d82cf6e77b64d"
            ]
        ]
    },
    {
        "id": "124d82cf6e77b64d",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 860,
        "y": 1420,
        "wires": []
    },
    {
        "id": "8aa5fd80cc9c8106",
        "type": "ui_button",
        "z": "1f35534c8fd78b65",
        "name": "",
        "group": "4dc5ab4e1f917121",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Desvincular",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "Presione Aceptar para eliminar el registro del dispositivo seleccionado",
        "payloadType": "str",
        "topic": "Eliminar dispositivo",
        "topicType": "str",
        "x": 210,
        "y": 1400,
        "wires": [
            [
                "a9d8e47296b6b49b",
                "97bcc0109324f3a5"
            ]
        ]
    },
    {
        "id": "a4d528b06385806c",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "eliminar un dispositivo",
        "info": "",
        "x": 730,
        "y": 1220,
        "wires": []
    },
    {
        "id": "bac8e5023bb66e17",
        "type": "ui_dropdown",
        "z": "1f35534c8fd78b65",
        "name": "Elegir dispositivo eliminar",
        "label": "",
        "tooltip": "",
        "place": "Seleccione",
        "group": "4dc5ab4e1f917121",
        "order": 1,
        "width": 4,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "1",
                "value": 1,
                "type": "num"
            },
            {
                "label": "2",
                "value": 2,
                "type": "num"
            },
            {
                "label": "3",
                "value": 3,
                "type": "num"
            },
            {
                "label": "4",
                "value": 4,
                "type": "num"
            },
            {
                "label": "5",
                "value": 5,
                "type": "num"
            },
            {
                "label": "6",
                "value": 6,
                "type": "num"
            },
            {
                "label": "7",
                "value": 7,
                "type": "num"
            },
            {
                "label": "8",
                "value": 8,
                "type": "num"
            },
            {
                "label": "9",
                "value": 9,
                "type": "num"
            },
            {
                "label": "10",
                "value": 10,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 490,
        "y": 1500,
        "wires": [
            [
                "f48518b837a6a1df"
            ]
        ]
    },
    {
        "id": "84dedc89dec7624f",
        "type": "link in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 155,
        "y": 1520,
        "wires": [
            [
                "2f7427b83cacf0f4"
            ]
        ]
    },
    {
        "id": "f48518b837a6a1df",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "guardar dispositivo seleccionado",
        "func": "flow.set(\"disp\",msg.payload);",
        "outputs": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 760,
        "y": 1500,
        "wires": []
    },
    {
        "id": "2f7427b83cacf0f4",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 1520,
        "wires": [
            [
                "bac8e5023bb66e17",
                "f48518b837a6a1df"
            ]
        ]
    },
    {
        "id": "dbc839a05d5d9c26",
        "type": "mqtt in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/respuesta",
        "qos": "2",
        "datatype": "auto",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 360,
        "wires": [
            [
                "a9f6eb375b7de4e8"
            ]
        ]
    },
    {
        "id": "a9f6eb375b7de4e8",
        "type": "debug",
        "z": "1f35534c8fd78b65",
        "name": "respuesta",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 320,
        "y": 360,
        "wires": []
    },
    {
        "id": "7b896ea87a7c7afe",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "cambiar nombre",
        "func": "let nombres = global.get(\"nombres\");\nlet num = flow.get(\"dispnom\");\n\nnombres[num] = msg.payload;\n\nglobal.set(\"nombres\", nombres);",
        "outputs": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 780,
        "y": 2180,
        "wires": []
    },
    {
        "id": "f067a5de27415615",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "limpiar seleccion al inicio",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 110,
        "y": 1740,
        "wires": [
            [
                "f6852b79ac2c63aa",
                "b8096a2d4cd31640"
            ]
        ]
    },
    {
        "id": "75a3cec43f710330",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "prompt",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "introducir nombre",
        "x": 410,
        "y": 2160,
        "wires": [
            [
                "ac5e53e063bb8f31"
            ]
        ]
    },
    {
        "id": "ac5e53e063bb8f31",
        "type": "switch",
        "z": "1f35534c8fd78b65",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Cancelar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 580,
        "y": 2160,
        "wires": [
            [
                "df02f2dd53aab66b"
            ],
            [
                "78f21d29f0852e83",
                "7b896ea87a7c7afe",
                "a95ef4b0858b6535"
            ]
        ]
    },
    {
        "id": "78f21d29f0852e83",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se ha cambiado el alias del dispositivo seleccionado",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 2140,
        "wires": [
            [
                "dffb54188cfad202"
            ]
        ]
    },
    {
        "id": "dffb54188cfad202",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 940,
        "y": 2140,
        "wires": []
    },
    {
        "id": "df02f2dd53aab66b",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "cancelar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 780,
        "y": 2100,
        "wires": [
            [
                "aa86c988c1ee1c7e"
            ]
        ]
    },
    {
        "id": "aa86c988c1ee1c7e",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 940,
        "y": 2100,
        "wires": []
    },
    {
        "id": "abbb729e4e3f9ee7",
        "type": "ui_button",
        "z": "1f35534c8fd78b65",
        "name": "cambiar alias",
        "group": "61ff5f682298fe1b",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "Introduzca el nuevo alias y presione Aceptar para cambiar el alias del dispositivo",
        "payloadType": "str",
        "topic": "Cambiar alias del dispositivo",
        "topicType": "str",
        "x": 210,
        "y": 2160,
        "wires": [
            [
                "75a3cec43f710330"
            ]
        ]
    },
    {
        "id": "0e949b92785e8364",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "cambiar nombre a un dispositivo",
        "info": "",
        "x": 770,
        "y": 1980,
        "wires": []
    },
    {
        "id": "278357d23d860da1",
        "type": "ui_dropdown",
        "z": "1f35534c8fd78b65",
        "name": "Elegir dispositivo nombre",
        "label": "",
        "tooltip": "",
        "place": "Seleccione",
        "group": "61ff5f682298fe1b",
        "order": 1,
        "width": 4,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "1",
                "value": 1,
                "type": "num"
            },
            {
                "label": "2",
                "value": 2,
                "type": "num"
            },
            {
                "label": "3",
                "value": 3,
                "type": "num"
            },
            {
                "label": "4",
                "value": 4,
                "type": "num"
            },
            {
                "label": "5",
                "value": 5,
                "type": "num"
            },
            {
                "label": "6",
                "value": 6,
                "type": "num"
            },
            {
                "label": "7",
                "value": 7,
                "type": "num"
            },
            {
                "label": "8",
                "value": 8,
                "type": "num"
            },
            {
                "label": "9",
                "value": 9,
                "type": "num"
            },
            {
                "label": "10",
                "value": 10,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 530,
        "y": 2300,
        "wires": [
            [
                "11f9d228d49243b6"
            ]
        ]
    },
    {
        "id": "51aed22e77d5929e",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "limpiar seleccion al inicio",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "asd",
        "payload": "",
        "payloadType": "str",
        "x": 290,
        "y": 2280,
        "wires": [
            [
                "278357d23d860da1",
                "11f9d228d49243b6"
            ]
        ]
    },
    {
        "id": "0d4845a3bb13c77f",
        "type": "link in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 205,
        "y": 2320,
        "wires": [
            [
                "aa78facf4bbd7c5f"
            ]
        ]
    },
    {
        "id": "11f9d228d49243b6",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "guardar dispositivo seleccionado",
        "func": "flow.set(\"dispnom\",msg.payload);",
        "outputs": 0,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 800,
        "y": 2300,
        "wires": []
    },
    {
        "id": "aa78facf4bbd7c5f",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 2320,
        "wires": [
            [
                "278357d23d860da1",
                "11f9d228d49243b6"
            ]
        ]
    },
    {
        "id": "a1d2c76c0991f5b2",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "limpiar seleccion al inicio",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "asd",
        "payload": "",
        "payloadType": "str",
        "x": 250,
        "y": 1480,
        "wires": [
            [
                "bac8e5023bb66e17"
            ]
        ]
    },
    {
        "id": "a95ef4b0858b6535",
        "type": "link out",
        "z": "1f35534c8fd78b65",
        "name": "",
        "mode": "link",
        "links": [
            "23040aa472acdd3f",
            "8c6e13cdddc75c7e",
            "5ed0ab0829c35c26",
            "1bd2b0f9d1cc1c11"
        ],
        "x": 715,
        "y": 2220,
        "wires": []
    },
    {
        "id": "0c52d025732c2324",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "reiniciar todos",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet mensajesMQTT = [];\n\n// almacenar mensajes mqtt con el reinicio\nfor (i = 0; i < 10; i++) {\n    if (dispositivos[i + 1] != null) {\n        if (i < 9){\n            mensajesMQTT[i] = { topic: \"omc/0\" + (i + 1) + \"/cambios\", payload: \"re\", qos: 2};\n        }\n        else {\n            mensajesMQTT[i] = { topic: \"omc/\" + (i + 1) + \"/cambios\", payload: \"re\", qos: 2};\n        }\n    }\n}\n\nreturn [mensajesMQTT,msg];\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 820,
        "y": 2640,
        "wires": [
            [
                "f9f4459786bdfd52",
                "257e8ed7126b9b53"
            ]
        ],
        "info": "hola"
    },
    {
        "id": "f6a442ec031dfc86",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "limpiar lista",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 600,
        "y": 2580,
        "wires": [
            [
                "0c52d025732c2324"
            ]
        ]
    },
    {
        "id": "5ce4fa7f2356c58b",
        "type": "ui_button",
        "z": "1f35534c8fd78b65",
        "name": "",
        "group": "5e98ca9a980e5866",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Reiniciar todos",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "Presione Aceptar para reiniciar todos los dispositivos registrados.",
        "payloadType": "str",
        "topic": "Reiniciar dispositivos",
        "topicType": "str",
        "x": 220,
        "y": 2720,
        "wires": [
            [
                "e3ea9468eefc4a92",
                "d08bc9cbe7bb6303"
            ]
        ]
    },
    {
        "id": "d08bc9cbe7bb6303",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 400,
        "y": 2720,
        "wires": [
            [
                "ffc43275cd3d583c"
            ]
        ]
    },
    {
        "id": "2067bc2ced3d1510",
        "type": "complete",
        "z": "1f35534c8fd78b65",
        "name": "sí dio aceptar",
        "scope": [
            "6f3e320a304722a2"
        ],
        "uncaught": false,
        "x": 170,
        "y": 2640,
        "wires": [
            [
                "2f24b89391880434"
            ]
        ]
    },
    {
        "id": "2f24b89391880434",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 2640,
        "wires": [
            [
                "e3ea9468eefc4a92"
            ]
        ]
    },
    {
        "id": "e3ea9468eefc4a92",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio2\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio2\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio2\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio2\", null);\n        return msg;\n    }\n    else {\n        msg.payload = null; \n    }\n}\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 530,
        "y": 2640,
        "wires": [
            [
                "0c52d025732c2324"
            ]
        ]
    },
    {
        "id": "ffc43275cd3d583c",
        "type": "switch",
        "z": "1f35534c8fd78b65",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 540,
        "y": 2720,
        "wires": [
            [
                "6f3e320a304722a2"
            ],
            [
                "195a60e5d8f49e42"
            ]
        ]
    },
    {
        "id": "6f3e320a304722a2",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se han reiniciado todos los dispositivos",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 2700,
        "wires": [
            [
                "b6cacb745f8c0070"
            ]
        ]
    },
    {
        "id": "b6cacb745f8c0070",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 860,
        "y": 2700,
        "wires": []
    },
    {
        "id": "195a60e5d8f49e42",
        "type": "change",
        "z": "1f35534c8fd78b65",
        "name": "cancelar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 2740,
        "wires": [
            [
                "281545811c12be2c"
            ]
        ]
    },
    {
        "id": "281545811c12be2c",
        "type": "ui_toast",
        "z": "1f35534c8fd78b65",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 860,
        "y": 2740,
        "wires": []
    },
    {
        "id": "7c962f20ec30128a",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "Reiniciar todos",
        "info": "",
        "x": 700,
        "y": 2500,
        "wires": []
    },
    {
        "id": "f9f4459786bdfd52",
        "type": "mqtt out",
        "z": "1f35534c8fd78b65",
        "name": "mensajes MQTT omc/xx/cambios",
        "topic": "",
        "qos": "",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1100,
        "y": 2640,
        "wires": []
    },
    {
        "id": "3aaec6b6f42a3ad7",
        "type": "comment",
        "z": "1f35534c8fd78b65",
        "name": "mostrar en pantalla mensajes MQTT",
        "info": "",
        "x": 240,
        "y": 280,
        "wires": []
    },
    {
        "id": "658ecdcdf29a5110",
        "type": "mqtt in",
        "z": "1f35534c8fd78b65",
        "name": "",
        "topic": "omc/peticion",
        "qos": "2",
        "datatype": "auto",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 150,
        "y": 320,
        "wires": [
            [
                "89ad5157bc2c4cba"
            ]
        ]
    },
    {
        "id": "89ad5157bc2c4cba",
        "type": "debug",
        "z": "1f35534c8fd78b65",
        "name": "peticion",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 320,
        "y": 320,
        "wires": []
    },
    {
        "id": "257e8ed7126b9b53",
        "type": "debug",
        "z": "1f35534c8fd78b65",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1130,
        "y": 2560,
        "wires": []
    },
    {
        "id": "e91608f86429d4eb",
        "type": "ui_ui_control",
        "z": "1f35534c8fd78b65",
        "name": "",
        "events": "all",
        "x": 1500,
        "y": 1080,
        "wires": [
            []
        ]
    },
    {
        "id": "d566c1e447db19c9",
        "type": "function",
        "z": "1f35534c8fd78b65",
        "name": "",
        "func": "dispositivos = global.get(\"dispositivos\");\nmostrar_tab = [];\nocultar_tab = [];\nmostrar_grupo = [];\nocultar_grupo = [];\n\nfor (let num = 1; num <= 10; num++) {\n    if (dispositivos[num] == null) {\n        ocultar_tab.push(\"Dispositivo_\" + num)\n        ocultar_grupo.push(\"Resumen_Dispositivo_\" + num)\n    }\n    else {\n        mostrar_tab.push(\"Dispositivo_\" + num)\n        mostrar_grupo.push(\"Resumen_Dispositivo_\" + num)\n    }\n}\n\nmsg.payload =   {   \n                \"tabs\":\n                    {\n                    \"show\": mostrar_tab,\n                    \"hide\": ocultar_tab\n                    },\n                \"group\":\n                    {\n                    \"show\": mostrar_grupo,\n                    \"hide\": ocultar_grupo\n                    }\n                }\n\nreturn msg;\n",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1340,
        "y": 1080,
        "wires": [
            [
                "e91608f86429d4eb"
            ]
        ]
    },
    {
        "id": "76f9cc775541de8a",
        "type": "inject",
        "z": "1f35534c8fd78b65",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 1140,
        "y": 1020,
        "wires": [
            [
                "d566c1e447db19c9"
            ]
        ]
    },
    {
        "id": "9e58624.7faaba",
        "type": "mqtt out",
        "z": "2e9d9a63f5843708",
        "name": "",
        "topic": "omc/01/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1100,
        "wires": []
    },
    {
        "id": "601779c6d973b86e",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "5dcfa381d1f525d2",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 80,
        "wires": []
    },
    {
        "id": "9fadc1d2582c4b9c",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "76cd008ee20ad04e",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 640,
        "wires": []
    },
    {
        "id": "17a8ab0c9514744f",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "5dcfa381d1f525d2",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 200,
        "wires": []
    },
    {
        "id": "f993466202806a0f",
        "type": "ui_chart",
        "z": "2e9d9a63f5843708",
        "name": "voltaje grafico",
        "group": "5dcfa381d1f525d2",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "0c50ef92cf568a54",
        "type": "ui_chart",
        "z": "2e9d9a63f5843708",
        "name": "corriente grafico ",
        "group": "5dcfa381d1f525d2",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "04a71c42b065d960",
        "type": "ui_button",
        "z": "2e9d9a63f5843708",
        "name": "Cambiar control suministro",
        "group": "8a55ae788db337bb",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1160,
        "wires": [
            [
                "7d7126de24350179",
                "db73ed04829042e1"
            ]
        ]
    },
    {
        "id": "67ae83030ff59557",
        "type": "mqtt in",
        "z": "2e9d9a63f5843708",
        "name": "",
        "topic": "omc/01/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 500,
        "wires": [
            [
                "64cbe0cf0f5c11e7",
                "f47e6ac6f28c3c65"
            ]
        ]
    },
    {
        "id": "64cbe0cf0f5c11e7",
        "type": "split",
        "z": "2e9d9a63f5843708",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 500,
        "wires": [
            [
                "41a66be3e09de959"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "41a66be3e09de959",
        "type": "switch",
        "z": "2e9d9a63f5843708",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 500,
        "wires": [
            [
                "1a9d22af4ace8ff1"
            ],
            [
                "c9ab78e5de80c8a5"
            ],
            [
                "fb67c7cf255d944d"
            ],
            [
                "0d72b99fdd1708d3"
            ],
            [
                "9c31e07f82b9e3be"
            ],
            [
                "02a6ac882bf41e1c"
            ],
            [
                "75223437c6171287"
            ],
            [
                "a258a9bb09a6b200"
            ],
            [
                "4b905c3b79fedf61"
            ],
            [
                "56a3f30dad43c435"
            ],
            [
                "259261687c273209"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "1a9d22af4ace8ff1",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 120,
        "wires": [
            [
                "601779c6d973b86e",
                "f993466202806a0f",
                "ac17015cb56787b6"
            ]
        ]
    },
    {
        "id": "c9ab78e5de80c8a5",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 240,
        "wires": [
            [
                "17a8ab0c9514744f",
                "0c50ef92cf568a54",
                "e1cefec0463e94a8"
            ]
        ]
    },
    {
        "id": "fb67c7cf255d944d",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 360,
        "wires": [
            [
                "5d81bcac976e17ea",
                "088c5f18eb8b93c5",
                "c66b58864829dbe5"
            ]
        ]
    },
    {
        "id": "0d72b99fdd1708d3",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 460,
        "wires": [
            [
                "46a34c6b0b56be26",
                "d00d409e4f224ad7",
                "41f7348c573447a9"
            ]
        ]
    },
    {
        "id": "9c31e07f82b9e3be",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 580,
        "wires": [
            [
                "1f972687a8acc36f",
                "19ac63c3274e7994"
            ]
        ]
    },
    {
        "id": "02a6ac882bf41e1c",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 700,
        "wires": [
            [
                "9fadc1d2582c4b9c",
                "0fe7e98b9e797bf4",
                "81963e9dd5c7ca5c",
                "bb0e8f77978cc654"
            ]
        ]
    },
    {
        "id": "a258a9bb09a6b200",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 840,
        "wires": [
            [
                "5d81065e6e04e3d4"
            ]
        ]
    },
    {
        "id": "4b905c3b79fedf61",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 880,
        "wires": [
            [
                "887c4f2e8b6589df"
            ]
        ]
    },
    {
        "id": "5d81bcac976e17ea",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "417b5fa26e929b69",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 320,
        "wires": []
    },
    {
        "id": "088c5f18eb8b93c5",
        "type": "ui_chart",
        "z": "2e9d9a63f5843708",
        "name": "potencia grafico",
        "group": "417b5fa26e929b69",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "46a34c6b0b56be26",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "417b5fa26e929b69",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 440,
        "wires": []
    },
    {
        "id": "1f972687a8acc36f",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "417b5fa26e929b69",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 560,
        "wires": []
    },
    {
        "id": "75223437c6171287",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 800,
        "wires": [
            [
                "f5477b84495477f4"
            ]
        ]
    },
    {
        "id": "f5477b84495477f4",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "8a55ae788db337bb",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 800,
        "wires": []
    },
    {
        "id": "5318d739eae0d6e1",
        "type": "comment",
        "z": "2e9d9a63f5843708",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 80,
        "wires": []
    },
    {
        "id": "0d1ad1f64291e3dc",
        "type": "comment",
        "z": "2e9d9a63f5843708",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 380,
        "wires": []
    },
    {
        "id": "9af5bee99a5ce1f5",
        "type": "comment",
        "z": "2e9d9a63f5843708",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 440,
        "wires": []
    },
    {
        "id": "dce15149d974d8bc",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1280,
        "wires": [
            [
                "9cdfb8767ac6bf92"
            ]
        ]
    },
    {
        "id": "35b3309c53c05101",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1400,
        "wires": []
    },
    {
        "id": "7d7126de24350179",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1280,
        "wires": [
            [
                "dce15149d974d8bc"
            ]
        ]
    },
    {
        "id": "d00d409e4f224ad7",
        "type": "ui_gauge",
        "z": "2e9d9a63f5843708",
        "name": "factor de potencia",
        "group": "417b5fa26e929b69",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 480,
        "wires": []
    },
    {
        "id": "5facbc0a1a7551fe",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1400,
        "wires": [
            [
                "35b3309c53c05101"
            ]
        ]
    },
    {
        "id": "897916b587b73ba8",
        "type": "complete",
        "z": "2e9d9a63f5843708",
        "name": "sí dio aceptar",
        "scope": [
            "b69dc61d7e66f91d",
            "6fe5d9d52e876b0f",
            "457fe55c8c01716f"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1100,
        "wires": [
            [
                "aea318f85c73e785"
            ]
        ]
    },
    {
        "id": "0fe7e98b9e797bf4",
        "type": "ui_led",
        "z": "2e9d9a63f5843708",
        "order": 8,
        "group": "76cd008ee20ad04e",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 680,
        "wires": []
    },
    {
        "id": "db73ed04829042e1",
        "type": "function",
        "z": "2e9d9a63f5843708",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1100,
        "wires": [
            [
                "7ec19aa1f44e907f"
            ]
        ]
    },
    {
        "id": "aea318f85c73e785",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1100,
        "wires": [
            [
                "db73ed04829042e1"
            ]
        ]
    },
    {
        "id": "7ec19aa1f44e907f",
        "type": "switch",
        "z": "2e9d9a63f5843708",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1100,
        "wires": [
            [
                "9e58624.7faaba"
            ]
        ]
    },
    {
        "id": "d48d18792ab50a3d",
        "type": "ui_button",
        "z": "2e9d9a63f5843708",
        "name": "Reiniciar energía",
        "group": "417b5fa26e929b69",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1340,
        "wires": [
            [
                "826d71ea93ed4231",
                "db73ed04829042e1"
            ]
        ]
    },
    {
        "id": "5d2814c3f5905bfd",
        "type": "ui_dropdown",
        "z": "2e9d9a63f5843708",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "8a55ae788db337bb",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1220,
        "wires": [
            [
                "7d7126de24350179",
                "db73ed04829042e1"
            ]
        ]
    },
    {
        "id": "447c9250befca299",
        "type": "ui_led",
        "z": "2e9d9a63f5843708",
        "order": 4,
        "group": "76cd008ee20ad04e",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 620,
        "wires": []
    },
    {
        "id": "f47e6ac6f28c3c65",
        "type": "trigger",
        "z": "2e9d9a63f5843708",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 560,
        "wires": [
            [
                "31fd1b1751a5836f",
                "447c9250befca299",
                "5bb23cb8da450bbe"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "31fd1b1751a5836f",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "76cd008ee20ad04e",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 580,
        "wires": []
    },
    {
        "id": "f77090bce6e2b478",
        "type": "link in",
        "z": "2e9d9a63f5843708",
        "name": "",
        "links": [
            "5d81065e6e04e3d4"
        ],
        "x": 305,
        "y": 1220,
        "wires": [
            [
                "5d2814c3f5905bfd"
            ]
        ]
    },
    {
        "id": "5d81065e6e04e3d4",
        "type": "link out",
        "z": "2e9d9a63f5843708",
        "name": "",
        "mode": "link",
        "links": [
            "f77090bce6e2b478"
        ],
        "x": 1495,
        "y": 840,
        "wires": []
    },
    {
        "id": "588d193faaf4edd8",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "8a55ae788db337bb",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 880,
        "wires": []
    },
    {
        "id": "826d71ea93ed4231",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1340,
        "wires": [
            [
                "dbfbb10db1a82da1"
            ]
        ]
    },
    {
        "id": "070865d7eaab90f6",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "8a55ae788db337bb",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 840,
        "wires": []
    },
    {
        "id": "887c4f2e8b6589df",
        "type": "link out",
        "z": "2e9d9a63f5843708",
        "name": "",
        "mode": "link",
        "links": [
            "abdf8744ae892575"
        ],
        "x": 1495,
        "y": 880,
        "wires": []
    },
    {
        "id": "abdf8744ae892575",
        "type": "link in",
        "z": "2e9d9a63f5843708",
        "name": "",
        "links": [
            "887c4f2e8b6589df"
        ],
        "x": 305,
        "y": 1280,
        "wires": [
            [
                "68e7fad4f41c3d20"
            ]
        ]
    },
    {
        "id": "68e7fad4f41c3d20",
        "type": "ui_dropdown",
        "z": "2e9d9a63f5843708",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "8a55ae788db337bb",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1280,
        "wires": [
            [
                "7d7126de24350179",
                "db73ed04829042e1"
            ]
        ]
    },
    {
        "id": "b8afbb23041348ba",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 540,
        "wires": [
            [
                "64cbe0cf0f5c11e7"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "075cb3f78eaff5fb",
        "type": "ui_button",
        "z": "2e9d9a63f5843708",
        "name": "Reinicio dispositivo",
        "group": "8a55ae788db337bb",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1400,
        "wires": [
            [
                "d8197df038a51564",
                "db73ed04829042e1"
            ]
        ]
    },
    {
        "id": "d8197df038a51564",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1400,
        "wires": [
            [
                "e0e802e3bd996ae8"
            ]
        ]
    },
    {
        "id": "dbfbb10db1a82da1",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1340,
        "wires": [
            [
                "085793a5aecb42aa"
            ]
        ]
    },
    {
        "id": "e0e802e3bd996ae8",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1400,
        "wires": [
            [
                "dfad921c19ed5f93"
            ]
        ]
    },
    {
        "id": "085793a5aecb42aa",
        "type": "switch",
        "z": "2e9d9a63f5843708",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1340,
        "wires": [
            [
                "6fe5d9d52e876b0f"
            ],
            [
                "5facbc0a1a7551fe"
            ]
        ]
    },
    {
        "id": "dfad921c19ed5f93",
        "type": "switch",
        "z": "2e9d9a63f5843708",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1400,
        "wires": [
            [
                "457fe55c8c01716f"
            ],
            [
                "5facbc0a1a7551fe"
            ]
        ]
    },
    {
        "id": "6fe5d9d52e876b0f",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1320,
        "wires": [
            [
                "0dff84907fea3ee8"
            ]
        ]
    },
    {
        "id": "0dff84907fea3ee8",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1320,
        "wires": []
    },
    {
        "id": "457fe55c8c01716f",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1360,
        "wires": [
            [
                "0136e20ba3c64344"
            ]
        ]
    },
    {
        "id": "0136e20ba3c64344",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1360,
        "wires": []
    },
    {
        "id": "ac17015cb56787b6",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 160,
        "wires": []
    },
    {
        "id": "e1cefec0463e94a8",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 280,
        "wires": []
    },
    {
        "id": "c66b58864829dbe5",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 400,
        "wires": []
    },
    {
        "id": "19ac63c3274e7994",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 600,
        "wires": []
    },
    {
        "id": "81963e9dd5c7ca5c",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 720,
        "wires": []
    },
    {
        "id": "5bb23cb8da450bbe",
        "type": "ui_led",
        "z": "2e9d9a63f5843708",
        "order": 2,
        "group": "c1ddd0629c8a913a",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 660,
        "wires": []
    },
    {
        "id": "d2370b6c6415f3d0",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 700,
        "wires": []
    },
    {
        "id": "0c2934a8d3826197",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1280,
        "wires": []
    },
    {
        "id": "b69dc61d7e66f91d",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 1",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1280,
        "wires": [
            [
                "0c2934a8d3826197"
            ]
        ]
    },
    {
        "id": "9cdfb8767ac6bf92",
        "type": "switch",
        "z": "2e9d9a63f5843708",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1280,
        "wires": [
            [
                "b69dc61d7e66f91d"
            ],
            [
                "5facbc0a1a7551fe"
            ]
        ]
    },
    {
        "id": "b391eb827e16a251",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "76cd008ee20ad04e",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 660,
        "wires": []
    },
    {
        "id": "babb1d50dcdcbd08",
        "type": "function",
        "z": "2e9d9a63f5843708",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[1] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[1]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[1];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[1];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[1];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 680,
        "wires": [
            [
                "a88fd3f69769bc29"
            ],
            [
                "b391eb827e16a251",
                "eac7dd30261d15ed"
            ],
            [
                "fe8ab7cfe58d013e",
                "afaeaa2e7f5f7ca1"
            ]
        ]
    },
    {
        "id": "918d0bd788580cf5",
        "type": "link in",
        "z": "2e9d9a63f5843708",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 740,
        "wires": [
            [
                "babb1d50dcdcbd08"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "b8162ab845ac93de",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "76cd008ee20ad04e",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 920,
        "wires": []
    },
    {
        "id": "bb0e8f77978cc654",
        "type": "ui_led",
        "z": "2e9d9a63f5843708",
        "order": 6,
        "group": "c1ddd0629c8a913a",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 760,
        "wires": []
    },
    {
        "id": "56a3f30dad43c435",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 920,
        "wires": [
            [
                "b8162ab845ac93de"
            ]
        ]
    },
    {
        "id": "a88fd3f69769bc29",
        "type": "mqtt in",
        "z": "2e9d9a63f5843708",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 600,
        "wires": [
            [
                "31fd1b1751a5836f",
                "5bb23cb8da450bbe",
                "447c9250befca299",
                "b8afbb23041348ba"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "5f7dec5f86b1ad7d",
        "type": "function",
        "z": "2e9d9a63f5843708",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 960,
        "wires": [
            [
                "8ce9ec98d2ec432c"
            ]
        ]
    },
    {
        "id": "8ce9ec98d2ec432c",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "76cd008ee20ad04e",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 960,
        "wires": []
    },
    {
        "id": "259261687c273209",
        "type": "change",
        "z": "2e9d9a63f5843708",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 960,
        "wires": [
            [
                "5f7dec5f86b1ad7d"
            ]
        ]
    },
    {
        "id": "c0170d693bf7a8e4",
        "type": "ui_toast",
        "z": "2e9d9a63f5843708",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1460,
        "wires": [
            []
        ]
    },
    {
        "id": "6aa0940e8d6884c1",
        "type": "ui_button",
        "z": "2e9d9a63f5843708",
        "name": "ayuda",
        "group": "8a55ae788db337bb",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1460,
        "wires": [
            [
                "c0170d693bf7a8e4"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "fe8ab7cfe58d013e",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "76cd008ee20ad04e",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 740,
        "wires": []
    },
    {
        "id": "c7db893072e7329d",
        "type": "comment",
        "z": "2e9d9a63f5843708",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 440,
        "wires": []
    },
    {
        "id": "c850b42899f3ada1",
        "type": "comment",
        "z": "2e9d9a63f5843708",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 40,
        "wires": []
    },
    {
        "id": "918b2ebb9b4b8d92",
        "type": "comment",
        "z": "2e9d9a63f5843708",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1040,
        "wires": []
    },
    {
        "id": "eac7dd30261d15ed",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 700,
        "wires": []
    },
    {
        "id": "afaeaa2e7f5f7ca1",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 780,
        "wires": []
    },
    {
        "id": "41f7348c573447a9",
        "type": "ui_text",
        "z": "2e9d9a63f5843708",
        "group": "c1ddd0629c8a913a",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 520,
        "wires": []
    },
    {
        "id": "ae3549b808f5ae11",
        "type": "inject",
        "z": "2e9d9a63f5843708",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 620,
        "wires": [
            [
                "babb1d50dcdcbd08"
            ]
        ]
    },
    {
        "id": "bd0d112a96408f4b",
        "type": "mqtt out",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "topic": "omc/02/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1080,
        "wires": []
    },
    {
        "id": "1c0c2558b9ae4fdd",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8b9036acdf4eec01",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 60,
        "wires": []
    },
    {
        "id": "1984271b67378264",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8d73273d7f6bf478",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 620,
        "wires": []
    },
    {
        "id": "d6d4389c69a0ee00",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8b9036acdf4eec01",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 180,
        "wires": []
    },
    {
        "id": "c59cd4bd44f030b5",
        "type": "ui_chart",
        "z": "6f4784e8cf2fe1e0",
        "name": "voltaje grafico",
        "group": "8b9036acdf4eec01",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "aa5224e726a17e89",
        "type": "ui_chart",
        "z": "6f4784e8cf2fe1e0",
        "name": "corriente grafico ",
        "group": "8b9036acdf4eec01",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "20d4a46bcbac625b",
        "type": "ui_button",
        "z": "6f4784e8cf2fe1e0",
        "name": "Cambiar control suministro",
        "group": "18679a6dcefc7a0b",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1140,
        "wires": [
            [
                "56c8ef9cb6769397",
                "2601792016eb17df"
            ]
        ]
    },
    {
        "id": "edcc437ba4bfa4c8",
        "type": "mqtt in",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "topic": "omc/02/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 480,
        "wires": [
            [
                "9d97ebcfac440175",
                "fcc173d6becd00ec"
            ]
        ]
    },
    {
        "id": "9d97ebcfac440175",
        "type": "split",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 480,
        "wires": [
            [
                "1201e4c786ee56f3"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "1201e4c786ee56f3",
        "type": "switch",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 480,
        "wires": [
            [
                "223450246aa292fe"
            ],
            [
                "3452d470acde8147"
            ],
            [
                "b20b2eac5e570a7e"
            ],
            [
                "a1cbc7609f11b97f"
            ],
            [
                "040365ecf14143b7"
            ],
            [
                "6f08c355d7308751"
            ],
            [
                "51fa691c9fefe356"
            ],
            [
                "a8e9164d80e4fa32"
            ],
            [
                "7135d93685b8b30f"
            ],
            [
                "539f8f5168d0bb39"
            ],
            [
                "f4c856c102aa11e8"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "223450246aa292fe",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 100,
        "wires": [
            [
                "1c0c2558b9ae4fdd",
                "c59cd4bd44f030b5",
                "615277625877d0a6"
            ]
        ]
    },
    {
        "id": "3452d470acde8147",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 220,
        "wires": [
            [
                "d6d4389c69a0ee00",
                "aa5224e726a17e89",
                "575927a366cf19f1"
            ]
        ]
    },
    {
        "id": "b20b2eac5e570a7e",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 340,
        "wires": [
            [
                "30e69bd44cff109c",
                "3cfd7bcc9e4b870b",
                "7fbdd07dde5ab768"
            ]
        ]
    },
    {
        "id": "a1cbc7609f11b97f",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 440,
        "wires": [
            [
                "2e852a74d8bdd5a7",
                "9a421847ec7dc3cb",
                "013c22d5d0113fbc"
            ]
        ]
    },
    {
        "id": "040365ecf14143b7",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 560,
        "wires": [
            [
                "28ab34cd3a497037",
                "861a9d8457b0057d"
            ]
        ]
    },
    {
        "id": "6f08c355d7308751",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 680,
        "wires": [
            [
                "1984271b67378264",
                "4f748da431c822f3",
                "f9d065048d156127",
                "d06684b9bfd4e24a"
            ]
        ]
    },
    {
        "id": "a8e9164d80e4fa32",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 820,
        "wires": [
            [
                "ecfdfd36a20ccdb6"
            ]
        ]
    },
    {
        "id": "7135d93685b8b30f",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 860,
        "wires": [
            [
                "0a15f79eef03df39"
            ]
        ]
    },
    {
        "id": "30e69bd44cff109c",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "fd39813e24d16e68",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 300,
        "wires": []
    },
    {
        "id": "3cfd7bcc9e4b870b",
        "type": "ui_chart",
        "z": "6f4784e8cf2fe1e0",
        "name": "potencia grafico",
        "group": "fd39813e24d16e68",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "2e852a74d8bdd5a7",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "fd39813e24d16e68",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 420,
        "wires": []
    },
    {
        "id": "28ab34cd3a497037",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "fd39813e24d16e68",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 540,
        "wires": []
    },
    {
        "id": "51fa691c9fefe356",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 780,
        "wires": [
            [
                "b03f35b65762ec95"
            ]
        ]
    },
    {
        "id": "b03f35b65762ec95",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "18679a6dcefc7a0b",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 780,
        "wires": []
    },
    {
        "id": "1307800165fd094b",
        "type": "comment",
        "z": "6f4784e8cf2fe1e0",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 60,
        "wires": []
    },
    {
        "id": "2c41b880931faa4c",
        "type": "comment",
        "z": "6f4784e8cf2fe1e0",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 360,
        "wires": []
    },
    {
        "id": "7bd848435ad67cf6",
        "type": "comment",
        "z": "6f4784e8cf2fe1e0",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 420,
        "wires": []
    },
    {
        "id": "c72c6b5932ee2526",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1260,
        "wires": [
            [
                "3504d5d73afbb52d"
            ]
        ]
    },
    {
        "id": "a1163716a98c04bc",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1380,
        "wires": []
    },
    {
        "id": "56c8ef9cb6769397",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1260,
        "wires": [
            [
                "c72c6b5932ee2526"
            ]
        ]
    },
    {
        "id": "9a421847ec7dc3cb",
        "type": "ui_gauge",
        "z": "6f4784e8cf2fe1e0",
        "name": "factor de potencia",
        "group": "fd39813e24d16e68",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 460,
        "wires": []
    },
    {
        "id": "d1c574e9502bf4fd",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1380,
        "wires": [
            [
                "a1163716a98c04bc"
            ]
        ]
    },
    {
        "id": "6cb50d38bb33101c",
        "type": "complete",
        "z": "6f4784e8cf2fe1e0",
        "name": "sí dio aceptar",
        "scope": [
            "2edc69c446ef49f7",
            "5bda6a24555eca13",
            "b67962838328a9fb"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1080,
        "wires": [
            [
                "136ac1d03e657904"
            ]
        ]
    },
    {
        "id": "4f748da431c822f3",
        "type": "ui_led",
        "z": "6f4784e8cf2fe1e0",
        "order": 8,
        "group": "8d73273d7f6bf478",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 660,
        "wires": []
    },
    {
        "id": "2601792016eb17df",
        "type": "function",
        "z": "6f4784e8cf2fe1e0",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1080,
        "wires": [
            [
                "94df3c7cc3ada483"
            ]
        ]
    },
    {
        "id": "136ac1d03e657904",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1080,
        "wires": [
            [
                "2601792016eb17df"
            ]
        ]
    },
    {
        "id": "94df3c7cc3ada483",
        "type": "switch",
        "z": "6f4784e8cf2fe1e0",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1080,
        "wires": [
            [
                "bd0d112a96408f4b"
            ]
        ]
    },
    {
        "id": "f924251f85758245",
        "type": "ui_button",
        "z": "6f4784e8cf2fe1e0",
        "name": "Reiniciar energía",
        "group": "fd39813e24d16e68",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1320,
        "wires": [
            [
                "793e23cf201f29af",
                "2601792016eb17df"
            ]
        ]
    },
    {
        "id": "66e922c504f26a8e",
        "type": "ui_dropdown",
        "z": "6f4784e8cf2fe1e0",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "18679a6dcefc7a0b",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1200,
        "wires": [
            [
                "56c8ef9cb6769397",
                "2601792016eb17df"
            ]
        ]
    },
    {
        "id": "fb158ca25b190dc9",
        "type": "ui_led",
        "z": "6f4784e8cf2fe1e0",
        "order": 3,
        "group": "8d73273d7f6bf478",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 600,
        "wires": []
    },
    {
        "id": "fcc173d6becd00ec",
        "type": "trigger",
        "z": "6f4784e8cf2fe1e0",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 540,
        "wires": [
            [
                "0510706ab0c75add",
                "fb158ca25b190dc9",
                "124ffab86ea09322"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "0510706ab0c75add",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8d73273d7f6bf478",
        "order": 2,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 560,
        "wires": []
    },
    {
        "id": "39d044bad6282675",
        "type": "link in",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "links": [
            "ecfdfd36a20ccdb6"
        ],
        "x": 305,
        "y": 1200,
        "wires": [
            [
                "66e922c504f26a8e"
            ]
        ]
    },
    {
        "id": "ecfdfd36a20ccdb6",
        "type": "link out",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "mode": "link",
        "links": [
            "39d044bad6282675"
        ],
        "x": 1495,
        "y": 820,
        "wires": []
    },
    {
        "id": "1bc4187f8302b001",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "18679a6dcefc7a0b",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 860,
        "wires": []
    },
    {
        "id": "793e23cf201f29af",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1320,
        "wires": [
            [
                "c6a18e1a6bc294c9"
            ]
        ]
    },
    {
        "id": "45a2bc08a0c9607e",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "18679a6dcefc7a0b",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 820,
        "wires": []
    },
    {
        "id": "0a15f79eef03df39",
        "type": "link out",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "mode": "link",
        "links": [
            "d46395f4a96b8b1e"
        ],
        "x": 1495,
        "y": 860,
        "wires": []
    },
    {
        "id": "d46395f4a96b8b1e",
        "type": "link in",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "links": [
            "0a15f79eef03df39"
        ],
        "x": 305,
        "y": 1260,
        "wires": [
            [
                "defbbc8e812e6059"
            ]
        ]
    },
    {
        "id": "defbbc8e812e6059",
        "type": "ui_dropdown",
        "z": "6f4784e8cf2fe1e0",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "18679a6dcefc7a0b",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1260,
        "wires": [
            [
                "56c8ef9cb6769397",
                "2601792016eb17df"
            ]
        ]
    },
    {
        "id": "1405a58fd773243b",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 520,
        "wires": [
            [
                "9d97ebcfac440175"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "568be2e79dd6d55f",
        "type": "ui_button",
        "z": "6f4784e8cf2fe1e0",
        "name": "Reinicio dispositivo",
        "group": "18679a6dcefc7a0b",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1380,
        "wires": [
            [
                "7e5f14013d9cc177",
                "2601792016eb17df"
            ]
        ]
    },
    {
        "id": "7e5f14013d9cc177",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1380,
        "wires": [
            [
                "55eee7190e549004"
            ]
        ]
    },
    {
        "id": "c6a18e1a6bc294c9",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1320,
        "wires": [
            [
                "1e2d230007fd7974"
            ]
        ]
    },
    {
        "id": "55eee7190e549004",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1380,
        "wires": [
            [
                "31e3ddfde4d435e5"
            ]
        ]
    },
    {
        "id": "1e2d230007fd7974",
        "type": "switch",
        "z": "6f4784e8cf2fe1e0",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1320,
        "wires": [
            [
                "5bda6a24555eca13"
            ],
            [
                "d1c574e9502bf4fd"
            ]
        ]
    },
    {
        "id": "31e3ddfde4d435e5",
        "type": "switch",
        "z": "6f4784e8cf2fe1e0",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1380,
        "wires": [
            [
                "b67962838328a9fb"
            ],
            [
                "d1c574e9502bf4fd"
            ]
        ]
    },
    {
        "id": "5bda6a24555eca13",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 2",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1300,
        "wires": [
            [
                "4863292d9fcd7db5"
            ]
        ]
    },
    {
        "id": "4863292d9fcd7db5",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1300,
        "wires": []
    },
    {
        "id": "b67962838328a9fb",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 2",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1340,
        "wires": [
            [
                "8e94f2e963a6252b"
            ]
        ]
    },
    {
        "id": "8e94f2e963a6252b",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1340,
        "wires": []
    },
    {
        "id": "615277625877d0a6",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 140,
        "wires": []
    },
    {
        "id": "575927a366cf19f1",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 260,
        "wires": []
    },
    {
        "id": "7fbdd07dde5ab768",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 380,
        "wires": []
    },
    {
        "id": "861a9d8457b0057d",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 580,
        "wires": []
    },
    {
        "id": "f9d065048d156127",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 700,
        "wires": []
    },
    {
        "id": "124ffab86ea09322",
        "type": "ui_led",
        "z": "6f4784e8cf2fe1e0",
        "order": 2,
        "group": "3af6d3cba2425ff8",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 640,
        "wires": []
    },
    {
        "id": "e90ddfc919af4ff0",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 680,
        "wires": []
    },
    {
        "id": "3646eaa9f45d82d8",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1260,
        "wires": []
    },
    {
        "id": "2edc69c446ef49f7",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 2",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1260,
        "wires": [
            [
                "3646eaa9f45d82d8"
            ]
        ]
    },
    {
        "id": "3504d5d73afbb52d",
        "type": "switch",
        "z": "6f4784e8cf2fe1e0",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1260,
        "wires": [
            [
                "2edc69c446ef49f7"
            ],
            [
                "d1c574e9502bf4fd"
            ]
        ]
    },
    {
        "id": "03abad9b8ce73ad9",
        "type": "function",
        "z": "6f4784e8cf2fe1e0",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[2] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[2]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[2];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[2];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[2];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 660,
        "wires": [
            [
                "451ea4b3ce02a938"
            ],
            [
                "7441c08dd4bdf07a",
                "8edb72b3c3009f5d"
            ],
            [
                "5ba845f79e00aa51",
                "972a45d071eef9e4"
            ]
        ]
    },
    {
        "id": "f20664a708ce1be9",
        "type": "link in",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 165,
        "y": 720,
        "wires": [
            [
                "03abad9b8ce73ad9"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "b1723faa63b195cd",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8d73273d7f6bf478",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 900,
        "wires": []
    },
    {
        "id": "d06684b9bfd4e24a",
        "type": "ui_led",
        "z": "6f4784e8cf2fe1e0",
        "order": 6,
        "group": "3af6d3cba2425ff8",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 740,
        "wires": []
    },
    {
        "id": "539f8f5168d0bb39",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 900,
        "wires": [
            [
                "b1723faa63b195cd"
            ]
        ]
    },
    {
        "id": "451ea4b3ce02a938",
        "type": "mqtt in",
        "z": "6f4784e8cf2fe1e0",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 580,
        "wires": [
            [
                "0510706ab0c75add",
                "124ffab86ea09322",
                "fb158ca25b190dc9",
                "1405a58fd773243b"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "c75afcfd129d903f",
        "type": "function",
        "z": "6f4784e8cf2fe1e0",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 940,
        "wires": [
            [
                "f43e5d5da487f4c3"
            ]
        ]
    },
    {
        "id": "f43e5d5da487f4c3",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8d73273d7f6bf478",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 940,
        "wires": []
    },
    {
        "id": "f4c856c102aa11e8",
        "type": "change",
        "z": "6f4784e8cf2fe1e0",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 940,
        "wires": [
            [
                "c75afcfd129d903f"
            ]
        ]
    },
    {
        "id": "be5f1890a74f806c",
        "type": "ui_toast",
        "z": "6f4784e8cf2fe1e0",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "d10e0decb08d1a08",
        "type": "ui_button",
        "z": "6f4784e8cf2fe1e0",
        "name": "ayuda",
        "group": "18679a6dcefc7a0b",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1440,
        "wires": [
            [
                "be5f1890a74f806c"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "4917c8f88cd94c55",
        "type": "comment",
        "z": "6f4784e8cf2fe1e0",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 210,
        "y": 420,
        "wires": []
    },
    {
        "id": "9e5ae66389bca6b4",
        "type": "comment",
        "z": "6f4784e8cf2fe1e0",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 20,
        "wires": []
    },
    {
        "id": "06d1f07c8daa3bf7",
        "type": "comment",
        "z": "6f4784e8cf2fe1e0",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1020,
        "wires": []
    },
    {
        "id": "7441c08dd4bdf07a",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8d73273d7f6bf478",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 640,
        "wires": []
    },
    {
        "id": "5ba845f79e00aa51",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "8d73273d7f6bf478",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 720,
        "wires": []
    },
    {
        "id": "8edb72b3c3009f5d",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 680,
        "wires": []
    },
    {
        "id": "972a45d071eef9e4",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 760,
        "wires": []
    },
    {
        "id": "013c22d5d0113fbc",
        "type": "ui_text",
        "z": "6f4784e8cf2fe1e0",
        "group": "3af6d3cba2425ff8",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 500,
        "wires": []
    },
    {
        "id": "465511a4fc582bbb",
        "type": "inject",
        "z": "6f4784e8cf2fe1e0",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 600,
        "wires": [
            [
                "03abad9b8ce73ad9"
            ]
        ]
    },
    {
        "id": "0669728c018a9055",
        "type": "mqtt out",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "topic": "omc/03/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1120,
        "wires": []
    },
    {
        "id": "5a7ea62f5ddb753f",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fb3d9bd6f82624a7",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 100,
        "wires": []
    },
    {
        "id": "8107c8883d038c7f",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fd2c8392ccae51f8",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 660,
        "wires": []
    },
    {
        "id": "c45bac8e06cbbbf4",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fb3d9bd6f82624a7",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 220,
        "wires": []
    },
    {
        "id": "fc967b0683b073ad",
        "type": "ui_chart",
        "z": "960c0b986ae7e0fc",
        "name": "voltaje grafico",
        "group": "fb3d9bd6f82624a7",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "681e354721999dbb",
        "type": "ui_chart",
        "z": "960c0b986ae7e0fc",
        "name": "corriente grafico ",
        "group": "fb3d9bd6f82624a7",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "ea3d61154121eb4c",
        "type": "ui_button",
        "z": "960c0b986ae7e0fc",
        "name": "Cambiar control suministro",
        "group": "0fdff6ad838a93ce",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1180,
        "wires": [
            [
                "e94b2563183c56bc",
                "46c9fb55e404ae87"
            ]
        ]
    },
    {
        "id": "ae07988952a9481d",
        "type": "mqtt in",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "topic": "omc/03/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 520,
        "wires": [
            [
                "b769bd6d1c3cbbe3",
                "c0a19eb72fa64cfe"
            ]
        ]
    },
    {
        "id": "b769bd6d1c3cbbe3",
        "type": "split",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 520,
        "wires": [
            [
                "2cb377ae3746890f"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "2cb377ae3746890f",
        "type": "switch",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 520,
        "wires": [
            [
                "bfb50018e251a9e9"
            ],
            [
                "c5b4aa186ea343f0"
            ],
            [
                "9f2ddf95ca2b3776"
            ],
            [
                "6845359f09282152"
            ],
            [
                "23a23f2c0943cf62"
            ],
            [
                "8609e09493ace158"
            ],
            [
                "191f3460eed7a9ca"
            ],
            [
                "e3ea5d004415ccbb"
            ],
            [
                "ed84ced6d6ba4644"
            ],
            [
                "fb14531fe55fed64"
            ],
            [
                "699bce233440917e"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "bfb50018e251a9e9",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 140,
        "wires": [
            [
                "5a7ea62f5ddb753f",
                "fc967b0683b073ad",
                "82c48aabc3ba2fde"
            ]
        ]
    },
    {
        "id": "c5b4aa186ea343f0",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 260,
        "wires": [
            [
                "c45bac8e06cbbbf4",
                "681e354721999dbb",
                "56914604f185b9a1"
            ]
        ]
    },
    {
        "id": "9f2ddf95ca2b3776",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 380,
        "wires": [
            [
                "70ceb3ca08ef302d",
                "8ac96b25248bd991",
                "39393c377d118ebb"
            ]
        ]
    },
    {
        "id": "6845359f09282152",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 480,
        "wires": [
            [
                "2390f33d1c9c3261",
                "cea1ccbb122c8711",
                "06577e48cb4070c2"
            ]
        ]
    },
    {
        "id": "23a23f2c0943cf62",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 600,
        "wires": [
            [
                "d2fa9dac95aba27c",
                "e7d775992e539f99"
            ]
        ]
    },
    {
        "id": "8609e09493ace158",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 720,
        "wires": [
            [
                "8107c8883d038c7f",
                "65adb1df5af40c6b",
                "cb718667f87a49e6",
                "e8ac5db364e94c21"
            ]
        ]
    },
    {
        "id": "e3ea5d004415ccbb",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 860,
        "wires": [
            [
                "a3891205adf323f6"
            ]
        ]
    },
    {
        "id": "ed84ced6d6ba4644",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 900,
        "wires": [
            [
                "aa8055af19afebee"
            ]
        ]
    },
    {
        "id": "70ceb3ca08ef302d",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "d2d19e7b8177d7e3",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 340,
        "wires": []
    },
    {
        "id": "8ac96b25248bd991",
        "type": "ui_chart",
        "z": "960c0b986ae7e0fc",
        "name": "potencia grafico",
        "group": "d2d19e7b8177d7e3",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "2390f33d1c9c3261",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "d2d19e7b8177d7e3",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 460,
        "wires": []
    },
    {
        "id": "d2fa9dac95aba27c",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "d2d19e7b8177d7e3",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 580,
        "wires": []
    },
    {
        "id": "191f3460eed7a9ca",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 820,
        "wires": [
            [
                "809bc55415dfd6f0"
            ]
        ]
    },
    {
        "id": "809bc55415dfd6f0",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "0fdff6ad838a93ce",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 820,
        "wires": []
    },
    {
        "id": "be21744b10b7a5d8",
        "type": "comment",
        "z": "960c0b986ae7e0fc",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 100,
        "wires": []
    },
    {
        "id": "992bbfe59aa4877c",
        "type": "comment",
        "z": "960c0b986ae7e0fc",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 400,
        "wires": []
    },
    {
        "id": "0c8cd7456bac725c",
        "type": "comment",
        "z": "960c0b986ae7e0fc",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 460,
        "wires": []
    },
    {
        "id": "4bd90eae5aa55a15",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1300,
        "wires": [
            [
                "b3630d09353920a7"
            ]
        ]
    },
    {
        "id": "6f6efd65b17e0fee",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1420,
        "wires": []
    },
    {
        "id": "e94b2563183c56bc",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1300,
        "wires": [
            [
                "4bd90eae5aa55a15"
            ]
        ]
    },
    {
        "id": "cea1ccbb122c8711",
        "type": "ui_gauge",
        "z": "960c0b986ae7e0fc",
        "name": "factor de potencia",
        "group": "d2d19e7b8177d7e3",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 500,
        "wires": []
    },
    {
        "id": "13219c844c03f9c4",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1420,
        "wires": [
            [
                "6f6efd65b17e0fee"
            ]
        ]
    },
    {
        "id": "98e1db08f929fc60",
        "type": "complete",
        "z": "960c0b986ae7e0fc",
        "name": "sí dio aceptar",
        "scope": [
            "f311f1814945a441",
            "f0c05ab51f0fa3e2",
            "54ccb5e7c04f153c"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1120,
        "wires": [
            [
                "d6ce32500e3d1de5"
            ]
        ]
    },
    {
        "id": "65adb1df5af40c6b",
        "type": "ui_led",
        "z": "960c0b986ae7e0fc",
        "order": 8,
        "group": "fd2c8392ccae51f8",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 700,
        "wires": []
    },
    {
        "id": "46c9fb55e404ae87",
        "type": "function",
        "z": "960c0b986ae7e0fc",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1120,
        "wires": [
            [
                "26cb3df9b8221971"
            ]
        ]
    },
    {
        "id": "d6ce32500e3d1de5",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1120,
        "wires": [
            [
                "46c9fb55e404ae87"
            ]
        ]
    },
    {
        "id": "26cb3df9b8221971",
        "type": "switch",
        "z": "960c0b986ae7e0fc",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1120,
        "wires": [
            [
                "0669728c018a9055"
            ]
        ]
    },
    {
        "id": "0be48159fb58bedc",
        "type": "ui_button",
        "z": "960c0b986ae7e0fc",
        "name": "Reiniciar energía",
        "group": "d2d19e7b8177d7e3",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1360,
        "wires": [
            [
                "a3654e9d56e20ba7",
                "46c9fb55e404ae87"
            ]
        ]
    },
    {
        "id": "0a61462d8d6a9ec2",
        "type": "ui_dropdown",
        "z": "960c0b986ae7e0fc",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "0fdff6ad838a93ce",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1240,
        "wires": [
            [
                "e94b2563183c56bc",
                "46c9fb55e404ae87"
            ]
        ]
    },
    {
        "id": "2ef368b506574cf2",
        "type": "ui_led",
        "z": "960c0b986ae7e0fc",
        "order": 4,
        "group": "fd2c8392ccae51f8",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 640,
        "wires": []
    },
    {
        "id": "c0a19eb72fa64cfe",
        "type": "trigger",
        "z": "960c0b986ae7e0fc",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 580,
        "wires": [
            [
                "8d1cd44771804cfd",
                "2ef368b506574cf2",
                "77a45d4691a2230f"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "8d1cd44771804cfd",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fd2c8392ccae51f8",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 600,
        "wires": []
    },
    {
        "id": "8479ba62784dc524",
        "type": "link in",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "links": [
            "a3891205adf323f6"
        ],
        "x": 305,
        "y": 1240,
        "wires": [
            [
                "0a61462d8d6a9ec2"
            ]
        ]
    },
    {
        "id": "a3891205adf323f6",
        "type": "link out",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "mode": "link",
        "links": [
            "8479ba62784dc524"
        ],
        "x": 1495,
        "y": 860,
        "wires": []
    },
    {
        "id": "16d4585e92f86b00",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "0fdff6ad838a93ce",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 900,
        "wires": []
    },
    {
        "id": "a3654e9d56e20ba7",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1360,
        "wires": [
            [
                "6f37e38987503dce"
            ]
        ]
    },
    {
        "id": "670b40720e430a92",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "0fdff6ad838a93ce",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 860,
        "wires": []
    },
    {
        "id": "aa8055af19afebee",
        "type": "link out",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "mode": "link",
        "links": [
            "4bfab1dc48b1a402"
        ],
        "x": 1495,
        "y": 900,
        "wires": []
    },
    {
        "id": "4bfab1dc48b1a402",
        "type": "link in",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "links": [
            "aa8055af19afebee"
        ],
        "x": 305,
        "y": 1300,
        "wires": [
            [
                "ce98cfa296d89c49"
            ]
        ]
    },
    {
        "id": "ce98cfa296d89c49",
        "type": "ui_dropdown",
        "z": "960c0b986ae7e0fc",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "0fdff6ad838a93ce",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1300,
        "wires": [
            [
                "e94b2563183c56bc",
                "46c9fb55e404ae87"
            ]
        ]
    },
    {
        "id": "de36f4ecf7d00605",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 560,
        "wires": [
            [
                "b769bd6d1c3cbbe3"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "54ca65276689d8a8",
        "type": "ui_button",
        "z": "960c0b986ae7e0fc",
        "name": "Reinicio dispositivo",
        "group": "0fdff6ad838a93ce",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1420,
        "wires": [
            [
                "6fa64cb70cf508d6",
                "46c9fb55e404ae87"
            ]
        ]
    },
    {
        "id": "6fa64cb70cf508d6",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1420,
        "wires": [
            [
                "6dca05150392b02d"
            ]
        ]
    },
    {
        "id": "6f37e38987503dce",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1360,
        "wires": [
            [
                "c4774290eec6251c"
            ]
        ]
    },
    {
        "id": "6dca05150392b02d",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1420,
        "wires": [
            [
                "ce06729488d8f6b0"
            ]
        ]
    },
    {
        "id": "c4774290eec6251c",
        "type": "switch",
        "z": "960c0b986ae7e0fc",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1360,
        "wires": [
            [
                "f0c05ab51f0fa3e2"
            ],
            [
                "13219c844c03f9c4"
            ]
        ]
    },
    {
        "id": "ce06729488d8f6b0",
        "type": "switch",
        "z": "960c0b986ae7e0fc",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1420,
        "wires": [
            [
                "54ccb5e7c04f153c"
            ],
            [
                "13219c844c03f9c4"
            ]
        ]
    },
    {
        "id": "f0c05ab51f0fa3e2",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 3",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1340,
        "wires": [
            [
                "539070ca6baba7f2"
            ]
        ]
    },
    {
        "id": "539070ca6baba7f2",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1340,
        "wires": []
    },
    {
        "id": "54ccb5e7c04f153c",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 3",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1380,
        "wires": [
            [
                "f4dfa8c23de6ef9c"
            ]
        ]
    },
    {
        "id": "f4dfa8c23de6ef9c",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1380,
        "wires": []
    },
    {
        "id": "82c48aabc3ba2fde",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 180,
        "wires": []
    },
    {
        "id": "56914604f185b9a1",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 300,
        "wires": []
    },
    {
        "id": "39393c377d118ebb",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 420,
        "wires": []
    },
    {
        "id": "e7d775992e539f99",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 620,
        "wires": []
    },
    {
        "id": "cb718667f87a49e6",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 740,
        "wires": []
    },
    {
        "id": "77a45d4691a2230f",
        "type": "ui_led",
        "z": "960c0b986ae7e0fc",
        "order": 2,
        "group": "f9dfc9a220a82de7",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 680,
        "wires": []
    },
    {
        "id": "628722f0e6c40312",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 720,
        "wires": []
    },
    {
        "id": "b409a8882d65b8da",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1300,
        "wires": []
    },
    {
        "id": "f311f1814945a441",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 3",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1300,
        "wires": [
            [
                "b409a8882d65b8da"
            ]
        ]
    },
    {
        "id": "b3630d09353920a7",
        "type": "switch",
        "z": "960c0b986ae7e0fc",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1300,
        "wires": [
            [
                "f311f1814945a441"
            ],
            [
                "13219c844c03f9c4"
            ]
        ]
    },
    {
        "id": "9a8961ea3ea8bcde",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fd2c8392ccae51f8",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 680,
        "wires": []
    },
    {
        "id": "e1fba540810a23a3",
        "type": "function",
        "z": "960c0b986ae7e0fc",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[3] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[3]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[3];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[3];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[3];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 700,
        "wires": [
            [
                "ace344d7e6b82d2c"
            ],
            [
                "9a8961ea3ea8bcde",
                "f1384cbdf01a4980"
            ],
            [
                "0f27cd724fd89d42",
                "55740ff148add5c7"
            ]
        ]
    },
    {
        "id": "8191f509c72131bf",
        "type": "link in",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 760,
        "wires": [
            [
                "e1fba540810a23a3"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "9f790ab9507ff8b0",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fd2c8392ccae51f8",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 940,
        "wires": []
    },
    {
        "id": "e8ac5db364e94c21",
        "type": "ui_led",
        "z": "960c0b986ae7e0fc",
        "order": 6,
        "group": "f9dfc9a220a82de7",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 780,
        "wires": []
    },
    {
        "id": "fb14531fe55fed64",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 940,
        "wires": [
            [
                "9f790ab9507ff8b0"
            ]
        ]
    },
    {
        "id": "ace344d7e6b82d2c",
        "type": "mqtt in",
        "z": "960c0b986ae7e0fc",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 620,
        "wires": [
            [
                "8d1cd44771804cfd",
                "77a45d4691a2230f",
                "2ef368b506574cf2",
                "de36f4ecf7d00605"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "c818dc4cbf15d4e0",
        "type": "function",
        "z": "960c0b986ae7e0fc",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 980,
        "wires": [
            [
                "9b3b7ae66cd6b8e5"
            ]
        ]
    },
    {
        "id": "9b3b7ae66cd6b8e5",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fd2c8392ccae51f8",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 980,
        "wires": []
    },
    {
        "id": "699bce233440917e",
        "type": "change",
        "z": "960c0b986ae7e0fc",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 980,
        "wires": [
            [
                "c818dc4cbf15d4e0"
            ]
        ]
    },
    {
        "id": "91cab02b1db3f296",
        "type": "ui_toast",
        "z": "960c0b986ae7e0fc",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "fd4b9904ee08f81f",
        "type": "ui_button",
        "z": "960c0b986ae7e0fc",
        "name": "ayuda",
        "group": "0fdff6ad838a93ce",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1480,
        "wires": [
            [
                "91cab02b1db3f296"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "0f27cd724fd89d42",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "fd2c8392ccae51f8",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 760,
        "wires": []
    },
    {
        "id": "44d641efa4606250",
        "type": "comment",
        "z": "960c0b986ae7e0fc",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 460,
        "wires": []
    },
    {
        "id": "dc44f2b4c55b0731",
        "type": "comment",
        "z": "960c0b986ae7e0fc",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 60,
        "wires": []
    },
    {
        "id": "14d58be3203d8a42",
        "type": "comment",
        "z": "960c0b986ae7e0fc",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1060,
        "wires": []
    },
    {
        "id": "06577e48cb4070c2",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 540,
        "wires": []
    },
    {
        "id": "08f8c7e2e47c2d8e",
        "type": "inject",
        "z": "960c0b986ae7e0fc",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 640,
        "wires": [
            [
                "e1fba540810a23a3"
            ]
        ]
    },
    {
        "id": "f1384cbdf01a4980",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 720,
        "wires": []
    },
    {
        "id": "55740ff148add5c7",
        "type": "ui_text",
        "z": "960c0b986ae7e0fc",
        "group": "f9dfc9a220a82de7",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 800,
        "wires": []
    },
    {
        "id": "8733a458e13df543",
        "type": "mqtt out",
        "z": "3b3439c6de64720a",
        "name": "",
        "topic": "omc/04/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1080,
        "wires": []
    },
    {
        "id": "d2464f2f256d0f9b",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "5f484414b9f44515",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 60,
        "wires": []
    },
    {
        "id": "697ff966c64bc0d5",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "7290dfb77542495b",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 620,
        "wires": []
    },
    {
        "id": "b18cdc1299d39daf",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "5f484414b9f44515",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 180,
        "wires": []
    },
    {
        "id": "95c094f83ff60e4b",
        "type": "ui_chart",
        "z": "3b3439c6de64720a",
        "name": "voltaje grafico",
        "group": "5f484414b9f44515",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "34693ecfccdebceb",
        "type": "ui_chart",
        "z": "3b3439c6de64720a",
        "name": "corriente grafico ",
        "group": "5f484414b9f44515",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "2183e553d925da0e",
        "type": "ui_button",
        "z": "3b3439c6de64720a",
        "name": "Cambiar control suministro",
        "group": "9d2fe912f04dd64c",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1140,
        "wires": [
            [
                "6b97aa0e113c24e2",
                "f3c0444480b370e3"
            ]
        ]
    },
    {
        "id": "9f36145d0fca6c4e",
        "type": "mqtt in",
        "z": "3b3439c6de64720a",
        "name": "",
        "topic": "omc/04/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 480,
        "wires": [
            [
                "aca758f1cff85609",
                "abeb2d37e315a66e"
            ]
        ]
    },
    {
        "id": "aca758f1cff85609",
        "type": "split",
        "z": "3b3439c6de64720a",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 480,
        "wires": [
            [
                "451802f3cc31dcf7"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "451802f3cc31dcf7",
        "type": "switch",
        "z": "3b3439c6de64720a",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 480,
        "wires": [
            [
                "9728b9e71731ee51"
            ],
            [
                "36352d329518a150"
            ],
            [
                "48bf4d770c2322b4"
            ],
            [
                "0ece524464d993e0"
            ],
            [
                "d1827180433bc92d"
            ],
            [
                "3a1f38c5305b6cf3"
            ],
            [
                "0c3f8047521e4cf7"
            ],
            [
                "f29b043a3f036c77"
            ],
            [
                "b86c377b53402228"
            ],
            [
                "ea9a866af04c9429"
            ],
            [
                "d9a3d9cc5ccb05fa"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "9728b9e71731ee51",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 100,
        "wires": [
            [
                "d2464f2f256d0f9b",
                "95c094f83ff60e4b",
                "60932049458b0f14"
            ]
        ]
    },
    {
        "id": "36352d329518a150",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 220,
        "wires": [
            [
                "b18cdc1299d39daf",
                "34693ecfccdebceb",
                "68951754fef39ff2"
            ]
        ]
    },
    {
        "id": "48bf4d770c2322b4",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 340,
        "wires": [
            [
                "726c6e9a408fec6b",
                "cc016994e8c60f24",
                "b47802f6c1a1e709"
            ]
        ]
    },
    {
        "id": "0ece524464d993e0",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 440,
        "wires": [
            [
                "8556c988fae7df4b",
                "a02de14ce00b64ca",
                "866a1b0e0253fe7d"
            ]
        ]
    },
    {
        "id": "d1827180433bc92d",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 560,
        "wires": [
            [
                "9108f42fea68b4bb",
                "bf9fb144a2dee102"
            ]
        ]
    },
    {
        "id": "3a1f38c5305b6cf3",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 680,
        "wires": [
            [
                "697ff966c64bc0d5",
                "a835e13e6de1de59",
                "4d50db6203a1a2e4",
                "3c684642c5424143"
            ]
        ]
    },
    {
        "id": "f29b043a3f036c77",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 820,
        "wires": [
            [
                "c64ce580c12781c7"
            ]
        ]
    },
    {
        "id": "b86c377b53402228",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 860,
        "wires": [
            [
                "6b20957f5be2cf52"
            ]
        ]
    },
    {
        "id": "726c6e9a408fec6b",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "939cd0c9a7b9374b",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 300,
        "wires": []
    },
    {
        "id": "cc016994e8c60f24",
        "type": "ui_chart",
        "z": "3b3439c6de64720a",
        "name": "potencia grafico",
        "group": "939cd0c9a7b9374b",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "8556c988fae7df4b",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "939cd0c9a7b9374b",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 420,
        "wires": []
    },
    {
        "id": "9108f42fea68b4bb",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "939cd0c9a7b9374b",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 540,
        "wires": []
    },
    {
        "id": "0c3f8047521e4cf7",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 780,
        "wires": [
            [
                "7bc89a6143bd934f"
            ]
        ]
    },
    {
        "id": "7bc89a6143bd934f",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "9d2fe912f04dd64c",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 780,
        "wires": []
    },
    {
        "id": "bde60d15458b2013",
        "type": "comment",
        "z": "3b3439c6de64720a",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 60,
        "wires": []
    },
    {
        "id": "b288a5659a5b8571",
        "type": "comment",
        "z": "3b3439c6de64720a",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 360,
        "wires": []
    },
    {
        "id": "cadee19b4d345016",
        "type": "comment",
        "z": "3b3439c6de64720a",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 420,
        "wires": []
    },
    {
        "id": "944b8e24b626c222",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1260,
        "wires": [
            [
                "6a094a2a7569eb7b"
            ]
        ]
    },
    {
        "id": "4985eb6f574a94cf",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1380,
        "wires": []
    },
    {
        "id": "6b97aa0e113c24e2",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1260,
        "wires": [
            [
                "944b8e24b626c222"
            ]
        ]
    },
    {
        "id": "a02de14ce00b64ca",
        "type": "ui_gauge",
        "z": "3b3439c6de64720a",
        "name": "factor de potencia",
        "group": "939cd0c9a7b9374b",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 460,
        "wires": []
    },
    {
        "id": "6739697d8b4468be",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1380,
        "wires": [
            [
                "4985eb6f574a94cf"
            ]
        ]
    },
    {
        "id": "931a878b63557605",
        "type": "complete",
        "z": "3b3439c6de64720a",
        "name": "sí dio aceptar",
        "scope": [
            "65024dceb3b1663f",
            "1f42f81dce96b320",
            "e3b083072fb799ee"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1080,
        "wires": [
            [
                "ec79b0c1e27677ed"
            ]
        ]
    },
    {
        "id": "a835e13e6de1de59",
        "type": "ui_led",
        "z": "3b3439c6de64720a",
        "order": 8,
        "group": "7290dfb77542495b",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 660,
        "wires": []
    },
    {
        "id": "f3c0444480b370e3",
        "type": "function",
        "z": "3b3439c6de64720a",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1080,
        "wires": [
            [
                "0d3b4db11765a9c1"
            ]
        ]
    },
    {
        "id": "ec79b0c1e27677ed",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1080,
        "wires": [
            [
                "f3c0444480b370e3"
            ]
        ]
    },
    {
        "id": "0d3b4db11765a9c1",
        "type": "switch",
        "z": "3b3439c6de64720a",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1080,
        "wires": [
            [
                "8733a458e13df543"
            ]
        ]
    },
    {
        "id": "1e0e075f177eca6c",
        "type": "ui_button",
        "z": "3b3439c6de64720a",
        "name": "Reiniciar energía",
        "group": "939cd0c9a7b9374b",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1320,
        "wires": [
            [
                "f104aaafb0b9b4cc",
                "f3c0444480b370e3"
            ]
        ]
    },
    {
        "id": "bf6b5c5eaddb0d96",
        "type": "ui_dropdown",
        "z": "3b3439c6de64720a",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "9d2fe912f04dd64c",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1200,
        "wires": [
            [
                "6b97aa0e113c24e2",
                "f3c0444480b370e3"
            ]
        ]
    },
    {
        "id": "47104c0087a8f407",
        "type": "ui_led",
        "z": "3b3439c6de64720a",
        "order": 4,
        "group": "7290dfb77542495b",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 600,
        "wires": []
    },
    {
        "id": "abeb2d37e315a66e",
        "type": "trigger",
        "z": "3b3439c6de64720a",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 540,
        "wires": [
            [
                "2ce31cc817191229",
                "47104c0087a8f407",
                "007ad6ee7cb18695"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "2ce31cc817191229",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "7290dfb77542495b",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 560,
        "wires": []
    },
    {
        "id": "0f23625ba3651fde",
        "type": "link in",
        "z": "3b3439c6de64720a",
        "name": "",
        "links": [
            "c64ce580c12781c7"
        ],
        "x": 305,
        "y": 1200,
        "wires": [
            [
                "bf6b5c5eaddb0d96"
            ]
        ]
    },
    {
        "id": "c64ce580c12781c7",
        "type": "link out",
        "z": "3b3439c6de64720a",
        "name": "",
        "mode": "link",
        "links": [
            "0f23625ba3651fde"
        ],
        "x": 1495,
        "y": 820,
        "wires": []
    },
    {
        "id": "62b19d9afc7cc77f",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "9d2fe912f04dd64c",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 860,
        "wires": []
    },
    {
        "id": "f104aaafb0b9b4cc",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1320,
        "wires": [
            [
                "b2332177435930c8"
            ]
        ]
    },
    {
        "id": "0ea0262bf190cd36",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "9d2fe912f04dd64c",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 820,
        "wires": []
    },
    {
        "id": "6b20957f5be2cf52",
        "type": "link out",
        "z": "3b3439c6de64720a",
        "name": "",
        "mode": "link",
        "links": [
            "d965a26edce92f0e"
        ],
        "x": 1495,
        "y": 860,
        "wires": []
    },
    {
        "id": "d965a26edce92f0e",
        "type": "link in",
        "z": "3b3439c6de64720a",
        "name": "",
        "links": [
            "6b20957f5be2cf52"
        ],
        "x": 305,
        "y": 1260,
        "wires": [
            [
                "0209aa27467f7bc6"
            ]
        ]
    },
    {
        "id": "0209aa27467f7bc6",
        "type": "ui_dropdown",
        "z": "3b3439c6de64720a",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "9d2fe912f04dd64c",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1260,
        "wires": [
            [
                "6b97aa0e113c24e2",
                "f3c0444480b370e3"
            ]
        ]
    },
    {
        "id": "f46370aa5df6e216",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 520,
        "wires": [
            [
                "aca758f1cff85609"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "9ad3ba30acc77159",
        "type": "ui_button",
        "z": "3b3439c6de64720a",
        "name": "Reinicio dispositivo",
        "group": "9d2fe912f04dd64c",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1380,
        "wires": [
            [
                "f1c24f89cabad663",
                "f3c0444480b370e3"
            ]
        ]
    },
    {
        "id": "f1c24f89cabad663",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1380,
        "wires": [
            [
                "0d8cf791fa4b19a2"
            ]
        ]
    },
    {
        "id": "b2332177435930c8",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1320,
        "wires": [
            [
                "16b6a8c755fd6991"
            ]
        ]
    },
    {
        "id": "0d8cf791fa4b19a2",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1380,
        "wires": [
            [
                "a66356ed7ef795cb"
            ]
        ]
    },
    {
        "id": "16b6a8c755fd6991",
        "type": "switch",
        "z": "3b3439c6de64720a",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1320,
        "wires": [
            [
                "1f42f81dce96b320"
            ],
            [
                "6739697d8b4468be"
            ]
        ]
    },
    {
        "id": "a66356ed7ef795cb",
        "type": "switch",
        "z": "3b3439c6de64720a",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1380,
        "wires": [
            [
                "e3b083072fb799ee"
            ],
            [
                "6739697d8b4468be"
            ]
        ]
    },
    {
        "id": "1f42f81dce96b320",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 4",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1300,
        "wires": [
            [
                "4a8ace74930d0469"
            ]
        ]
    },
    {
        "id": "4a8ace74930d0469",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1300,
        "wires": []
    },
    {
        "id": "e3b083072fb799ee",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 4",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1340,
        "wires": [
            [
                "086ac27ace918f15"
            ]
        ]
    },
    {
        "id": "086ac27ace918f15",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1340,
        "wires": []
    },
    {
        "id": "60932049458b0f14",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 140,
        "wires": []
    },
    {
        "id": "68951754fef39ff2",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 260,
        "wires": []
    },
    {
        "id": "b47802f6c1a1e709",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 380,
        "wires": []
    },
    {
        "id": "bf9fb144a2dee102",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 580,
        "wires": []
    },
    {
        "id": "4d50db6203a1a2e4",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 700,
        "wires": []
    },
    {
        "id": "007ad6ee7cb18695",
        "type": "ui_led",
        "z": "3b3439c6de64720a",
        "order": 2,
        "group": "3ff394bd9036151f",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 640,
        "wires": []
    },
    {
        "id": "57636a18d63041f7",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 680,
        "wires": []
    },
    {
        "id": "1acfeb2565b35dbe",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1260,
        "wires": []
    },
    {
        "id": "65024dceb3b1663f",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 4",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1260,
        "wires": [
            [
                "1acfeb2565b35dbe"
            ]
        ]
    },
    {
        "id": "6a094a2a7569eb7b",
        "type": "switch",
        "z": "3b3439c6de64720a",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1260,
        "wires": [
            [
                "65024dceb3b1663f"
            ],
            [
                "6739697d8b4468be"
            ]
        ]
    },
    {
        "id": "04de23a03f6318e1",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "7290dfb77542495b",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 640,
        "wires": []
    },
    {
        "id": "78cbb496c3ec609e",
        "type": "function",
        "z": "3b3439c6de64720a",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[4] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[4]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[4];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[4];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[4];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 660,
        "wires": [
            [
                "c232eb0e83a20417"
            ],
            [
                "04de23a03f6318e1",
                "98a6f90755f0fe38"
            ],
            [
                "7b6c3ed5ae356f54",
                "5872ec8bed628fe7"
            ]
        ]
    },
    {
        "id": "8588cf60d651e4db",
        "type": "link in",
        "z": "3b3439c6de64720a",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 720,
        "wires": [
            [
                "78cbb496c3ec609e"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "261d248e45f76be5",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "7290dfb77542495b",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 900,
        "wires": []
    },
    {
        "id": "3c684642c5424143",
        "type": "ui_led",
        "z": "3b3439c6de64720a",
        "order": 6,
        "group": "3ff394bd9036151f",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 740,
        "wires": []
    },
    {
        "id": "ea9a866af04c9429",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 900,
        "wires": [
            [
                "261d248e45f76be5"
            ]
        ]
    },
    {
        "id": "c232eb0e83a20417",
        "type": "mqtt in",
        "z": "3b3439c6de64720a",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 580,
        "wires": [
            [
                "2ce31cc817191229",
                "007ad6ee7cb18695",
                "47104c0087a8f407",
                "f46370aa5df6e216"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "54c8c38b387cdb44",
        "type": "function",
        "z": "3b3439c6de64720a",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 940,
        "wires": [
            [
                "da8afb6ea07db4ef"
            ]
        ]
    },
    {
        "id": "da8afb6ea07db4ef",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "7290dfb77542495b",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 940,
        "wires": []
    },
    {
        "id": "d9a3d9cc5ccb05fa",
        "type": "change",
        "z": "3b3439c6de64720a",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 940,
        "wires": [
            [
                "54c8c38b387cdb44"
            ]
        ]
    },
    {
        "id": "1fa44368e01dead7",
        "type": "ui_toast",
        "z": "3b3439c6de64720a",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "52449e13970d58ac",
        "type": "ui_button",
        "z": "3b3439c6de64720a",
        "name": "ayuda",
        "group": "9d2fe912f04dd64c",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1440,
        "wires": [
            [
                "1fa44368e01dead7"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "7b6c3ed5ae356f54",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "7290dfb77542495b",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 720,
        "wires": []
    },
    {
        "id": "829830e6d15a5ba0",
        "type": "comment",
        "z": "3b3439c6de64720a",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 420,
        "wires": []
    },
    {
        "id": "8bad2d2b1a7f3bbc",
        "type": "comment",
        "z": "3b3439c6de64720a",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 20,
        "wires": []
    },
    {
        "id": "9a386be584cb83e6",
        "type": "comment",
        "z": "3b3439c6de64720a",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1020,
        "wires": []
    },
    {
        "id": "98a6f90755f0fe38",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 680,
        "wires": []
    },
    {
        "id": "5872ec8bed628fe7",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 760,
        "wires": []
    },
    {
        "id": "866a1b0e0253fe7d",
        "type": "ui_text",
        "z": "3b3439c6de64720a",
        "group": "3ff394bd9036151f",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 500,
        "wires": []
    },
    {
        "id": "6b11728450812565",
        "type": "inject",
        "z": "3b3439c6de64720a",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 600,
        "wires": [
            [
                "78cbb496c3ec609e"
            ]
        ]
    },
    {
        "id": "fc4c32ec0a024691",
        "type": "mqtt out",
        "z": "e8f647337ed9dae4",
        "name": "",
        "topic": "omc/05/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1100,
        "wires": []
    },
    {
        "id": "cb4933ed86a12961",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "6bccdafe79a51bdb",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 80,
        "wires": []
    },
    {
        "id": "12242df4e4b59e5f",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e57921436d10361e",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 640,
        "wires": []
    },
    {
        "id": "7c9a609c7acced28",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "6bccdafe79a51bdb",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 200,
        "wires": []
    },
    {
        "id": "5d9b951a16ae7b93",
        "type": "ui_chart",
        "z": "e8f647337ed9dae4",
        "name": "voltaje grafico",
        "group": "6bccdafe79a51bdb",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "01337ba32133889e",
        "type": "ui_chart",
        "z": "e8f647337ed9dae4",
        "name": "corriente grafico ",
        "group": "6bccdafe79a51bdb",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "4a7e6d47fd81862d",
        "type": "ui_button",
        "z": "e8f647337ed9dae4",
        "name": "Cambiar control suministro",
        "group": "b401245d40a8da5c",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1160,
        "wires": [
            [
                "91acd0761835943a",
                "bd7c04bce20c4aba"
            ]
        ]
    },
    {
        "id": "15204e92b76ec079",
        "type": "mqtt in",
        "z": "e8f647337ed9dae4",
        "name": "",
        "topic": "omc/05/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 500,
        "wires": [
            [
                "5aac480c1e530ad6",
                "92bb41cc4cf96e43"
            ]
        ]
    },
    {
        "id": "5aac480c1e530ad6",
        "type": "split",
        "z": "e8f647337ed9dae4",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 500,
        "wires": [
            [
                "dcf878c7e85460eb"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "dcf878c7e85460eb",
        "type": "switch",
        "z": "e8f647337ed9dae4",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 500,
        "wires": [
            [
                "8f1c8b42dfa1e5c4"
            ],
            [
                "d95c4717021850f9"
            ],
            [
                "6950c6f753fa616b"
            ],
            [
                "aae0f23c5995b113"
            ],
            [
                "eafba64e22cc4711"
            ],
            [
                "a4d07f3cfc49ec37"
            ],
            [
                "cec36fe12220dadd"
            ],
            [
                "5c80f0958d28ad07"
            ],
            [
                "e80b2d33e05be967"
            ],
            [
                "0dfb080f0920ed1d"
            ],
            [
                "e1d0811251c34c15"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "8f1c8b42dfa1e5c4",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 120,
        "wires": [
            [
                "cb4933ed86a12961",
                "5d9b951a16ae7b93",
                "9e9c109bd5691ca9"
            ]
        ]
    },
    {
        "id": "d95c4717021850f9",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 240,
        "wires": [
            [
                "7c9a609c7acced28",
                "01337ba32133889e",
                "873f4ed0f7b96fb9"
            ]
        ]
    },
    {
        "id": "6950c6f753fa616b",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 360,
        "wires": [
            [
                "5062d78773217e0e",
                "fb47f3bd1759c680",
                "107a455e2b4c1ed1"
            ]
        ]
    },
    {
        "id": "aae0f23c5995b113",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 460,
        "wires": [
            [
                "a07c48cad5e640e2",
                "fadfc37853cd0cec",
                "983258c743a828d7"
            ]
        ]
    },
    {
        "id": "eafba64e22cc4711",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 580,
        "wires": [
            [
                "86ee1cb9c418db45",
                "b6de2364388f3dfb"
            ]
        ]
    },
    {
        "id": "a4d07f3cfc49ec37",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 700,
        "wires": [
            [
                "12242df4e4b59e5f",
                "8f3bf7a6db24ed7b",
                "1404cccf80370527",
                "6c4dad817b42d026"
            ]
        ]
    },
    {
        "id": "5c80f0958d28ad07",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 840,
        "wires": [
            [
                "49804d2524bfb1e8"
            ]
        ]
    },
    {
        "id": "e80b2d33e05be967",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 880,
        "wires": [
            [
                "252d2bdbe0b7417e"
            ]
        ]
    },
    {
        "id": "5062d78773217e0e",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "4529b587131fce93",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 320,
        "wires": []
    },
    {
        "id": "fb47f3bd1759c680",
        "type": "ui_chart",
        "z": "e8f647337ed9dae4",
        "name": "potencia grafico",
        "group": "4529b587131fce93",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "a07c48cad5e640e2",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "4529b587131fce93",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 440,
        "wires": []
    },
    {
        "id": "86ee1cb9c418db45",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "4529b587131fce93",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 560,
        "wires": []
    },
    {
        "id": "cec36fe12220dadd",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 800,
        "wires": [
            [
                "bc2f4f562cee8c80"
            ]
        ]
    },
    {
        "id": "bc2f4f562cee8c80",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "b401245d40a8da5c",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 800,
        "wires": []
    },
    {
        "id": "fa968a7495998966",
        "type": "comment",
        "z": "e8f647337ed9dae4",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 80,
        "wires": []
    },
    {
        "id": "8ec66900da7827e9",
        "type": "comment",
        "z": "e8f647337ed9dae4",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 380,
        "wires": []
    },
    {
        "id": "c2aba38554956972",
        "type": "comment",
        "z": "e8f647337ed9dae4",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 440,
        "wires": []
    },
    {
        "id": "6153ae09989bc35f",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1280,
        "wires": [
            [
                "bbc89439699ef0d4"
            ]
        ]
    },
    {
        "id": "8c6dd86fe228444d",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1400,
        "wires": []
    },
    {
        "id": "91acd0761835943a",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1280,
        "wires": [
            [
                "6153ae09989bc35f"
            ]
        ]
    },
    {
        "id": "fadfc37853cd0cec",
        "type": "ui_gauge",
        "z": "e8f647337ed9dae4",
        "name": "factor de potencia",
        "group": "4529b587131fce93",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 480,
        "wires": []
    },
    {
        "id": "baf25139398e82fc",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1400,
        "wires": [
            [
                "8c6dd86fe228444d"
            ]
        ]
    },
    {
        "id": "42a62ddeb6c6755f",
        "type": "complete",
        "z": "e8f647337ed9dae4",
        "name": "sí dio aceptar",
        "scope": [
            "f853f2dd71412c34",
            "7db31665fca39ec6",
            "5db3a5aac5bb282a"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1100,
        "wires": [
            [
                "2d058bdadd62d2be"
            ]
        ]
    },
    {
        "id": "8f3bf7a6db24ed7b",
        "type": "ui_led",
        "z": "e8f647337ed9dae4",
        "order": 8,
        "group": "e57921436d10361e",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 680,
        "wires": []
    },
    {
        "id": "bd7c04bce20c4aba",
        "type": "function",
        "z": "e8f647337ed9dae4",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1100,
        "wires": [
            [
                "56a78946403e164f"
            ]
        ]
    },
    {
        "id": "2d058bdadd62d2be",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1100,
        "wires": [
            [
                "bd7c04bce20c4aba"
            ]
        ]
    },
    {
        "id": "56a78946403e164f",
        "type": "switch",
        "z": "e8f647337ed9dae4",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1100,
        "wires": [
            [
                "fc4c32ec0a024691"
            ]
        ]
    },
    {
        "id": "20c64c8f38f7e804",
        "type": "ui_button",
        "z": "e8f647337ed9dae4",
        "name": "Reiniciar energía",
        "group": "4529b587131fce93",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1340,
        "wires": [
            [
                "7b86304e3ca814aa",
                "bd7c04bce20c4aba"
            ]
        ]
    },
    {
        "id": "5223e516796948d7",
        "type": "ui_dropdown",
        "z": "e8f647337ed9dae4",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "b401245d40a8da5c",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1220,
        "wires": [
            [
                "91acd0761835943a",
                "bd7c04bce20c4aba"
            ]
        ]
    },
    {
        "id": "4851020d22bffd22",
        "type": "ui_led",
        "z": "e8f647337ed9dae4",
        "order": 4,
        "group": "e57921436d10361e",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 620,
        "wires": []
    },
    {
        "id": "92bb41cc4cf96e43",
        "type": "trigger",
        "z": "e8f647337ed9dae4",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 560,
        "wires": [
            [
                "76f00ff118328b37",
                "4851020d22bffd22",
                "1766c5abc7366cca"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "76f00ff118328b37",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e57921436d10361e",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 580,
        "wires": []
    },
    {
        "id": "15ed4f9c10b5f40c",
        "type": "link in",
        "z": "e8f647337ed9dae4",
        "name": "",
        "links": [
            "49804d2524bfb1e8"
        ],
        "x": 305,
        "y": 1220,
        "wires": [
            [
                "5223e516796948d7"
            ]
        ]
    },
    {
        "id": "49804d2524bfb1e8",
        "type": "link out",
        "z": "e8f647337ed9dae4",
        "name": "",
        "mode": "link",
        "links": [
            "15ed4f9c10b5f40c"
        ],
        "x": 1495,
        "y": 840,
        "wires": []
    },
    {
        "id": "5b1cf458766c877b",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "b401245d40a8da5c",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 880,
        "wires": []
    },
    {
        "id": "7b86304e3ca814aa",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1340,
        "wires": [
            [
                "53ab23c825c08cf1"
            ]
        ]
    },
    {
        "id": "b94e1cbd2deb29b7",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "b401245d40a8da5c",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 840,
        "wires": []
    },
    {
        "id": "252d2bdbe0b7417e",
        "type": "link out",
        "z": "e8f647337ed9dae4",
        "name": "",
        "mode": "link",
        "links": [
            "659e8a2cb9afb601"
        ],
        "x": 1495,
        "y": 880,
        "wires": []
    },
    {
        "id": "659e8a2cb9afb601",
        "type": "link in",
        "z": "e8f647337ed9dae4",
        "name": "",
        "links": [
            "252d2bdbe0b7417e"
        ],
        "x": 305,
        "y": 1280,
        "wires": [
            [
                "dc40a4be84976dd8"
            ]
        ]
    },
    {
        "id": "dc40a4be84976dd8",
        "type": "ui_dropdown",
        "z": "e8f647337ed9dae4",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "b401245d40a8da5c",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1280,
        "wires": [
            [
                "91acd0761835943a",
                "bd7c04bce20c4aba"
            ]
        ]
    },
    {
        "id": "e325689d24ba5e08",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 540,
        "wires": [
            [
                "5aac480c1e530ad6"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "b0185034b75c3fe0",
        "type": "ui_button",
        "z": "e8f647337ed9dae4",
        "name": "Reinicio dispositivo",
        "group": "b401245d40a8da5c",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1400,
        "wires": [
            [
                "fb7dca0aa9c4b8cd",
                "bd7c04bce20c4aba"
            ]
        ]
    },
    {
        "id": "fb7dca0aa9c4b8cd",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1400,
        "wires": [
            [
                "944805ec1e0eba8b"
            ]
        ]
    },
    {
        "id": "53ab23c825c08cf1",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1340,
        "wires": [
            [
                "6aee32470f47e4d3"
            ]
        ]
    },
    {
        "id": "944805ec1e0eba8b",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1400,
        "wires": [
            [
                "e4fb481f53a341ba"
            ]
        ]
    },
    {
        "id": "6aee32470f47e4d3",
        "type": "switch",
        "z": "e8f647337ed9dae4",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1340,
        "wires": [
            [
                "7db31665fca39ec6"
            ],
            [
                "baf25139398e82fc"
            ]
        ]
    },
    {
        "id": "e4fb481f53a341ba",
        "type": "switch",
        "z": "e8f647337ed9dae4",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1400,
        "wires": [
            [
                "5db3a5aac5bb282a"
            ],
            [
                "baf25139398e82fc"
            ]
        ]
    },
    {
        "id": "7db31665fca39ec6",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1320,
        "wires": [
            [
                "4e0c164702a8bbed"
            ]
        ]
    },
    {
        "id": "4e0c164702a8bbed",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1320,
        "wires": []
    },
    {
        "id": "5db3a5aac5bb282a",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1360,
        "wires": [
            [
                "8e96df8c1508db72"
            ]
        ]
    },
    {
        "id": "8e96df8c1508db72",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1360,
        "wires": []
    },
    {
        "id": "9e9c109bd5691ca9",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 160,
        "wires": []
    },
    {
        "id": "873f4ed0f7b96fb9",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 280,
        "wires": []
    },
    {
        "id": "107a455e2b4c1ed1",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 400,
        "wires": []
    },
    {
        "id": "b6de2364388f3dfb",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 600,
        "wires": []
    },
    {
        "id": "1404cccf80370527",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 720,
        "wires": []
    },
    {
        "id": "1766c5abc7366cca",
        "type": "ui_led",
        "z": "e8f647337ed9dae4",
        "order": 2,
        "group": "e00e4fc84f4e1bac",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 660,
        "wires": []
    },
    {
        "id": "f8cd3c5b9ecd39db",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 700,
        "wires": []
    },
    {
        "id": "ed546dd029ac82e4",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1280,
        "wires": []
    },
    {
        "id": "f853f2dd71412c34",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 5",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1280,
        "wires": [
            [
                "ed546dd029ac82e4"
            ]
        ]
    },
    {
        "id": "bbc89439699ef0d4",
        "type": "switch",
        "z": "e8f647337ed9dae4",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1280,
        "wires": [
            [
                "f853f2dd71412c34"
            ],
            [
                "baf25139398e82fc"
            ]
        ]
    },
    {
        "id": "8b4c91487dcf5bca",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e57921436d10361e",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 660,
        "wires": []
    },
    {
        "id": "3d16da6744fb93da",
        "type": "function",
        "z": "e8f647337ed9dae4",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[5] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[5]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[5];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[5];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[5];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 680,
        "wires": [
            [
                "12a93a6b3b6471d0"
            ],
            [
                "8b4c91487dcf5bca",
                "20d2bee3d3c254a2"
            ],
            [
                "847a8b56d74ccf07",
                "badbb652020df82d"
            ]
        ]
    },
    {
        "id": "4d00d247bea22886",
        "type": "link in",
        "z": "e8f647337ed9dae4",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 740,
        "wires": [
            [
                "3d16da6744fb93da"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "c44aa67f67850a60",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e57921436d10361e",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 920,
        "wires": []
    },
    {
        "id": "6c4dad817b42d026",
        "type": "ui_led",
        "z": "e8f647337ed9dae4",
        "order": 6,
        "group": "e00e4fc84f4e1bac",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 760,
        "wires": []
    },
    {
        "id": "0dfb080f0920ed1d",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 920,
        "wires": [
            [
                "c44aa67f67850a60"
            ]
        ]
    },
    {
        "id": "12a93a6b3b6471d0",
        "type": "mqtt in",
        "z": "e8f647337ed9dae4",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 600,
        "wires": [
            [
                "76f00ff118328b37",
                "1766c5abc7366cca",
                "4851020d22bffd22",
                "e325689d24ba5e08"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "71bf4fb72f24c697",
        "type": "function",
        "z": "e8f647337ed9dae4",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 960,
        "wires": [
            [
                "3e911c686b7dc0ca"
            ]
        ]
    },
    {
        "id": "3e911c686b7dc0ca",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e57921436d10361e",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 960,
        "wires": []
    },
    {
        "id": "e1d0811251c34c15",
        "type": "change",
        "z": "e8f647337ed9dae4",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 960,
        "wires": [
            [
                "71bf4fb72f24c697"
            ]
        ]
    },
    {
        "id": "dfcc1f1afeabee66",
        "type": "ui_toast",
        "z": "e8f647337ed9dae4",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1460,
        "wires": [
            []
        ]
    },
    {
        "id": "b9ddf0465a04f803",
        "type": "ui_button",
        "z": "e8f647337ed9dae4",
        "name": "ayuda",
        "group": "b401245d40a8da5c",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1460,
        "wires": [
            [
                "dfcc1f1afeabee66"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "847a8b56d74ccf07",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e57921436d10361e",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 740,
        "wires": []
    },
    {
        "id": "eef06e18cd238bc3",
        "type": "comment",
        "z": "e8f647337ed9dae4",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 440,
        "wires": []
    },
    {
        "id": "e5a5b596d11ecd48",
        "type": "comment",
        "z": "e8f647337ed9dae4",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 40,
        "wires": []
    },
    {
        "id": "ed4929d0ece46cef",
        "type": "comment",
        "z": "e8f647337ed9dae4",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1040,
        "wires": []
    },
    {
        "id": "20d2bee3d3c254a2",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 700,
        "wires": []
    },
    {
        "id": "badbb652020df82d",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 780,
        "wires": []
    },
    {
        "id": "983258c743a828d7",
        "type": "ui_text",
        "z": "e8f647337ed9dae4",
        "group": "e00e4fc84f4e1bac",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 520,
        "wires": []
    },
    {
        "id": "5c1580aba11a3023",
        "type": "inject",
        "z": "e8f647337ed9dae4",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 620,
        "wires": [
            [
                "3d16da6744fb93da"
            ]
        ]
    },
    {
        "id": "4f205e6711da63c3",
        "type": "mqtt out",
        "z": "ae85575a21155d1c",
        "name": "",
        "topic": "omc/06/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1120,
        "wires": []
    },
    {
        "id": "05b6b34c5c6d34c0",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "64158f41d5f6a626",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 100,
        "wires": []
    },
    {
        "id": "db72220b2b8335f1",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "f2becaebbb6e7c30",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 660,
        "wires": []
    },
    {
        "id": "c77e8b0563e88dfe",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "64158f41d5f6a626",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 220,
        "wires": []
    },
    {
        "id": "a9966b221ad3815e",
        "type": "ui_chart",
        "z": "ae85575a21155d1c",
        "name": "voltaje grafico",
        "group": "64158f41d5f6a626",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "4972518a477cca5e",
        "type": "ui_chart",
        "z": "ae85575a21155d1c",
        "name": "corriente grafico ",
        "group": "64158f41d5f6a626",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 260,
        "wires": [
            []
        ]
    },
    {
        "id": "2db7e50ebcfab8ab",
        "type": "ui_button",
        "z": "ae85575a21155d1c",
        "name": "Cambiar control suministro",
        "group": "e76ceef663ea0328",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1180,
        "wires": [
            [
                "153d97257ecbef4e",
                "9096d2c2a75d038e"
            ]
        ]
    },
    {
        "id": "c14c40a57a66a834",
        "type": "mqtt in",
        "z": "ae85575a21155d1c",
        "name": "",
        "topic": "omc/06/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 520,
        "wires": [
            [
                "c8d9f0e59dfe95fb",
                "af04bbb03821b791"
            ]
        ]
    },
    {
        "id": "c8d9f0e59dfe95fb",
        "type": "split",
        "z": "ae85575a21155d1c",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 520,
        "wires": [
            [
                "20872c945471a10c"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "20872c945471a10c",
        "type": "switch",
        "z": "ae85575a21155d1c",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 520,
        "wires": [
            [
                "ae0bdfaef703f7c0"
            ],
            [
                "f5b25fce8be108af"
            ],
            [
                "d96c3bb05a967f49"
            ],
            [
                "27f65691c53220ef"
            ],
            [
                "bf14f9da219c5347"
            ],
            [
                "6b113544184fe827"
            ],
            [
                "15682756ada7b873"
            ],
            [
                "d05a7f5bc631951a"
            ],
            [
                "2d5c15c6e78c4e5f"
            ],
            [
                "baca62929cb7bf3c"
            ],
            [
                "4db511b52eecfd36"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "ae0bdfaef703f7c0",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 140,
        "wires": [
            [
                "05b6b34c5c6d34c0",
                "a9966b221ad3815e",
                "7174aace12e04e59"
            ]
        ]
    },
    {
        "id": "f5b25fce8be108af",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 260,
        "wires": [
            [
                "c77e8b0563e88dfe",
                "4972518a477cca5e",
                "49a365ca2f5dd218"
            ]
        ]
    },
    {
        "id": "d96c3bb05a967f49",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 380,
        "wires": [
            [
                "cb752afe3c8e6299",
                "35c0e6348f29c4ef",
                "a3407954313cfca5"
            ]
        ]
    },
    {
        "id": "27f65691c53220ef",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 480,
        "wires": [
            [
                "1a36fca4aa02eb8b",
                "c347fa82f192b30d",
                "6613ecb0937c7ef0"
            ]
        ]
    },
    {
        "id": "bf14f9da219c5347",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 600,
        "wires": [
            [
                "2e55a401a3025eb0",
                "f91419e92814016a"
            ]
        ]
    },
    {
        "id": "6b113544184fe827",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 720,
        "wires": [
            [
                "db72220b2b8335f1",
                "e424d714fdacee56",
                "236115755a17c13f",
                "17f4d871defc9e5f"
            ]
        ]
    },
    {
        "id": "d05a7f5bc631951a",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 860,
        "wires": [
            [
                "949f027258af0405"
            ]
        ]
    },
    {
        "id": "2d5c15c6e78c4e5f",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 900,
        "wires": [
            [
                "f5fa2e538851d844"
            ]
        ]
    },
    {
        "id": "cb752afe3c8e6299",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "6f691cce67042526",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 340,
        "wires": []
    },
    {
        "id": "35c0e6348f29c4ef",
        "type": "ui_chart",
        "z": "ae85575a21155d1c",
        "name": "potencia grafico",
        "group": "6f691cce67042526",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "1a36fca4aa02eb8b",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "6f691cce67042526",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 460,
        "wires": []
    },
    {
        "id": "2e55a401a3025eb0",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "6f691cce67042526",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 580,
        "wires": []
    },
    {
        "id": "15682756ada7b873",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 820,
        "wires": [
            [
                "f7bb3f232f166ced"
            ]
        ]
    },
    {
        "id": "f7bb3f232f166ced",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "e76ceef663ea0328",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 820,
        "wires": []
    },
    {
        "id": "c77649ceb4afd669",
        "type": "comment",
        "z": "ae85575a21155d1c",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 100,
        "wires": []
    },
    {
        "id": "42510a0952be7b20",
        "type": "comment",
        "z": "ae85575a21155d1c",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 400,
        "wires": []
    },
    {
        "id": "088de31111da6f89",
        "type": "comment",
        "z": "ae85575a21155d1c",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 460,
        "wires": []
    },
    {
        "id": "35ca2cf6df1fd004",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1300,
        "wires": [
            [
                "bcb99362b4598782"
            ]
        ]
    },
    {
        "id": "5f2b40a0cbc901c4",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1420,
        "wires": []
    },
    {
        "id": "153d97257ecbef4e",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1300,
        "wires": [
            [
                "35ca2cf6df1fd004"
            ]
        ]
    },
    {
        "id": "c347fa82f192b30d",
        "type": "ui_gauge",
        "z": "ae85575a21155d1c",
        "name": "factor de potencia",
        "group": "6f691cce67042526",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 500,
        "wires": []
    },
    {
        "id": "b83ec924ecfd9550",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1420,
        "wires": [
            [
                "5f2b40a0cbc901c4"
            ]
        ]
    },
    {
        "id": "033cdb8d799a4bd6",
        "type": "complete",
        "z": "ae85575a21155d1c",
        "name": "sí dio aceptar",
        "scope": [
            "f3d90fabcbcb8a58",
            "597017543b132fb6",
            "195efa57d057d645"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1120,
        "wires": [
            [
                "6d73931ee8369454"
            ]
        ]
    },
    {
        "id": "e424d714fdacee56",
        "type": "ui_led",
        "z": "ae85575a21155d1c",
        "order": 8,
        "group": "f2becaebbb6e7c30",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 700,
        "wires": []
    },
    {
        "id": "9096d2c2a75d038e",
        "type": "function",
        "z": "ae85575a21155d1c",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1120,
        "wires": [
            [
                "2ac7a0bfd3ee6aa9"
            ]
        ]
    },
    {
        "id": "6d73931ee8369454",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1120,
        "wires": [
            [
                "9096d2c2a75d038e"
            ]
        ]
    },
    {
        "id": "2ac7a0bfd3ee6aa9",
        "type": "switch",
        "z": "ae85575a21155d1c",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1120,
        "wires": [
            [
                "4f205e6711da63c3"
            ]
        ]
    },
    {
        "id": "a34dbb5345dc18b5",
        "type": "ui_button",
        "z": "ae85575a21155d1c",
        "name": "Reiniciar energía",
        "group": "6f691cce67042526",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1360,
        "wires": [
            [
                "cf9edb6facfa8dbb",
                "9096d2c2a75d038e"
            ]
        ]
    },
    {
        "id": "d7200abfc6ded56f",
        "type": "ui_dropdown",
        "z": "ae85575a21155d1c",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "e76ceef663ea0328",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1240,
        "wires": [
            [
                "153d97257ecbef4e",
                "9096d2c2a75d038e"
            ]
        ]
    },
    {
        "id": "11320bf6c49fcd19",
        "type": "ui_led",
        "z": "ae85575a21155d1c",
        "order": 4,
        "group": "f2becaebbb6e7c30",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 640,
        "wires": []
    },
    {
        "id": "af04bbb03821b791",
        "type": "trigger",
        "z": "ae85575a21155d1c",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 580,
        "wires": [
            [
                "959d36eeedfe6ee7",
                "11320bf6c49fcd19",
                "a087941eaab7ac93"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "959d36eeedfe6ee7",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "f2becaebbb6e7c30",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 600,
        "wires": []
    },
    {
        "id": "6d5a2d8d5e2279e2",
        "type": "link in",
        "z": "ae85575a21155d1c",
        "name": "",
        "links": [
            "949f027258af0405"
        ],
        "x": 305,
        "y": 1240,
        "wires": [
            [
                "d7200abfc6ded56f"
            ]
        ]
    },
    {
        "id": "949f027258af0405",
        "type": "link out",
        "z": "ae85575a21155d1c",
        "name": "",
        "mode": "link",
        "links": [
            "6d5a2d8d5e2279e2"
        ],
        "x": 1495,
        "y": 860,
        "wires": []
    },
    {
        "id": "7d8954a22a4074fc",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "e76ceef663ea0328",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 900,
        "wires": []
    },
    {
        "id": "cf9edb6facfa8dbb",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1360,
        "wires": [
            [
                "35be11494e067878"
            ]
        ]
    },
    {
        "id": "c7ae1afb84352307",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "e76ceef663ea0328",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 860,
        "wires": []
    },
    {
        "id": "f5fa2e538851d844",
        "type": "link out",
        "z": "ae85575a21155d1c",
        "name": "",
        "mode": "link",
        "links": [
            "84f77986b3f91c11"
        ],
        "x": 1495,
        "y": 900,
        "wires": []
    },
    {
        "id": "84f77986b3f91c11",
        "type": "link in",
        "z": "ae85575a21155d1c",
        "name": "",
        "links": [
            "f5fa2e538851d844"
        ],
        "x": 305,
        "y": 1300,
        "wires": [
            [
                "68cbbd43e9727793"
            ]
        ]
    },
    {
        "id": "68cbbd43e9727793",
        "type": "ui_dropdown",
        "z": "ae85575a21155d1c",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "e76ceef663ea0328",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1300,
        "wires": [
            [
                "153d97257ecbef4e",
                "9096d2c2a75d038e"
            ]
        ]
    },
    {
        "id": "6532d282fc28bb61",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 560,
        "wires": [
            [
                "c8d9f0e59dfe95fb"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "d21d1437d3ad11fb",
        "type": "ui_button",
        "z": "ae85575a21155d1c",
        "name": "Reinicio dispositivo",
        "group": "e76ceef663ea0328",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1420,
        "wires": [
            [
                "e5656b61c86f764f",
                "9096d2c2a75d038e"
            ]
        ]
    },
    {
        "id": "e5656b61c86f764f",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1420,
        "wires": [
            [
                "3248b6abbbd0093b"
            ]
        ]
    },
    {
        "id": "35be11494e067878",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1360,
        "wires": [
            [
                "fb20c2cbf41b1eec"
            ]
        ]
    },
    {
        "id": "3248b6abbbd0093b",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1420,
        "wires": [
            [
                "685bdcd5c78c0949"
            ]
        ]
    },
    {
        "id": "fb20c2cbf41b1eec",
        "type": "switch",
        "z": "ae85575a21155d1c",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1360,
        "wires": [
            [
                "597017543b132fb6"
            ],
            [
                "b83ec924ecfd9550"
            ]
        ]
    },
    {
        "id": "685bdcd5c78c0949",
        "type": "switch",
        "z": "ae85575a21155d1c",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1420,
        "wires": [
            [
                "195efa57d057d645"
            ],
            [
                "b83ec924ecfd9550"
            ]
        ]
    },
    {
        "id": "597017543b132fb6",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 6",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1340,
        "wires": [
            [
                "b786b40a0922784b"
            ]
        ]
    },
    {
        "id": "b786b40a0922784b",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1340,
        "wires": []
    },
    {
        "id": "195efa57d057d645",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 6",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1380,
        "wires": [
            [
                "ef501534fc6b6283"
            ]
        ]
    },
    {
        "id": "ef501534fc6b6283",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1380,
        "wires": []
    },
    {
        "id": "7174aace12e04e59",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 180,
        "wires": []
    },
    {
        "id": "49a365ca2f5dd218",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 300,
        "wires": []
    },
    {
        "id": "a3407954313cfca5",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 420,
        "wires": []
    },
    {
        "id": "f91419e92814016a",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 620,
        "wires": []
    },
    {
        "id": "236115755a17c13f",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 740,
        "wires": []
    },
    {
        "id": "a087941eaab7ac93",
        "type": "ui_led",
        "z": "ae85575a21155d1c",
        "order": 2,
        "group": "753065e3a360957e",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 680,
        "wires": []
    },
    {
        "id": "22871c0ead087a60",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 720,
        "wires": []
    },
    {
        "id": "27948e8021844efd",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1300,
        "wires": []
    },
    {
        "id": "f3d90fabcbcb8a58",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 6",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1300,
        "wires": [
            [
                "27948e8021844efd"
            ]
        ]
    },
    {
        "id": "bcb99362b4598782",
        "type": "switch",
        "z": "ae85575a21155d1c",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1300,
        "wires": [
            [
                "f3d90fabcbcb8a58"
            ],
            [
                "b83ec924ecfd9550"
            ]
        ]
    },
    {
        "id": "4fc1cc8aae0d0ae6",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "f2becaebbb6e7c30",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 680,
        "wires": []
    },
    {
        "id": "3209d5fa074ab7dc",
        "type": "function",
        "z": "ae85575a21155d1c",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[6] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[6]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[6];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[6];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[6];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 700,
        "wires": [
            [
                "c4afa471018c1bfd"
            ],
            [
                "4fc1cc8aae0d0ae6",
                "306ae014c99ec173"
            ],
            [
                "d9c5b83e7eb6eacf",
                "8fe2fb93957af6d7"
            ]
        ]
    },
    {
        "id": "5e918491992569c3",
        "type": "link in",
        "z": "ae85575a21155d1c",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 760,
        "wires": [
            [
                "3209d5fa074ab7dc"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "3cc9450cdfa2c5ec",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "f2becaebbb6e7c30",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 940,
        "wires": []
    },
    {
        "id": "17f4d871defc9e5f",
        "type": "ui_led",
        "z": "ae85575a21155d1c",
        "order": 6,
        "group": "753065e3a360957e",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 780,
        "wires": []
    },
    {
        "id": "baca62929cb7bf3c",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 940,
        "wires": [
            [
                "3cc9450cdfa2c5ec"
            ]
        ]
    },
    {
        "id": "c4afa471018c1bfd",
        "type": "mqtt in",
        "z": "ae85575a21155d1c",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 620,
        "wires": [
            [
                "959d36eeedfe6ee7",
                "a087941eaab7ac93",
                "11320bf6c49fcd19",
                "6532d282fc28bb61"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "fe79c8173f4b474d",
        "type": "function",
        "z": "ae85575a21155d1c",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 980,
        "wires": [
            [
                "1635c041a7f852db"
            ]
        ]
    },
    {
        "id": "1635c041a7f852db",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "f2becaebbb6e7c30",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 980,
        "wires": []
    },
    {
        "id": "4db511b52eecfd36",
        "type": "change",
        "z": "ae85575a21155d1c",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 980,
        "wires": [
            [
                "fe79c8173f4b474d"
            ]
        ]
    },
    {
        "id": "e7163bd8aee5b910",
        "type": "ui_toast",
        "z": "ae85575a21155d1c",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1480,
        "wires": [
            []
        ]
    },
    {
        "id": "1a87ef28170a21db",
        "type": "ui_button",
        "z": "ae85575a21155d1c",
        "name": "ayuda",
        "group": "e76ceef663ea0328",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1480,
        "wires": [
            [
                "e7163bd8aee5b910"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "d9c5b83e7eb6eacf",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "f2becaebbb6e7c30",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 760,
        "wires": []
    },
    {
        "id": "32ae8e52a3123c23",
        "type": "comment",
        "z": "ae85575a21155d1c",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 460,
        "wires": []
    },
    {
        "id": "accbb94e86a8e99d",
        "type": "comment",
        "z": "ae85575a21155d1c",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 60,
        "wires": []
    },
    {
        "id": "a3acf9d767d483c8",
        "type": "comment",
        "z": "ae85575a21155d1c",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1060,
        "wires": []
    },
    {
        "id": "306ae014c99ec173",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 720,
        "wires": []
    },
    {
        "id": "8fe2fb93957af6d7",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 800,
        "wires": []
    },
    {
        "id": "6613ecb0937c7ef0",
        "type": "ui_text",
        "z": "ae85575a21155d1c",
        "group": "753065e3a360957e",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 540,
        "wires": []
    },
    {
        "id": "22362bed23616a08",
        "type": "inject",
        "z": "ae85575a21155d1c",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 640,
        "wires": [
            [
                "3209d5fa074ab7dc"
            ]
        ]
    },
    {
        "id": "13d5af693859f965",
        "type": "mqtt out",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "topic": "omc/07/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1100,
        "wires": []
    },
    {
        "id": "b5cfc0c12cee27d3",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "49021c53a4a9ee9c",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 80,
        "wires": []
    },
    {
        "id": "3321264bcd02a1db",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "576dae3b804b0999",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 640,
        "wires": []
    },
    {
        "id": "924d99329606c981",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "49021c53a4a9ee9c",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 200,
        "wires": []
    },
    {
        "id": "8f0a46ca4921f85c",
        "type": "ui_chart",
        "z": "2fda3a02bb66fe0f",
        "name": "voltaje grafico",
        "group": "49021c53a4a9ee9c",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "0945986d401ca741",
        "type": "ui_chart",
        "z": "2fda3a02bb66fe0f",
        "name": "corriente grafico ",
        "group": "49021c53a4a9ee9c",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 240,
        "wires": [
            []
        ]
    },
    {
        "id": "34530703b46859a9",
        "type": "ui_button",
        "z": "2fda3a02bb66fe0f",
        "name": "Cambiar control suministro",
        "group": "0744241a857645e3",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1160,
        "wires": [
            [
                "00504e0bc5581338",
                "aacd4e24a3475063"
            ]
        ]
    },
    {
        "id": "db70b95c115cbceb",
        "type": "mqtt in",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "topic": "omc/07/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 500,
        "wires": [
            [
                "0b5acd51371db4cf",
                "c1402340df492f65"
            ]
        ]
    },
    {
        "id": "0b5acd51371db4cf",
        "type": "split",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 500,
        "wires": [
            [
                "efc33cf2691e30e3"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "efc33cf2691e30e3",
        "type": "switch",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 500,
        "wires": [
            [
                "3f6348de4f34541e"
            ],
            [
                "52cd0679ff97dbee"
            ],
            [
                "efa3cb92ce65c851"
            ],
            [
                "1fb8efea3c677957"
            ],
            [
                "9bdd886513518558"
            ],
            [
                "82063f4e4a411a2b"
            ],
            [
                "443b6cc6a27dbabe"
            ],
            [
                "d4beacdff4143f4c"
            ],
            [
                "970e82ae94d5c39c"
            ],
            [
                "b57a4212c8cca472"
            ],
            [
                "eb01695bdefb7189"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "3f6348de4f34541e",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 120,
        "wires": [
            [
                "b5cfc0c12cee27d3",
                "8f0a46ca4921f85c",
                "5b7b219b3e0c64ef"
            ]
        ]
    },
    {
        "id": "52cd0679ff97dbee",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 240,
        "wires": [
            [
                "924d99329606c981",
                "0945986d401ca741",
                "8fe2a5e79071970d"
            ]
        ]
    },
    {
        "id": "efa3cb92ce65c851",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 360,
        "wires": [
            [
                "7e831742d6dbf132",
                "7490962cae298625",
                "97571118d4a78803"
            ]
        ]
    },
    {
        "id": "1fb8efea3c677957",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 460,
        "wires": [
            [
                "cd1f0b0c0de0ef57",
                "007ea271ba02c3e8",
                "cc1da217c2beea35"
            ]
        ]
    },
    {
        "id": "9bdd886513518558",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 580,
        "wires": [
            [
                "c2d88063cfca4edb",
                "b9337483496ab959"
            ]
        ]
    },
    {
        "id": "82063f4e4a411a2b",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 700,
        "wires": [
            [
                "3321264bcd02a1db",
                "cbf9ae110a675795",
                "328a296a0314f56e",
                "d1f7ab27a8639860"
            ]
        ]
    },
    {
        "id": "d4beacdff4143f4c",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 840,
        "wires": [
            [
                "bb372a7f583cf84e"
            ]
        ]
    },
    {
        "id": "970e82ae94d5c39c",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 880,
        "wires": [
            [
                "24e4883faf3f16bf"
            ]
        ]
    },
    {
        "id": "7e831742d6dbf132",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "1fa79125485aee1b",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 320,
        "wires": []
    },
    {
        "id": "7490962cae298625",
        "type": "ui_chart",
        "z": "2fda3a02bb66fe0f",
        "name": "potencia grafico",
        "group": "1fa79125485aee1b",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "cd1f0b0c0de0ef57",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "1fa79125485aee1b",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 440,
        "wires": []
    },
    {
        "id": "c2d88063cfca4edb",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "1fa79125485aee1b",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 560,
        "wires": []
    },
    {
        "id": "443b6cc6a27dbabe",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 800,
        "wires": [
            [
                "8cdbffd3f07b3734"
            ]
        ]
    },
    {
        "id": "8cdbffd3f07b3734",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "0744241a857645e3",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 800,
        "wires": []
    },
    {
        "id": "8c49e6be601d97e5",
        "type": "comment",
        "z": "2fda3a02bb66fe0f",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 80,
        "wires": []
    },
    {
        "id": "37c329520a0a1ecb",
        "type": "comment",
        "z": "2fda3a02bb66fe0f",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 380,
        "wires": []
    },
    {
        "id": "bfc38c56673c9d19",
        "type": "comment",
        "z": "2fda3a02bb66fe0f",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 440,
        "wires": []
    },
    {
        "id": "d323da4f1c55c10c",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1280,
        "wires": [
            [
                "b63beeb481fb3b0a"
            ]
        ]
    },
    {
        "id": "57cb2bfaba9e3ec2",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1400,
        "wires": []
    },
    {
        "id": "00504e0bc5581338",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1280,
        "wires": [
            [
                "d323da4f1c55c10c"
            ]
        ]
    },
    {
        "id": "007ea271ba02c3e8",
        "type": "ui_gauge",
        "z": "2fda3a02bb66fe0f",
        "name": "factor de potencia",
        "group": "1fa79125485aee1b",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 480,
        "wires": []
    },
    {
        "id": "9172d69a7f641088",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1400,
        "wires": [
            [
                "57cb2bfaba9e3ec2"
            ]
        ]
    },
    {
        "id": "839af270df226988",
        "type": "complete",
        "z": "2fda3a02bb66fe0f",
        "name": "sí dio aceptar",
        "scope": [
            "6bc8deebb6a746a3",
            "3d27db0ce6181dcd",
            "fea95b42a443a4a4"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1100,
        "wires": [
            [
                "6135c9d9accf0438"
            ]
        ]
    },
    {
        "id": "cbf9ae110a675795",
        "type": "ui_led",
        "z": "2fda3a02bb66fe0f",
        "order": 8,
        "group": "576dae3b804b0999",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 680,
        "wires": []
    },
    {
        "id": "aacd4e24a3475063",
        "type": "function",
        "z": "2fda3a02bb66fe0f",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1100,
        "wires": [
            [
                "9adffa66017c9395"
            ]
        ]
    },
    {
        "id": "6135c9d9accf0438",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1100,
        "wires": [
            [
                "aacd4e24a3475063"
            ]
        ]
    },
    {
        "id": "9adffa66017c9395",
        "type": "switch",
        "z": "2fda3a02bb66fe0f",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1100,
        "wires": [
            [
                "13d5af693859f965"
            ]
        ]
    },
    {
        "id": "869434e47356d3d7",
        "type": "ui_button",
        "z": "2fda3a02bb66fe0f",
        "name": "Reiniciar energía",
        "group": "1fa79125485aee1b",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1340,
        "wires": [
            [
                "75408f5557348d19",
                "aacd4e24a3475063"
            ]
        ]
    },
    {
        "id": "bf26e6d9998ad00f",
        "type": "ui_dropdown",
        "z": "2fda3a02bb66fe0f",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "0744241a857645e3",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1220,
        "wires": [
            [
                "00504e0bc5581338",
                "aacd4e24a3475063"
            ]
        ]
    },
    {
        "id": "9f4c1a9c854ec277",
        "type": "ui_led",
        "z": "2fda3a02bb66fe0f",
        "order": 4,
        "group": "576dae3b804b0999",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 620,
        "wires": []
    },
    {
        "id": "c1402340df492f65",
        "type": "trigger",
        "z": "2fda3a02bb66fe0f",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 560,
        "wires": [
            [
                "1a014fb1277f035a",
                "9f4c1a9c854ec277",
                "42b32d782b455087"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "1a014fb1277f035a",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "576dae3b804b0999",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 580,
        "wires": []
    },
    {
        "id": "08b052104c725436",
        "type": "link in",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "links": [
            "bb372a7f583cf84e"
        ],
        "x": 305,
        "y": 1220,
        "wires": [
            [
                "bf26e6d9998ad00f"
            ]
        ]
    },
    {
        "id": "bb372a7f583cf84e",
        "type": "link out",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "mode": "link",
        "links": [
            "08b052104c725436"
        ],
        "x": 1495,
        "y": 840,
        "wires": []
    },
    {
        "id": "7e0287ded6b1aa80",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "0744241a857645e3",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 880,
        "wires": []
    },
    {
        "id": "75408f5557348d19",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1340,
        "wires": [
            [
                "26cd7079f73a2095"
            ]
        ]
    },
    {
        "id": "939a6b8d8c862501",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "0744241a857645e3",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 840,
        "wires": []
    },
    {
        "id": "24e4883faf3f16bf",
        "type": "link out",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "mode": "link",
        "links": [
            "5941825501befc43"
        ],
        "x": 1495,
        "y": 880,
        "wires": []
    },
    {
        "id": "5941825501befc43",
        "type": "link in",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "links": [
            "24e4883faf3f16bf"
        ],
        "x": 305,
        "y": 1280,
        "wires": [
            [
                "e8bce83d05034b1c"
            ]
        ]
    },
    {
        "id": "e8bce83d05034b1c",
        "type": "ui_dropdown",
        "z": "2fda3a02bb66fe0f",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "0744241a857645e3",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1280,
        "wires": [
            [
                "00504e0bc5581338",
                "aacd4e24a3475063"
            ]
        ]
    },
    {
        "id": "45cd4e1d26c44823",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 540,
        "wires": [
            [
                "0b5acd51371db4cf"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "a0b8b20b8f7a8367",
        "type": "ui_button",
        "z": "2fda3a02bb66fe0f",
        "name": "Reinicio dispositivo",
        "group": "0744241a857645e3",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1400,
        "wires": [
            [
                "ac42f3f6637798fb",
                "aacd4e24a3475063"
            ]
        ]
    },
    {
        "id": "ac42f3f6637798fb",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1400,
        "wires": [
            [
                "ee363a97199513e1"
            ]
        ]
    },
    {
        "id": "26cd7079f73a2095",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1340,
        "wires": [
            [
                "0eefc4f760f84f17"
            ]
        ]
    },
    {
        "id": "ee363a97199513e1",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1400,
        "wires": [
            [
                "193d053ce9368b6d"
            ]
        ]
    },
    {
        "id": "0eefc4f760f84f17",
        "type": "switch",
        "z": "2fda3a02bb66fe0f",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1340,
        "wires": [
            [
                "3d27db0ce6181dcd"
            ],
            [
                "9172d69a7f641088"
            ]
        ]
    },
    {
        "id": "193d053ce9368b6d",
        "type": "switch",
        "z": "2fda3a02bb66fe0f",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1400,
        "wires": [
            [
                "fea95b42a443a4a4"
            ],
            [
                "9172d69a7f641088"
            ]
        ]
    },
    {
        "id": "3d27db0ce6181dcd",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 7",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1320,
        "wires": [
            [
                "2dd5bebd80a85107"
            ]
        ]
    },
    {
        "id": "2dd5bebd80a85107",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1320,
        "wires": []
    },
    {
        "id": "fea95b42a443a4a4",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 7",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1360,
        "wires": [
            [
                "2265832f03876f13"
            ]
        ]
    },
    {
        "id": "2265832f03876f13",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1360,
        "wires": []
    },
    {
        "id": "5b7b219b3e0c64ef",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 160,
        "wires": []
    },
    {
        "id": "8fe2a5e79071970d",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 280,
        "wires": []
    },
    {
        "id": "97571118d4a78803",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 400,
        "wires": []
    },
    {
        "id": "b9337483496ab959",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 600,
        "wires": []
    },
    {
        "id": "328a296a0314f56e",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 720,
        "wires": []
    },
    {
        "id": "42b32d782b455087",
        "type": "ui_led",
        "z": "2fda3a02bb66fe0f",
        "order": 2,
        "group": "b70cc8a1b4cc3153",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 660,
        "wires": []
    },
    {
        "id": "a55259ebdfee6290",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 700,
        "wires": []
    },
    {
        "id": "300db94231864d65",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1280,
        "wires": []
    },
    {
        "id": "6bc8deebb6a746a3",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 7",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1280,
        "wires": [
            [
                "300db94231864d65"
            ]
        ]
    },
    {
        "id": "b63beeb481fb3b0a",
        "type": "switch",
        "z": "2fda3a02bb66fe0f",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1280,
        "wires": [
            [
                "6bc8deebb6a746a3"
            ],
            [
                "9172d69a7f641088"
            ]
        ]
    },
    {
        "id": "badde3e442e9dce9",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "576dae3b804b0999",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 660,
        "wires": []
    },
    {
        "id": "4ba987a40053dd1a",
        "type": "function",
        "z": "2fda3a02bb66fe0f",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[7] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[7]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[7];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[7];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[7];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 680,
        "wires": [
            [
                "5ba9ac4ac4a41011"
            ],
            [
                "badde3e442e9dce9",
                "6ed076d4f0fe99cb"
            ],
            [
                "04238cc4cc56ada9",
                "9defa92887824e2a"
            ]
        ]
    },
    {
        "id": "22ece330d2cf3deb",
        "type": "link in",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 740,
        "wires": [
            [
                "4ba987a40053dd1a"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "22b935cf34520e3a",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "576dae3b804b0999",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 920,
        "wires": []
    },
    {
        "id": "d1f7ab27a8639860",
        "type": "ui_led",
        "z": "2fda3a02bb66fe0f",
        "order": 6,
        "group": "b70cc8a1b4cc3153",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 760,
        "wires": []
    },
    {
        "id": "b57a4212c8cca472",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 920,
        "wires": [
            [
                "22b935cf34520e3a"
            ]
        ]
    },
    {
        "id": "5ba9ac4ac4a41011",
        "type": "mqtt in",
        "z": "2fda3a02bb66fe0f",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 600,
        "wires": [
            [
                "1a014fb1277f035a",
                "42b32d782b455087",
                "9f4c1a9c854ec277",
                "45cd4e1d26c44823"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "53f58af7bf9f404a",
        "type": "function",
        "z": "2fda3a02bb66fe0f",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 960,
        "wires": [
            [
                "9672b609dab72ffc"
            ]
        ]
    },
    {
        "id": "9672b609dab72ffc",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "576dae3b804b0999",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 960,
        "wires": []
    },
    {
        "id": "eb01695bdefb7189",
        "type": "change",
        "z": "2fda3a02bb66fe0f",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 960,
        "wires": [
            [
                "53f58af7bf9f404a"
            ]
        ]
    },
    {
        "id": "55c4e5eb019618c3",
        "type": "ui_toast",
        "z": "2fda3a02bb66fe0f",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1460,
        "wires": [
            []
        ]
    },
    {
        "id": "6ffbc35a37b320ef",
        "type": "ui_button",
        "z": "2fda3a02bb66fe0f",
        "name": "ayuda",
        "group": "0744241a857645e3",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1460,
        "wires": [
            [
                "55c4e5eb019618c3"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "04238cc4cc56ada9",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "576dae3b804b0999",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 740,
        "wires": []
    },
    {
        "id": "14b8d8741ba84ef5",
        "type": "comment",
        "z": "2fda3a02bb66fe0f",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 440,
        "wires": []
    },
    {
        "id": "0b5e8b5e5253577a",
        "type": "comment",
        "z": "2fda3a02bb66fe0f",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 40,
        "wires": []
    },
    {
        "id": "56a9c0c00e642ac7",
        "type": "comment",
        "z": "2fda3a02bb66fe0f",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1040,
        "wires": []
    },
    {
        "id": "6ed076d4f0fe99cb",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 700,
        "wires": []
    },
    {
        "id": "9defa92887824e2a",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 780,
        "wires": []
    },
    {
        "id": "cc1da217c2beea35",
        "type": "ui_text",
        "z": "2fda3a02bb66fe0f",
        "group": "b70cc8a1b4cc3153",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 520,
        "wires": []
    },
    {
        "id": "d5486e6768b76b09",
        "type": "inject",
        "z": "2fda3a02bb66fe0f",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 620,
        "wires": [
            [
                "4ba987a40053dd1a"
            ]
        ]
    },
    {
        "id": "fb6818d5ad9cca36",
        "type": "mqtt out",
        "z": "3974a1c708eddb35",
        "name": "",
        "topic": "omc/01/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1300,
        "y": 1080,
        "wires": []
    },
    {
        "id": "1dbe2448d0e96945",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "973a4177689d0f28",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 60,
        "wires": []
    },
    {
        "id": "6ae02340ebfc048c",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "abaee78aa0a9f33c",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 620,
        "wires": []
    },
    {
        "id": "2d7c6964d698c8a5",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "973a4177689d0f28",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 180,
        "wires": []
    },
    {
        "id": "00f2f3ba574e8d30",
        "type": "ui_chart",
        "z": "3974a1c708eddb35",
        "name": "voltaje grafico",
        "group": "973a4177689d0f28",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1580,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "b7498fb1068da5fe",
        "type": "ui_chart",
        "z": "3974a1c708eddb35",
        "name": "corriente grafico ",
        "group": "973a4177689d0f28",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1580,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "69ae084fd2d25d3e",
        "type": "ui_button",
        "z": "3974a1c708eddb35",
        "name": "Cambiar control suministro",
        "group": "20f18e81a018be4e",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 420,
        "y": 1140,
        "wires": [
            [
                "8f760a1fbe1925d4",
                "b573f0550ac6f453"
            ]
        ]
    },
    {
        "id": "5e053ac7dc8a83cc",
        "type": "mqtt in",
        "z": "3974a1c708eddb35",
        "name": "",
        "topic": "omc/08/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 480,
        "wires": [
            [
                "5282bb9a69d8dadb",
                "0fb82ff4b733ffd8"
            ]
        ]
    },
    {
        "id": "5282bb9a69d8dadb",
        "type": "split",
        "z": "3974a1c708eddb35",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 870,
        "y": 480,
        "wires": [
            [
                "09f757773e05e41d"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "09f757773e05e41d",
        "type": "switch",
        "z": "3974a1c708eddb35",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1050,
        "y": 480,
        "wires": [
            [
                "56ec7665e152a31b"
            ],
            [
                "8401805190761a86"
            ],
            [
                "019d10d533266cf7"
            ],
            [
                "0c47b616208af33e"
            ],
            [
                "c0d6c7847db86b32"
            ],
            [
                "585d9db99f15fbf1"
            ],
            [
                "65411eef6bd42024"
            ],
            [
                "7cec1008e7f94662"
            ],
            [
                "d699551fa35c7754"
            ],
            [
                "4ce59e300fee5829"
            ],
            [
                "6979452c1e943ecf"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "56ec7665e152a31b",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 100,
        "wires": [
            [
                "1dbe2448d0e96945",
                "00f2f3ba574e8d30",
                "8f199b1ac71aed94"
            ]
        ]
    },
    {
        "id": "8401805190761a86",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 220,
        "wires": [
            [
                "2d7c6964d698c8a5",
                "b7498fb1068da5fe",
                "991d2501cb91cde6"
            ]
        ]
    },
    {
        "id": "019d10d533266cf7",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 340,
        "wires": [
            [
                "b7c80e63156f6db7",
                "ed207267a06cc903",
                "ae93622b3b737a56"
            ]
        ]
    },
    {
        "id": "0c47b616208af33e",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 440,
        "wires": [
            [
                "72d599e88fe52a9c",
                "28c95394f2cef36a",
                "adf65493d0266312"
            ]
        ]
    },
    {
        "id": "c0d6c7847db86b32",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 560,
        "wires": [
            [
                "a65d7f02e478409b",
                "ee668d0d206b8959"
            ]
        ]
    },
    {
        "id": "585d9db99f15fbf1",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 680,
        "wires": [
            [
                "6ae02340ebfc048c",
                "b6e93ec60a8851e4",
                "7ffd929e948ae794",
                "70181ca85b7a38f3"
            ]
        ]
    },
    {
        "id": "7cec1008e7f94662",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 820,
        "wires": [
            [
                "4ca74455b604fa9c"
            ]
        ]
    },
    {
        "id": "d699551fa35c7754",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 860,
        "wires": [
            [
                "094696d6bf5b9c3e"
            ]
        ]
    },
    {
        "id": "b7c80e63156f6db7",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "12de173720176460",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 300,
        "wires": []
    },
    {
        "id": "ed207267a06cc903",
        "type": "ui_chart",
        "z": "3974a1c708eddb35",
        "name": "potencia grafico",
        "group": "12de173720176460",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1580,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "72d599e88fe52a9c",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "12de173720176460",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 420,
        "wires": []
    },
    {
        "id": "a65d7f02e478409b",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "12de173720176460",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 540,
        "wires": []
    },
    {
        "id": "65411eef6bd42024",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 780,
        "wires": [
            [
                "1a7a9bbd4c0212b8"
            ]
        ]
    },
    {
        "id": "1a7a9bbd4c0212b8",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "20f18e81a018be4e",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 780,
        "wires": []
    },
    {
        "id": "1f94cba98e7b4c8b",
        "type": "comment",
        "z": "3974a1c708eddb35",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1290,
        "y": 60,
        "wires": []
    },
    {
        "id": "0208fa56e63fb064",
        "type": "comment",
        "z": "3974a1c708eddb35",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1040,
        "y": 360,
        "wires": []
    },
    {
        "id": "5e90e8c1b4d4586d",
        "type": "comment",
        "z": "3974a1c708eddb35",
        "name": "Separación de mensaje",
        "info": "",
        "x": 880,
        "y": 420,
        "wires": []
    },
    {
        "id": "a659b8d74ded3fb7",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 940,
        "y": 1260,
        "wires": [
            [
                "47258a7c8fd006b5"
            ]
        ]
    },
    {
        "id": "4dd42a4e351a5d81",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1520,
        "y": 1380,
        "wires": []
    },
    {
        "id": "8f760a1fbe1925d4",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 1260,
        "wires": [
            [
                "a659b8d74ded3fb7"
            ]
        ]
    },
    {
        "id": "28c95394f2cef36a",
        "type": "ui_gauge",
        "z": "3974a1c708eddb35",
        "name": "factor de potencia",
        "group": "12de173720176460",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1590,
        "y": 460,
        "wires": []
    },
    {
        "id": "5eeb9be4b8f1608e",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1380,
        "wires": [
            [
                "4dd42a4e351a5d81"
            ]
        ]
    },
    {
        "id": "39da5b0a7a237733",
        "type": "complete",
        "z": "3974a1c708eddb35",
        "name": "sí dio aceptar",
        "scope": [
            "bf59373bfadab3dd",
            "6020e4fdae0f94c5",
            "0a787970bb59b3ac"
        ],
        "uncaught": false,
        "x": 330,
        "y": 1080,
        "wires": [
            [
                "f96c6bcdbd362b86"
            ]
        ]
    },
    {
        "id": "b6e93ec60a8851e4",
        "type": "ui_led",
        "z": "3974a1c708eddb35",
        "order": 8,
        "group": "abaee78aa0a9f33c",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1590,
        "y": 660,
        "wires": []
    },
    {
        "id": "b573f0550ac6f453",
        "type": "function",
        "z": "3974a1c708eddb35",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 1080,
        "wires": [
            [
                "d2d9926dc8684681"
            ]
        ]
    },
    {
        "id": "f96c6bcdbd362b86",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 1080,
        "wires": [
            [
                "b573f0550ac6f453"
            ]
        ]
    },
    {
        "id": "d2d9926dc8684681",
        "type": "switch",
        "z": "3974a1c708eddb35",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1070,
        "y": 1080,
        "wires": [
            [
                "fb6818d5ad9cca36"
            ]
        ]
    },
    {
        "id": "71dfb6b0de202a6e",
        "type": "ui_button",
        "z": "3974a1c708eddb35",
        "name": "Reiniciar energía",
        "group": "12de173720176460",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 450,
        "y": 1320,
        "wires": [
            [
                "8602a15c6722a8e9",
                "b573f0550ac6f453"
            ]
        ]
    },
    {
        "id": "4d5a6a1a126a8ad9",
        "type": "ui_dropdown",
        "z": "3974a1c708eddb35",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "20f18e81a018be4e",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 460,
        "y": 1200,
        "wires": [
            [
                "8f760a1fbe1925d4",
                "b573f0550ac6f453"
            ]
        ]
    },
    {
        "id": "41a00660ce984982",
        "type": "ui_led",
        "z": "3974a1c708eddb35",
        "order": 4,
        "group": "abaee78aa0a9f33c",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 680,
        "y": 600,
        "wires": []
    },
    {
        "id": "0fb82ff4b733ffd8",
        "type": "trigger",
        "z": "3974a1c708eddb35",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 420,
        "y": 540,
        "wires": [
            [
                "c22105d7435d24fa",
                "41a00660ce984982",
                "7220f29e8abc1da9"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "c22105d7435d24fa",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "abaee78aa0a9f33c",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 710,
        "y": 560,
        "wires": []
    },
    {
        "id": "feadb18e37081c9a",
        "type": "link in",
        "z": "3974a1c708eddb35",
        "name": "",
        "links": [
            "4ca74455b604fa9c"
        ],
        "x": 325,
        "y": 1200,
        "wires": [
            [
                "4d5a6a1a126a8ad9"
            ]
        ]
    },
    {
        "id": "4ca74455b604fa9c",
        "type": "link out",
        "z": "3974a1c708eddb35",
        "name": "",
        "mode": "link",
        "links": [
            "feadb18e37081c9a"
        ],
        "x": 1515,
        "y": 820,
        "wires": []
    },
    {
        "id": "4fededfb1583c347",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "20f18e81a018be4e",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1630,
        "y": 860,
        "wires": []
    },
    {
        "id": "8602a15c6722a8e9",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 1320,
        "wires": [
            [
                "1122cee40875eb04"
            ]
        ]
    },
    {
        "id": "60e2a156937ba961",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "20f18e81a018be4e",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1620,
        "y": 820,
        "wires": []
    },
    {
        "id": "094696d6bf5b9c3e",
        "type": "link out",
        "z": "3974a1c708eddb35",
        "name": "",
        "mode": "link",
        "links": [
            "46ec0565c1aff819"
        ],
        "x": 1515,
        "y": 860,
        "wires": []
    },
    {
        "id": "46ec0565c1aff819",
        "type": "link in",
        "z": "3974a1c708eddb35",
        "name": "",
        "links": [
            "094696d6bf5b9c3e"
        ],
        "x": 325,
        "y": 1260,
        "wires": [
            [
                "616fd2dea797eb79"
            ]
        ]
    },
    {
        "id": "616fd2dea797eb79",
        "type": "ui_dropdown",
        "z": "3974a1c708eddb35",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "20f18e81a018be4e",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 450,
        "y": 1260,
        "wires": [
            [
                "8f760a1fbe1925d4",
                "b573f0550ac6f453"
            ]
        ]
    },
    {
        "id": "a6a8e3d7ee97a8cc",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 520,
        "wires": [
            [
                "5282bb9a69d8dadb"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "157a4a44a47114bc",
        "type": "ui_button",
        "z": "3974a1c708eddb35",
        "name": "Reinicio dispositivo",
        "group": "20f18e81a018be4e",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 450,
        "y": 1380,
        "wires": [
            [
                "6dbf8b74b67bf3bb",
                "b573f0550ac6f453"
            ]
        ]
    },
    {
        "id": "6dbf8b74b67bf3bb",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 1380,
        "wires": [
            [
                "53081cf50e28816e"
            ]
        ]
    },
    {
        "id": "1122cee40875eb04",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 940,
        "y": 1320,
        "wires": [
            [
                "47c927f91d57623c"
            ]
        ]
    },
    {
        "id": "53081cf50e28816e",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 940,
        "y": 1380,
        "wires": [
            [
                "b1fb0775190eba7a"
            ]
        ]
    },
    {
        "id": "47c927f91d57623c",
        "type": "switch",
        "z": "3974a1c708eddb35",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 1320,
        "wires": [
            [
                "6020e4fdae0f94c5"
            ],
            [
                "5eeb9be4b8f1608e"
            ]
        ]
    },
    {
        "id": "b1fb0775190eba7a",
        "type": "switch",
        "z": "3974a1c708eddb35",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 1380,
        "wires": [
            [
                "0a787970bb59b3ac"
            ],
            [
                "5eeb9be4b8f1608e"
            ]
        ]
    },
    {
        "id": "6020e4fdae0f94c5",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 8",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 1300,
        "wires": [
            [
                "951831ef2125bc5d"
            ]
        ]
    },
    {
        "id": "951831ef2125bc5d",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1520,
        "y": 1300,
        "wires": []
    },
    {
        "id": "0a787970bb59b3ac",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 8",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 1340,
        "wires": [
            [
                "bd2cb6b9b29c703b"
            ]
        ]
    },
    {
        "id": "bd2cb6b9b29c703b",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1520,
        "y": 1340,
        "wires": []
    },
    {
        "id": "8f199b1ac71aed94",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1580,
        "y": 140,
        "wires": []
    },
    {
        "id": "991d2501cb91cde6",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 260,
        "wires": []
    },
    {
        "id": "ae93622b3b737a56",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 380,
        "wires": []
    },
    {
        "id": "ee668d0d206b8959",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 580,
        "wires": []
    },
    {
        "id": "7ffd929e948ae794",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1620,
        "y": 700,
        "wires": []
    },
    {
        "id": "7220f29e8abc1da9",
        "type": "ui_led",
        "z": "3974a1c708eddb35",
        "order": 2,
        "group": "3c08646986b553c8",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 710,
        "y": 640,
        "wires": []
    },
    {
        "id": "a4821bec7fb72f85",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 710,
        "y": 680,
        "wires": []
    },
    {
        "id": "f65c9289d5d167f2",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1520,
        "y": 1260,
        "wires": []
    },
    {
        "id": "bf59373bfadab3dd",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 8",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1260,
        "wires": [
            [
                "f65c9289d5d167f2"
            ]
        ]
    },
    {
        "id": "47258a7c8fd006b5",
        "type": "switch",
        "z": "3974a1c708eddb35",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 1260,
        "wires": [
            [
                "bf59373bfadab3dd"
            ],
            [
                "5eeb9be4b8f1608e"
            ]
        ]
    },
    {
        "id": "1cb30df73b4425a1",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "abaee78aa0a9f33c",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 400,
        "y": 640,
        "wires": []
    },
    {
        "id": "3819b5fd5d852046",
        "type": "function",
        "z": "3974a1c708eddb35",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[8] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[8]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[8];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[8];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[8];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 150,
        "y": 660,
        "wires": [
            [
                "fd786a4c56b0d326"
            ],
            [
                "1cb30df73b4425a1",
                "ce00fca69d2b3cdb"
            ],
            [
                "6b56cbec5d24bac8",
                "410327a6a37f70f9"
            ]
        ]
    },
    {
        "id": "1c086105fc64474b",
        "type": "link in",
        "z": "3974a1c708eddb35",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 165,
        "y": 720,
        "wires": [
            [
                "3819b5fd5d852046"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "efb459a18de9b8db",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "abaee78aa0a9f33c",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 900,
        "wires": []
    },
    {
        "id": "70181ca85b7a38f3",
        "type": "ui_led",
        "z": "3974a1c708eddb35",
        "order": 6,
        "group": "3c08646986b553c8",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1620,
        "y": 740,
        "wires": []
    },
    {
        "id": "4ce59e300fee5829",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 900,
        "wires": [
            [
                "efb459a18de9b8db"
            ]
        ]
    },
    {
        "id": "fd786a4c56b0d326",
        "type": "mqtt in",
        "z": "3974a1c708eddb35",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 400,
        "y": 580,
        "wires": [
            [
                "c22105d7435d24fa",
                "7220f29e8abc1da9",
                "41a00660ce984982",
                "a6a8e3d7ee97a8cc"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "f057e55195da5750",
        "type": "function",
        "z": "3974a1c708eddb35",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1480,
        "y": 940,
        "wires": [
            [
                "f2bf92309e4b266a"
            ]
        ]
    },
    {
        "id": "f2bf92309e4b266a",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "abaee78aa0a9f33c",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1670,
        "y": 940,
        "wires": []
    },
    {
        "id": "6979452c1e943ecf",
        "type": "change",
        "z": "3974a1c708eddb35",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 940,
        "wires": [
            [
                "f057e55195da5750"
            ]
        ]
    },
    {
        "id": "48218a0445ef8b29",
        "type": "ui_toast",
        "z": "3974a1c708eddb35",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 720,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "e51184bf2e37e098",
        "type": "ui_button",
        "z": "3974a1c708eddb35",
        "name": "ayuda",
        "group": "20f18e81a018be4e",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 490,
        "y": 1440,
        "wires": [
            [
                "48218a0445ef8b29"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "6b56cbec5d24bac8",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "abaee78aa0a9f33c",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 720,
        "wires": []
    },
    {
        "id": "e4acc08261eb4554",
        "type": "comment",
        "z": "3974a1c708eddb35",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 170,
        "y": 420,
        "wires": []
    },
    {
        "id": "903ad5ef71f02c74",
        "type": "comment",
        "z": "3974a1c708eddb35",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1590,
        "y": 20,
        "wires": []
    },
    {
        "id": "e60f5b078c83cc9a",
        "type": "comment",
        "z": "3974a1c708eddb35",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 1000,
        "y": 1020,
        "wires": []
    },
    {
        "id": "ce00fca69d2b3cdb",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 390,
        "y": 680,
        "wires": []
    },
    {
        "id": "410327a6a37f70f9",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 400,
        "y": 760,
        "wires": []
    },
    {
        "id": "adf65493d0266312",
        "type": "ui_text",
        "z": "3974a1c708eddb35",
        "group": "3c08646986b553c8",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 500,
        "wires": []
    },
    {
        "id": "40a7d69ade2fba8a",
        "type": "inject",
        "z": "3974a1c708eddb35",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 600,
        "wires": [
            [
                "3819b5fd5d852046"
            ]
        ]
    },
    {
        "id": "47c420ce489ccee4",
        "type": "mqtt out",
        "z": "73be0d245c0caa40",
        "name": "",
        "topic": "omc/09/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1300,
        "y": 1080,
        "wires": []
    },
    {
        "id": "4c90b00543e9e283",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "2e4bce2f235fefcf",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 60,
        "wires": []
    },
    {
        "id": "36db9a3111615528",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "73c89f17db2fa1b5",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 620,
        "wires": []
    },
    {
        "id": "2ea94b86e0ceb087",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "2e4bce2f235fefcf",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 180,
        "wires": []
    },
    {
        "id": "87139654c59bbf31",
        "type": "ui_chart",
        "z": "73be0d245c0caa40",
        "name": "voltaje grafico",
        "group": "2e4bce2f235fefcf",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1580,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "d1010e2ff715defd",
        "type": "ui_chart",
        "z": "73be0d245c0caa40",
        "name": "corriente grafico ",
        "group": "2e4bce2f235fefcf",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1580,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "e4c88dca82c17922",
        "type": "ui_button",
        "z": "73be0d245c0caa40",
        "name": "Cambiar control suministro",
        "group": "6130d08a9658aecf",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 420,
        "y": 1140,
        "wires": [
            [
                "84f4ee9da0a3e640",
                "401b46a93204a5c1"
            ]
        ]
    },
    {
        "id": "ec94d44436c958db",
        "type": "mqtt in",
        "z": "73be0d245c0caa40",
        "name": "",
        "topic": "omc/09/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 160,
        "y": 480,
        "wires": [
            [
                "10712f496985e075",
                "c13f9e8e6d8281bc"
            ]
        ]
    },
    {
        "id": "10712f496985e075",
        "type": "split",
        "z": "73be0d245c0caa40",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 870,
        "y": 480,
        "wires": [
            [
                "b0d54c48605053f0"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "b0d54c48605053f0",
        "type": "switch",
        "z": "73be0d245c0caa40",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1050,
        "y": 480,
        "wires": [
            [
                "cd1622ef68c52dee"
            ],
            [
                "23fa631ae374831e"
            ],
            [
                "b779e07c71094fd4"
            ],
            [
                "5bd182705a5d791a"
            ],
            [
                "e569eb1235561aea"
            ],
            [
                "c986be5829bfee04"
            ],
            [
                "933b32fe6c39e2cb"
            ],
            [
                "62650969c25dafb4"
            ],
            [
                "81fc49891b256189"
            ],
            [
                "77400e2e0c4c71a8"
            ],
            [
                "7d885c27431665d6"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "cd1622ef68c52dee",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 100,
        "wires": [
            [
                "4c90b00543e9e283",
                "87139654c59bbf31",
                "8cd5b9e9bb3c064f"
            ]
        ]
    },
    {
        "id": "23fa631ae374831e",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 220,
        "wires": [
            [
                "2ea94b86e0ceb087",
                "d1010e2ff715defd",
                "9dfbda0bfed6b5e1"
            ]
        ]
    },
    {
        "id": "b779e07c71094fd4",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 340,
        "wires": [
            [
                "726e6705b877bc26",
                "afaf76e2ef031d31",
                "3327e3b3d721ab41"
            ]
        ]
    },
    {
        "id": "5bd182705a5d791a",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 440,
        "wires": [
            [
                "afcd7dcf397cf3ae",
                "15a16b4f0d9a566c",
                "4dfdd6be4cc1e0ac"
            ]
        ]
    },
    {
        "id": "e569eb1235561aea",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 560,
        "wires": [
            [
                "dc97470b36a90e4e",
                "c381b9ddf965d327"
            ]
        ]
    },
    {
        "id": "c986be5829bfee04",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 680,
        "wires": [
            [
                "36db9a3111615528",
                "3662825e9394af91",
                "4dd3c5f2af5f45c6",
                "a0f73bfe2d9bf85f"
            ]
        ]
    },
    {
        "id": "62650969c25dafb4",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 820,
        "wires": [
            [
                "8ce77da1c3a6bfdf"
            ]
        ]
    },
    {
        "id": "81fc49891b256189",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 860,
        "wires": [
            [
                "3ba11acda5c39d25"
            ]
        ]
    },
    {
        "id": "726e6705b877bc26",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "a83cfdc4d8cb11be",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 300,
        "wires": []
    },
    {
        "id": "afaf76e2ef031d31",
        "type": "ui_chart",
        "z": "73be0d245c0caa40",
        "name": "potencia grafico",
        "group": "a83cfdc4d8cb11be",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1580,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "afcd7dcf397cf3ae",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "a83cfdc4d8cb11be",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 420,
        "wires": []
    },
    {
        "id": "dc97470b36a90e4e",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "a83cfdc4d8cb11be",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 540,
        "wires": []
    },
    {
        "id": "933b32fe6c39e2cb",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 780,
        "wires": [
            [
                "986b8fb4ab758e9c"
            ]
        ]
    },
    {
        "id": "986b8fb4ab758e9c",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "6130d08a9658aecf",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 780,
        "wires": []
    },
    {
        "id": "81cee1180a83223d",
        "type": "comment",
        "z": "73be0d245c0caa40",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1290,
        "y": 60,
        "wires": []
    },
    {
        "id": "fffb4487f09c4391",
        "type": "comment",
        "z": "73be0d245c0caa40",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1040,
        "y": 360,
        "wires": []
    },
    {
        "id": "40af87e42debedb5",
        "type": "comment",
        "z": "73be0d245c0caa40",
        "name": "Separación de mensaje",
        "info": "",
        "x": 880,
        "y": 420,
        "wires": []
    },
    {
        "id": "c7468cf2891108e9",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 940,
        "y": 1260,
        "wires": [
            [
                "3cbabec49f41ffd2"
            ]
        ]
    },
    {
        "id": "33d9800cb47ad4ee",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1520,
        "y": 1380,
        "wires": []
    },
    {
        "id": "84f4ee9da0a3e640",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 1260,
        "wires": [
            [
                "c7468cf2891108e9"
            ]
        ]
    },
    {
        "id": "15a16b4f0d9a566c",
        "type": "ui_gauge",
        "z": "73be0d245c0caa40",
        "name": "factor de potencia",
        "group": "a83cfdc4d8cb11be",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1590,
        "y": 460,
        "wires": []
    },
    {
        "id": "01259324757d3c32",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1380,
        "wires": [
            [
                "33d9800cb47ad4ee"
            ]
        ]
    },
    {
        "id": "c7e2960f2a8c4b83",
        "type": "complete",
        "z": "73be0d245c0caa40",
        "name": "sí dio aceptar",
        "scope": [
            "bdf7b0da9c99a0e3",
            "95ca87dc836f52e4",
            "e9d0cb739684d491"
        ],
        "uncaught": false,
        "x": 330,
        "y": 1080,
        "wires": [
            [
                "6dc48cd4e86cd26b"
            ]
        ]
    },
    {
        "id": "3662825e9394af91",
        "type": "ui_led",
        "z": "73be0d245c0caa40",
        "order": 8,
        "group": "73c89f17db2fa1b5",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1590,
        "y": 660,
        "wires": []
    },
    {
        "id": "401b46a93204a5c1",
        "type": "function",
        "z": "73be0d245c0caa40",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 790,
        "y": 1080,
        "wires": [
            [
                "3f8e945aad848fd1"
            ]
        ]
    },
    {
        "id": "6dc48cd4e86cd26b",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 480,
        "y": 1080,
        "wires": [
            [
                "401b46a93204a5c1"
            ]
        ]
    },
    {
        "id": "3f8e945aad848fd1",
        "type": "switch",
        "z": "73be0d245c0caa40",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1070,
        "y": 1080,
        "wires": [
            [
                "47c420ce489ccee4"
            ]
        ]
    },
    {
        "id": "7d6787a276d6e39f",
        "type": "ui_button",
        "z": "73be0d245c0caa40",
        "name": "Reiniciar energía",
        "group": "a83cfdc4d8cb11be",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 450,
        "y": 1320,
        "wires": [
            [
                "450c86c4e024efe7",
                "401b46a93204a5c1"
            ]
        ]
    },
    {
        "id": "2653a5b5dfbbc75e",
        "type": "ui_dropdown",
        "z": "73be0d245c0caa40",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "6130d08a9658aecf",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 460,
        "y": 1200,
        "wires": [
            [
                "84f4ee9da0a3e640",
                "401b46a93204a5c1"
            ]
        ]
    },
    {
        "id": "915168e39abe8245",
        "type": "ui_led",
        "z": "73be0d245c0caa40",
        "order": 4,
        "group": "73c89f17db2fa1b5",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 680,
        "y": 600,
        "wires": []
    },
    {
        "id": "c13f9e8e6d8281bc",
        "type": "trigger",
        "z": "73be0d245c0caa40",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 420,
        "y": 540,
        "wires": [
            [
                "1b094251b5715322",
                "915168e39abe8245",
                "e9cc586f45ffe582"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "1b094251b5715322",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "73c89f17db2fa1b5",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 710,
        "y": 560,
        "wires": []
    },
    {
        "id": "f306fec9c140cfbb",
        "type": "link in",
        "z": "73be0d245c0caa40",
        "name": "",
        "links": [
            "8ce77da1c3a6bfdf"
        ],
        "x": 325,
        "y": 1200,
        "wires": [
            [
                "2653a5b5dfbbc75e"
            ]
        ]
    },
    {
        "id": "8ce77da1c3a6bfdf",
        "type": "link out",
        "z": "73be0d245c0caa40",
        "name": "",
        "mode": "link",
        "links": [
            "f306fec9c140cfbb"
        ],
        "x": 1515,
        "y": 820,
        "wires": []
    },
    {
        "id": "e9a2f770c998598a",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "6130d08a9658aecf",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1630,
        "y": 860,
        "wires": []
    },
    {
        "id": "450c86c4e024efe7",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 1320,
        "wires": [
            [
                "069821d1bda0ca2e"
            ]
        ]
    },
    {
        "id": "983adbeae0b9bceb",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "6130d08a9658aecf",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1620,
        "y": 820,
        "wires": []
    },
    {
        "id": "3ba11acda5c39d25",
        "type": "link out",
        "z": "73be0d245c0caa40",
        "name": "",
        "mode": "link",
        "links": [
            "99e0e377f971b5b0"
        ],
        "x": 1515,
        "y": 860,
        "wires": []
    },
    {
        "id": "99e0e377f971b5b0",
        "type": "link in",
        "z": "73be0d245c0caa40",
        "name": "",
        "links": [
            "3ba11acda5c39d25"
        ],
        "x": 325,
        "y": 1260,
        "wires": [
            [
                "98ca235dfea82a1d"
            ]
        ]
    },
    {
        "id": "98ca235dfea82a1d",
        "type": "ui_dropdown",
        "z": "73be0d245c0caa40",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "6130d08a9658aecf",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 450,
        "y": 1260,
        "wires": [
            [
                "84f4ee9da0a3e640",
                "401b46a93204a5c1"
            ]
        ]
    },
    {
        "id": "9bc663b37bde87e9",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 520,
        "wires": [
            [
                "10712f496985e075"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "0a716e9129d7bbe1",
        "type": "ui_button",
        "z": "73be0d245c0caa40",
        "name": "Reinicio dispositivo",
        "group": "6130d08a9658aecf",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 450,
        "y": 1380,
        "wires": [
            [
                "a99e7492195f1509",
                "401b46a93204a5c1"
            ]
        ]
    },
    {
        "id": "a99e7492195f1509",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 750,
        "y": 1380,
        "wires": [
            [
                "96f9279c948c2d6c"
            ]
        ]
    },
    {
        "id": "069821d1bda0ca2e",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 940,
        "y": 1320,
        "wires": [
            [
                "18b3b0e22f29b617"
            ]
        ]
    },
    {
        "id": "96f9279c948c2d6c",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 940,
        "y": 1380,
        "wires": [
            [
                "0fc681c0ed11e8cd"
            ]
        ]
    },
    {
        "id": "18b3b0e22f29b617",
        "type": "switch",
        "z": "73be0d245c0caa40",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 1320,
        "wires": [
            [
                "95ca87dc836f52e4"
            ],
            [
                "01259324757d3c32"
            ]
        ]
    },
    {
        "id": "0fc681c0ed11e8cd",
        "type": "switch",
        "z": "73be0d245c0caa40",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 1380,
        "wires": [
            [
                "e9d0cb739684d491"
            ],
            [
                "01259324757d3c32"
            ]
        ]
    },
    {
        "id": "95ca87dc836f52e4",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 9",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 1300,
        "wires": [
            [
                "51c6b5f027aa81da"
            ]
        ]
    },
    {
        "id": "51c6b5f027aa81da",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1520,
        "y": 1300,
        "wires": []
    },
    {
        "id": "e9d0cb739684d491",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 9",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1340,
        "y": 1340,
        "wires": [
            [
                "891e8efb0af71e72"
            ]
        ]
    },
    {
        "id": "891e8efb0af71e72",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1520,
        "y": 1340,
        "wires": []
    },
    {
        "id": "8cd5b9e9bb3c064f",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1580,
        "y": 140,
        "wires": []
    },
    {
        "id": "9dfbda0bfed6b5e1",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 260,
        "wires": []
    },
    {
        "id": "3327e3b3d721ab41",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 380,
        "wires": []
    },
    {
        "id": "c381b9ddf965d327",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1590,
        "y": 580,
        "wires": []
    },
    {
        "id": "4dd3c5f2af5f45c6",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1620,
        "y": 700,
        "wires": []
    },
    {
        "id": "e9cc586f45ffe582",
        "type": "ui_led",
        "z": "73be0d245c0caa40",
        "order": 2,
        "group": "7157ec15d9059687",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 710,
        "y": 640,
        "wires": []
    },
    {
        "id": "e4f46e1572f46158",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 710,
        "y": 680,
        "wires": []
    },
    {
        "id": "c3879bdee2459f75",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1520,
        "y": 1260,
        "wires": []
    },
    {
        "id": "bdf7b0da9c99a0e3",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 9",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1260,
        "wires": [
            [
                "c3879bdee2459f75"
            ]
        ]
    },
    {
        "id": "3cbabec49f41ffd2",
        "type": "switch",
        "z": "73be0d245c0caa40",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1100,
        "y": 1260,
        "wires": [
            [
                "bdf7b0da9c99a0e3"
            ],
            [
                "01259324757d3c32"
            ]
        ]
    },
    {
        "id": "07911787efba2fe5",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "73c89f17db2fa1b5",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 400,
        "y": 640,
        "wires": []
    },
    {
        "id": "37065cde95550466",
        "type": "function",
        "z": "73be0d245c0caa40",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[9] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[9]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[9];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[9];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[9];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 150,
        "y": 660,
        "wires": [
            [
                "8f24279f50d10a00"
            ],
            [
                "07911787efba2fe5",
                "817b97d0e9be66df"
            ],
            [
                "974d1b7a51a6d8ba",
                "88b0143601e2c4d4"
            ]
        ]
    },
    {
        "id": "9029571b4071d1ec",
        "type": "link in",
        "z": "73be0d245c0caa40",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 165,
        "y": 720,
        "wires": [
            [
                "37065cde95550466"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "69df511a3722b804",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "73c89f17db2fa1b5",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 900,
        "wires": []
    },
    {
        "id": "a0f73bfe2d9bf85f",
        "type": "ui_led",
        "z": "73be0d245c0caa40",
        "order": 6,
        "group": "7157ec15d9059687",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1620,
        "y": 740,
        "wires": []
    },
    {
        "id": "77400e2e0c4c71a8",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1310,
        "y": 900,
        "wires": [
            [
                "69df511a3722b804"
            ]
        ]
    },
    {
        "id": "8f24279f50d10a00",
        "type": "mqtt in",
        "z": "73be0d245c0caa40",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 400,
        "y": 580,
        "wires": [
            [
                "1b094251b5715322",
                "e9cc586f45ffe582",
                "915168e39abe8245",
                "9bc663b37bde87e9"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "5f98f8f0c2a4ab90",
        "type": "function",
        "z": "73be0d245c0caa40",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1480,
        "y": 940,
        "wires": [
            [
                "47f5fa02d03c406f"
            ]
        ]
    },
    {
        "id": "47f5fa02d03c406f",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "73c89f17db2fa1b5",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1670,
        "y": 940,
        "wires": []
    },
    {
        "id": "7d885c27431665d6",
        "type": "change",
        "z": "73be0d245c0caa40",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 940,
        "wires": [
            [
                "5f98f8f0c2a4ab90"
            ]
        ]
    },
    {
        "id": "1fd5a2e13672b22f",
        "type": "ui_toast",
        "z": "73be0d245c0caa40",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 720,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "2180e4e863216cbe",
        "type": "ui_button",
        "z": "73be0d245c0caa40",
        "name": "ayuda",
        "group": "6130d08a9658aecf",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 490,
        "y": 1440,
        "wires": [
            [
                "1fd5a2e13672b22f"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "974d1b7a51a6d8ba",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "73c89f17db2fa1b5",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 720,
        "wires": []
    },
    {
        "id": "025f2470ca2e8c11",
        "type": "comment",
        "z": "73be0d245c0caa40",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 170,
        "y": 420,
        "wires": []
    },
    {
        "id": "08e832ff075a2153",
        "type": "comment",
        "z": "73be0d245c0caa40",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1590,
        "y": 20,
        "wires": []
    },
    {
        "id": "52e09245f4c35133",
        "type": "comment",
        "z": "73be0d245c0caa40",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 1000,
        "y": 1020,
        "wires": []
    },
    {
        "id": "817b97d0e9be66df",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 390,
        "y": 680,
        "wires": []
    },
    {
        "id": "88b0143601e2c4d4",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 400,
        "y": 760,
        "wires": []
    },
    {
        "id": "4dfdd6be4cc1e0ac",
        "type": "ui_text",
        "z": "73be0d245c0caa40",
        "group": "7157ec15d9059687",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 500,
        "wires": []
    },
    {
        "id": "1af2f9eab6a54df0",
        "type": "inject",
        "z": "73be0d245c0caa40",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 600,
        "wires": [
            [
                "37065cde95550466"
            ]
        ]
    },
    {
        "id": "5bd06d07b0bf88d9",
        "type": "mqtt out",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "topic": "omc/10/cambios",
        "qos": "2",
        "retain": "false",
        "respTopic": "",
        "contentType": "",
        "userProps": "",
        "correl": "",
        "expiry": "",
        "broker": "10e78a89.5b4fd5",
        "x": 1280,
        "y": 1080,
        "wires": []
    },
    {
        "id": "5c096595cd21701c",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "150693ab317e3c64",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1530,
        "y": 60,
        "wires": []
    },
    {
        "id": "759d2b63c3ad1d32",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "e92599370e509ead",
        "order": 7,
        "width": 6,
        "height": 1,
        "name": "Estado suministro",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 620,
        "wires": []
    },
    {
        "id": "e5f4c67cce0485ad",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "150693ab317e3c64",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 180,
        "wires": []
    },
    {
        "id": "25289468601e3391",
        "type": "ui_chart",
        "z": "3c7bdc336f76b0ee",
        "name": "voltaje grafico",
        "group": "150693ab317e3c64",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4",
            "#1f77b4"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 100,
        "wires": [
            []
        ]
    },
    {
        "id": "ec800073ea23cf9b",
        "type": "ui_chart",
        "z": "3c7bdc336f76b0ee",
        "name": "corriente grafico ",
        "group": "150693ab317e3c64",
        "order": 4,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803",
            "#dc1803"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "32ae033d3e604fc6",
        "type": "ui_button",
        "z": "3c7bdc336f76b0ee",
        "name": "Cambiar control suministro",
        "group": "bda7e38372e6dfe8",
        "order": 2,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Cambiar",
        "tooltip": "Cambiar el comportamiento del suministro (Automático o Bloqueado manualmente)",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "mr",
        "payloadType": "str",
        "topic": "Cambio de funcionamiento relay",
        "topicType": "str",
        "x": 400,
        "y": 1140,
        "wires": [
            [
                "1bd08a45d5f13a90",
                "f3ec25a7204833e0"
            ]
        ]
    },
    {
        "id": "5e98f0afc7c15a12",
        "type": "mqtt in",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "topic": "omc/10/estado",
        "qos": "0",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 0,
        "x": 140,
        "y": 480,
        "wires": [
            [
                "a7623f13a401c7b6",
                "d4be9f7855a72276"
            ]
        ]
    },
    {
        "id": "a7623f13a401c7b6",
        "type": "split",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "splt": ",",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 850,
        "y": 480,
        "wires": [
            [
                "6055e40569bc7184"
            ]
        ],
        "info": "El mensaje se separa por comas en varios mensajes"
    },
    {
        "id": "6055e40569bc7184",
        "type": "switch",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "regex",
                "v": "^vo",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^co",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^po",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^fp",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^en",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^es",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mr",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^mv",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^lc",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^ip",
                "vt": "str",
                "case": false
            },
            {
                "t": "regex",
                "v": "^up",
                "vt": "str",
                "case": false
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 11,
        "x": 1030,
        "y": 480,
        "wires": [
            [
                "62b0ef3d2397dd84"
            ],
            [
                "6db13cb1b7db68c1"
            ],
            [
                "b9bf04ef3528dc44"
            ],
            [
                "f62aa8b75034f93e"
            ],
            [
                "f0b3a65b790d614e"
            ],
            [
                "cc24af822456e8e4"
            ],
            [
                "c784235540039890"
            ],
            [
                "1a550f3fb0acde73"
            ],
            [
                "3443f47677e1d967"
            ],
            [
                "80b5ad46c79c6430"
            ],
            [
                "d7606ecee68f5096"
            ]
        ],
        "info": "Aquí se diferencian los mensajes y se envían hacia diferentes caminos según cómo inician"
    },
    {
        "id": "62b0ef3d2397dd84",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "voltaje",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "vo",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 100,
        "wires": [
            [
                "5c096595cd21701c",
                "25289468601e3391",
                "385a42557c960cd1"
            ]
        ]
    },
    {
        "id": "6db13cb1b7db68c1",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "corriente",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "co",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 220,
        "wires": [
            [
                "e5f4c67cce0485ad",
                "ec800073ea23cf9b",
                "4b133980a796b0ba"
            ]
        ]
    },
    {
        "id": "b9bf04ef3528dc44",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "po",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 340,
        "wires": [
            [
                "e80760de96a7f23e",
                "a3235a4fb8338fc1",
                "1886446532ea931f"
            ]
        ]
    },
    {
        "id": "f62aa8b75034f93e",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "f. potencia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "fp",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "F. Potencia",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 440,
        "wires": [
            [
                "c8a30d179c230c8c",
                "0bc80e1d12fd5267",
                "c98668f504112eef"
            ]
        ]
    },
    {
        "id": "f0b3a65b790d614e",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "energia",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "en",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Energía",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 560,
        "wires": [
            [
                "75c0b4150e7945c1",
                "67aafb4d14dd0d42"
            ]
        ]
    },
    {
        "id": "cc24af822456e8e4",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "estado OMC",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "es",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "OPERATIVO",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "TIEMPO ESPERA",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "2",
                "fromt": "str",
                "to": "BLOQUEO MANUAL",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "3",
                "fromt": "str",
                "to": "BAJO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "4",
                "fromt": "str",
                "to": "ALTO VOLTAJE",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "5",
                "fromt": "str",
                "to": "ALTA CORRIENTE",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 680,
        "wires": [
            [
                "759d2b63c3ad1d32",
                "b34d881c21b91b60",
                "c3fc309a12ad2d61",
                "2beefb3d55d3cd8b"
            ]
        ]
    },
    {
        "id": "1a550f3fb0acde73",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "modo voltaje",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo voltaje",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 820,
        "wires": [
            [
                "b1e1d05a50407a24"
            ]
        ]
    },
    {
        "id": "3443f47677e1d967",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "limite corriente",
        "rules": [
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Límite de corriente",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 860,
        "wires": [
            [
                "7c0dafd214c2129a"
            ]
        ]
    },
    {
        "id": "e80760de96a7f23e",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "217a93f66d9cc106",
        "order": 1,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1540,
        "y": 300,
        "wires": []
    },
    {
        "id": "a3235a4fb8338fc1",
        "type": "ui_chart",
        "z": "3c7bdc336f76b0ee",
        "name": "potencia grafico",
        "group": "217a93f66d9cc106",
        "order": 2,
        "width": 7,
        "height": 4,
        "label": "",
        "chartType": "line",
        "legend": "false",
        "xformat": "dd HH:mm",
        "interpolate": "cubic",
        "nodata": "Dispositivo desconectado",
        "dot": false,
        "ymin": "",
        "ymax": "",
        "removeOlder": "5",
        "removeOlderPoints": "300",
        "removeOlderUnit": "60",
        "cutout": 0,
        "useOneColor": false,
        "useUTC": false,
        "colors": [
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac",
            "#bf02ac"
        ],
        "outputs": 1,
        "useDifferentColor": false,
        "className": "",
        "x": 1560,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "c8a30d179c230c8c",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "217a93f66d9cc106",
        "order": 3,
        "width": 7,
        "height": 1,
        "name": "",
        "label": "Factor de potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 420,
        "wires": []
    },
    {
        "id": "75c0b4150e7945c1",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "217a93f66d9cc106",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Energía consumida",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 540,
        "wires": []
    },
    {
        "id": "c784235540039890",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "modo relay",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "mr",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "0",
                "fromt": "str",
                "to": "Cortado manualmente",
                "tot": "str"
            },
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "1",
                "fromt": "str",
                "to": "Automático",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Modo relay",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 780,
        "wires": [
            [
                "e827278299418582"
            ]
        ]
    },
    {
        "id": "e827278299418582",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "bda7e38372e6dfe8",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "",
        "label": "Control suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 780,
        "wires": []
    },
    {
        "id": "44af8bc4e406413c",
        "type": "comment",
        "z": "3c7bdc336f76b0ee",
        "name": "Preparación de mensaje",
        "info": "",
        "x": 1270,
        "y": 60,
        "wires": []
    },
    {
        "id": "7be02c4cc41296ba",
        "type": "comment",
        "z": "3c7bdc336f76b0ee",
        "name": "Serie -> Paralelo",
        "info": "",
        "x": 1020,
        "y": 360,
        "wires": []
    },
    {
        "id": "0a280f30e5f71a70",
        "type": "comment",
        "z": "3c7bdc336f76b0ee",
        "name": "Separación de mensaje",
        "info": "",
        "x": 860,
        "y": 420,
        "wires": []
    },
    {
        "id": "1e1499067fd1213c",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1260,
        "wires": [
            [
                "20c1a0e08f2a1054"
            ]
        ]
    },
    {
        "id": "cb3b9b269916814a",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "cancelar",
        "x": 1500,
        "y": 1380,
        "wires": []
    },
    {
        "id": "1bd08a45d5f13a90",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Cambio de control",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Para cambiar el modo de operación del suministro eléctrico debe seleccionar \"Aceptar\". Al hacer esto es probable que el suministro eléctrico del equipo conectado sea afectado, tome sus precacuciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1260,
        "wires": [
            [
                "1e1499067fd1213c"
            ]
        ]
    },
    {
        "id": "0bc80e1d12fd5267",
        "type": "ui_gauge",
        "z": "3c7bdc336f76b0ee",
        "name": "factor de potencia",
        "group": "217a93f66d9cc106",
        "order": 4,
        "width": 7,
        "height": 3,
        "gtype": "gage",
        "title": "",
        "label": "",
        "format": "{{value}}",
        "min": 0,
        "max": "1",
        "colors": [
            "#c60000",
            "#e6e600",
            "#00b500"
        ],
        "seg1": "",
        "seg2": "",
        "className": "",
        "x": 1570,
        "y": 460,
        "wires": []
    },
    {
        "id": "738cdfc10de777e0",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Cancelar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "No se registró ningún cambio. Canceló la operación.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1280,
        "y": 1380,
        "wires": [
            [
                "cb3b9b269916814a"
            ]
        ]
    },
    {
        "id": "a9f43fa205045b0e",
        "type": "complete",
        "z": "3c7bdc336f76b0ee",
        "name": "sí dio aceptar",
        "scope": [
            "829821611c799338",
            "d35510f21492274c",
            "c68c90abec8621fc"
        ],
        "uncaught": false,
        "x": 310,
        "y": 1080,
        "wires": [
            [
                "b54a4f20ce2d38b4"
            ]
        ]
    },
    {
        "id": "b34d881c21b91b60",
        "type": "ui_led",
        "z": "3c7bdc336f76b0ee",
        "order": 8,
        "group": "e92599370e509ead",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro",
        "x": 1570,
        "y": 660,
        "wires": []
    },
    {
        "id": "f3ec25a7204833e0",
        "type": "function",
        "z": "3c7bdc336f76b0ee",
        "name": "habilitado el paso del mensaje?",
        "func": "if (msg.payload != \"habilitador\") {\n    //significa que el mensaje es de cambio\n    \n    //guardamos dicho mensaje solo para enviarse \n    //cuando llegue un habilitador\n    flow.set(\"cambio\", msg.payload);\n    \n    //el mensaje que mandaremos al siguiente nodo será nulo\n    msg.payload = null;\n}\n\nelse {\n    //significa que el mensaje es un habilitador\n    \n    if (flow.get(\"cambio\") != null) {\n        //si tengo cambio entonces lo paso al siguiente nodo\n        msg.payload = flow.get(\"cambio\");\n        //y digo que ahora no tengo cambio\n        flow.set(\"cambio\", null);\n    }\n    else {\n        msg.payload = null; \n    }\n}\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 770,
        "y": 1080,
        "wires": [
            [
                "ded120f7134b4853"
            ]
        ]
    },
    {
        "id": "b54a4f20ce2d38b4",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "habilitar",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "habilitador",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 1080,
        "wires": [
            [
                "f3ec25a7204833e0"
            ]
        ]
    },
    {
        "id": "ded120f7134b4853",
        "type": "switch",
        "z": "3c7bdc336f76b0ee",
        "name": "dejar pasar los no nulos",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nnull"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 1050,
        "y": 1080,
        "wires": [
            [
                "5bd06d07b0bf88d9"
            ]
        ]
    },
    {
        "id": "2e67f5add2d909b7",
        "type": "ui_button",
        "z": "3c7bdc336f76b0ee",
        "name": "Reiniciar energía",
        "group": "217a93f66d9cc106",
        "order": 6,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar",
        "tooltip": "Reiniciar el contador de consumo de energía del dispositivo",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "en",
        "payloadType": "str",
        "topic": "Reinicio de energía",
        "topicType": "str",
        "x": 430,
        "y": 1320,
        "wires": [
            [
                "fd293b4d603e6934",
                "f3ec25a7204833e0"
            ]
        ]
    },
    {
        "id": "14e548f9f6166310",
        "type": "ui_dropdown",
        "z": "3c7bdc336f76b0ee",
        "name": "Cambio voltaje",
        "label": "",
        "tooltip": "Cambio en modo de operación de voltaje (120V o 220V)",
        "place": "",
        "group": "bda7e38372e6dfe8",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "120 V",
                "value": "mv01",
                "type": "str"
            },
            {
                "label": "220 V",
                "value": "mv02",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio de modo de voltaje",
        "topicType": "str",
        "className": "",
        "x": 440,
        "y": 1200,
        "wires": [
            [
                "1bd08a45d5f13a90",
                "f3ec25a7204833e0"
            ]
        ]
    },
    {
        "id": "911e658125aa20cc",
        "type": "ui_led",
        "z": "3c7bdc336f76b0ee",
        "order": 4,
        "group": "e92599370e509ead",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión",
        "x": 660,
        "y": 600,
        "wires": []
    },
    {
        "id": "d4be9f7855a72276",
        "type": "trigger",
        "z": "3c7bdc336f76b0ee",
        "name": "3s sin recibir mensaje",
        "op1": "",
        "op2": "C. INTERRUMPIDA",
        "op1type": "nul",
        "op2type": "str",
        "duration": "3",
        "extend": true,
        "overrideDelay": false,
        "units": "s",
        "reset": "",
        "bytopic": "all",
        "topic": "topic",
        "outputs": 1,
        "x": 400,
        "y": 540,
        "wires": [
            [
                "877a0909919be5ad",
                "911e658125aa20cc",
                "807b15a23d6daaca"
            ]
        ],
        "info": "En caso de que pasen 3 segundos sin que se reciban mensajes MQTT de estado entonces se mostrará un estado de \"Conexión interrumpida\""
    },
    {
        "id": "877a0909919be5ad",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "e92599370e509ead",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "",
        "label": "Estado conexión",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 560,
        "wires": []
    },
    {
        "id": "75e0fd43c613266e",
        "type": "link in",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "links": [
            "b1e1d05a50407a24"
        ],
        "x": 305,
        "y": 1200,
        "wires": [
            [
                "14e548f9f6166310"
            ]
        ]
    },
    {
        "id": "b1e1d05a50407a24",
        "type": "link out",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "mode": "link",
        "links": [
            "75e0fd43c613266e"
        ],
        "x": 1495,
        "y": 820,
        "wires": []
    },
    {
        "id": "b9b4cf07ffdff19c",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "bda7e38372e6dfe8",
        "order": 5,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Límite de corriente",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1610,
        "y": 860,
        "wires": []
    },
    {
        "id": "fd293b4d603e6934",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Reinicio de energía",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el contador de energía consumida?",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1320,
        "wires": [
            [
                "cad2f15ea9bc48a1"
            ]
        ]
    },
    {
        "id": "dcb7a5c21ab30897",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "bda7e38372e6dfe8",
        "order": 3,
        "width": 4,
        "height": 1,
        "name": "",
        "label": "Modo de voltaje",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 820,
        "wires": []
    },
    {
        "id": "7c0dafd214c2129a",
        "type": "link out",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "mode": "link",
        "links": [
            "731595afdc2c4872"
        ],
        "x": 1495,
        "y": 860,
        "wires": []
    },
    {
        "id": "731595afdc2c4872",
        "type": "link in",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "links": [
            "7c0dafd214c2129a"
        ],
        "x": 305,
        "y": 1260,
        "wires": [
            [
                "157271cb94c65adc"
            ]
        ]
    },
    {
        "id": "157271cb94c65adc",
        "type": "ui_dropdown",
        "z": "3c7bdc336f76b0ee",
        "name": "Cambio corriente",
        "label": "",
        "tooltip": "Cambiar el límite de corriente",
        "place": "",
        "group": "bda7e38372e6dfe8",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "multiple": false,
        "options": [
            {
                "label": "0.5 A",
                "value": "lc00",
                "type": "str"
            },
            {
                "label": "1 A",
                "value": "lc01",
                "type": "str"
            },
            {
                "label": "2 A",
                "value": "lc02",
                "type": "str"
            },
            {
                "label": "3 A",
                "value": "lc03",
                "type": "str"
            },
            {
                "label": "4 A",
                "value": "lc04",
                "type": "str"
            },
            {
                "label": "5 A",
                "value": "lc05",
                "type": "str"
            },
            {
                "label": "6 A",
                "value": "lc06",
                "type": "str"
            },
            {
                "label": "7 A",
                "value": "lc07",
                "type": "str"
            },
            {
                "label": "8 A",
                "value": "lc08",
                "type": "str"
            },
            {
                "label": "9 A",
                "value": "lc09",
                "type": "str"
            },
            {
                "label": "10 A (Máx)",
                "value": "lc10",
                "type": "str"
            }
        ],
        "payload": "",
        "topic": "Cambio en límite de corriente",
        "topicType": "str",
        "className": "",
        "x": 430,
        "y": 1260,
        "wires": [
            [
                "1bd08a45d5f13a90",
                "f3ec25a7204833e0"
            ]
        ]
    },
    {
        "id": "ceaf846b41f74744",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "mensaje vacio",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "DESCONECTADO",
                "fromt": "str",
                "to": "vo,co,po,fp,en,esN/A,mr,mv,lc,ipN/A",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 680,
        "y": 520,
        "wires": [
            [
                "a7623f13a401c7b6"
            ]
        ],
        "info": "Este mensaje simula haber recibido un mensaje de estado pero con valores nulos o vacíos para que se muestren en caso de perder la conexión con el dispositivo"
    },
    {
        "id": "4ca0c79ba387ad28",
        "type": "ui_button",
        "z": "3c7bdc336f76b0ee",
        "name": "Reinicio dispositivo",
        "group": "bda7e38372e6dfe8",
        "order": 8,
        "width": 4,
        "height": 1,
        "passthru": false,
        "label": "Reiniciar dispositivo",
        "tooltip": "Reiniciar el dispositivo de manera remota",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "refresh",
        "payload": "re",
        "payloadType": "str",
        "topic": "Reinicio del dispositivo",
        "topicType": "str",
        "x": 430,
        "y": 1380,
        "wires": [
            [
                "2a45254096a8c44e",
                "f3ec25a7204833e0"
            ]
        ]
    },
    {
        "id": "2a45254096a8c44e",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Reinicio dispositivo",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "¿Está seguro de que desea reiniciar el dispositivo? Esto hará que se corte el suminstro eléctrico, tome sus precauciones.",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 730,
        "y": 1380,
        "wires": [
            [
                "2b6ab5cba8e9fa6a"
            ]
        ]
    },
    {
        "id": "cad2f15ea9bc48a1",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1320,
        "wires": [
            [
                "fce452adfa936e9f"
            ]
        ]
    },
    {
        "id": "2b6ab5cba8e9fa6a",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "Aceptar",
        "cancel": "Cancelar",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "confirmar",
        "x": 920,
        "y": 1380,
        "wires": [
            [
                "0677998d96c3229f"
            ]
        ]
    },
    {
        "id": "fce452adfa936e9f",
        "type": "switch",
        "z": "3c7bdc336f76b0ee",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1320,
        "wires": [
            [
                "d35510f21492274c"
            ],
            [
                "738cdfc10de777e0"
            ]
        ]
    },
    {
        "id": "0677998d96c3229f",
        "type": "switch",
        "z": "3c7bdc336f76b0ee",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1380,
        "wires": [
            [
                "c68c90abec8621fc"
            ],
            [
                "738cdfc10de777e0"
            ]
        ]
    },
    {
        "id": "d35510f21492274c",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Aceptar reinicio Ener",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el contador de energía del dispositivo 10",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1300,
        "wires": [
            [
                "8637cb71cdd1b733"
            ]
        ]
    },
    {
        "id": "8637cb71cdd1b733",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1300,
        "wires": []
    },
    {
        "id": "c68c90abec8621fc",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Aceptar reinicio Disp",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se reiniciará el dispositivo 10",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1320,
        "y": 1340,
        "wires": [
            [
                "99250a8bfb9e3474"
            ]
        ]
    },
    {
        "id": "99250a8bfb9e3474",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1340,
        "wires": []
    },
    {
        "id": "385a42557c960cd1",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 7,
        "width": 0,
        "height": 0,
        "name": "voltaje resumen",
        "label": "Voltaje",
        "format": "{{msg.payload}} V",
        "layout": "row-spread",
        "className": "",
        "x": 1560,
        "y": 140,
        "wires": []
    },
    {
        "id": "4b133980a796b0ba",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "corriente resumen",
        "label": "Corriente",
        "format": "{{msg.payload}} A",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 260,
        "wires": []
    },
    {
        "id": "1886446532ea931f",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 9,
        "width": 0,
        "height": 0,
        "name": "potencia resumen",
        "label": "Potencia",
        "format": "{{msg.payload}} W",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 380,
        "wires": []
    },
    {
        "id": "67aafb4d14dd0d42",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 11,
        "width": 0,
        "height": 0,
        "name": "energia resumen",
        "label": "Consumo",
        "format": "{{msg.payload}} kWh",
        "layout": "row-spread",
        "className": "",
        "x": 1570,
        "y": 580,
        "wires": []
    },
    {
        "id": "c3fc309a12ad2d61",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 5,
        "width": 5,
        "height": 1,
        "name": "Estado suministro resumen",
        "label": "Estado suministro",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1600,
        "y": 700,
        "wires": []
    },
    {
        "id": "807b15a23d6daaca",
        "type": "ui_led",
        "z": "3c7bdc336f76b0ee",
        "order": 2,
        "group": "1ab945836557152a",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#ff0000",
                "value": "DESCONECTADO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "C. INTERRUMPIDA",
                "valueType": "str"
            },
            {
                "color": "#008000",
                "value": "CONECTADO",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "conexión resumen",
        "x": 690,
        "y": 640,
        "wires": []
    },
    {
        "id": "fce226b1b61b266b",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "conexión resumen",
        "label": "Estado conexión",
        "format": "",
        "layout": "row-spread",
        "className": "",
        "x": 690,
        "y": 680,
        "wires": []
    },
    {
        "id": "61a285961fc8512c",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "top right",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 0,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "aceptar",
        "x": 1500,
        "y": 1260,
        "wires": []
    },
    {
        "id": "829821611c799338",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "Aceptar cambio",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "Se cambiará el modo de operación del suministro eléctrico del dispositivo 10",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1300,
        "y": 1260,
        "wires": [
            [
                "61a285961fc8512c"
            ]
        ]
    },
    {
        "id": "20c1a0e08f2a1054",
        "type": "switch",
        "z": "3c7bdc336f76b0ee",
        "name": "selección",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Aceptar",
                "vt": "str"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 1080,
        "y": 1260,
        "wires": [
            [
                "829821611c799338"
            ],
            [
                "738cdfc10de777e0"
            ]
        ]
    },
    {
        "id": "0c1f0af56499a7df",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "e92599370e509ead",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "ID de dispositivo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 640,
        "wires": []
    },
    {
        "id": "7bf77e2cb32aedf8",
        "type": "function",
        "z": "3c7bdc336f76b0ee",
        "name": "Obtener ID y Alias",
        "func": "let dispositivos = global.get(\"dispositivos\");\nlet nombres = global.get(\"nombres\");\nlet msg1 = {};\nlet msg2 = {};\nlet msg3 = {};\n\n// Solo si el dispositivo seleccionado está registrado (!= null)\nif (dispositivos[10] != null){\n    //guardo el id del dispositivo para desuscribirme luego\n    //en caso de un cambio o desuscripción\n    flow.set(\"ultimodisp\", dispositivos[10]);\n    \n    //establezco el topico MQTT de testamento de dicho dispositivo\n    //y la acción es suscribirse a dicho topico\n    msg1.topic = \"omc/\" + dispositivos[10];\n    msg1.action = \"subscribe\";\n    \n    //obtengo el id del dispositivo\n    msg2.payload = dispositivos[10];\n    \n    //obtengo el alias del dispositivo\n    msg3.payload = nombres[10];\n}\nelse {\n    //en caso de que el dispositivo no esté registrado (== null)\n    //me desuscribo del topico MQTT de testamento del dispositivo\n    //anterior\n    msg1.topic = \"omc/\" + flow.get(\"ultimodisp\");\n    msg1.action = \"unsubscribe\";\n    \n    //el id mostrado será \"No registrado\"\n    msg2.payload = \"No registrado\";\n    \n    //no se mostrará ningún alias\n    msg3.payload = \"\";\n}\n\nreturn [msg1, msg2, msg3];\n\n//se envían 3 mensajes:\n//el primero contiene el tópico MQTT al que se tiene que suscribir\n//el siguiente nodo para recibir mensajes de testamento del\n//dispositivo indicado.\n//el segundo mensaje contiene el id del dispositivo indicado.\n//el tercer mensaje contiene el alias del dispositivio indicado.",
        "outputs": 3,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 130,
        "y": 660,
        "wires": [
            [
                "c303d7210f0ab65f"
            ],
            [
                "0c1f0af56499a7df",
                "3809d3353f8077d9"
            ],
            [
                "13612fed55517a4b",
                "452a76ebe08267f5"
            ]
        ]
    },
    {
        "id": "ad2715895493dde3",
        "type": "link in",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "links": [
            "181143468b3a713a"
        ],
        "x": 145,
        "y": 720,
        "wires": [
            [
                "7bf77e2cb32aedf8"
            ]
        ],
        "info": "Este nodo se actvia cuando se actualiza la lista\n\nCuando se actualiza la lista significa que algo cambió por lo que se actualiza el ID y el alias del dispositivo."
    },
    {
        "id": "a1c108ab190920ad",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "e92599370e509ead",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Dirección IP",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 900,
        "wires": []
    },
    {
        "id": "2beefb3d55d3cd8b",
        "type": "ui_led",
        "z": "3c7bdc336f76b0ee",
        "order": 6,
        "group": "1ab945836557152a",
        "width": 1,
        "height": 1,
        "label": "",
        "labelPlacement": "left",
        "labelAlignment": "left",
        "colorForValue": [
            {
                "color": "#008000",
                "value": "OPERATIVO",
                "valueType": "str"
            },
            {
                "color": "#ffa500",
                "value": "TIEMPO ESPERA",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BLOQUEO MANUAL",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "BAJO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTO VOLTAJE",
                "valueType": "str"
            },
            {
                "color": "#ff0000",
                "value": "ALTA CORRIENTE",
                "valueType": "str"
            },
            {
                "color": "#808080",
                "value": "null",
                "valueType": "str"
            }
        ],
        "allowColorForValueInMessage": false,
        "shape": "circle",
        "showGlow": false,
        "name": "estado suministro resumen",
        "x": 1600,
        "y": 740,
        "wires": []
    },
    {
        "id": "80b5ad46c79c6430",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "dirección IP",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "ip",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Dirección IP",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1290,
        "y": 900,
        "wires": [
            [
                "a1c108ab190920ad"
            ]
        ]
    },
    {
        "id": "c303d7210f0ab65f",
        "type": "mqtt in",
        "z": "3c7bdc336f76b0ee",
        "name": "estado conexión (testamento)",
        "topic": "",
        "qos": "2",
        "datatype": "utf8",
        "broker": "10e78a89.5b4fd5",
        "nl": false,
        "rap": true,
        "rh": 0,
        "inputs": 1,
        "x": 380,
        "y": 580,
        "wires": [
            [
                "877a0909919be5ad",
                "807b15a23d6daaca",
                "911e658125aa20cc",
                "ceaf846b41f74744"
            ]
        ],
        "info": "Se establece dinámicamente el tópico MQTT al que se tiene que suscribir el nodo para recibir mensajes de testamento del dispositivo indicado.\n\nSolo hay dos mensajes que se pueden obtener de este tópico: \"CONECTADO\" O \"DESCONECTADO\"."
    },
    {
        "id": "41b1d7edcb6332ab",
        "type": "function",
        "z": "3c7bdc336f76b0ee",
        "name": "segundos a DD HH:MM:SS",
        "func": "//Convertir segundos en formato días, horas, minutos y segundos.\n\nlet totalNumberOfSeconds = msg.payload;\nlet days = parseInt( totalNumberOfSeconds / 86400 );\nlet hours = parseInt (( totalNumberOfSeconds - ( days * 86400 )) / 3600  );\nlet minutes = parseInt ((totalNumberOfSeconds - ((hours * 3600)+( days * 86400 ))) / 60 );\nlet seconds = parseInt(totalNumberOfSeconds - ((hours * 3600) + (minutes * 60)+( days * 86400 )));\nlet result = (days < 10 ? \"0\" + days : days) + \"d \" + (hours < 10 ? \"0\" + hours : hours) + \":\" + (minutes < 10 ? \"0\" + minutes : minutes) + \":\" + (seconds  < 10 ? \"0\" + seconds : seconds);\n\nmsg.payload = result;\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1460,
        "y": 940,
        "wires": [
            [
                "4305eed3df8de99f"
            ]
        ]
    },
    {
        "id": "4305eed3df8de99f",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "e92599370e509ead",
        "order": 6,
        "width": 0,
        "height": 0,
        "name": "Uptime",
        "label": "Tiempo operativo",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1650,
        "y": 940,
        "wires": []
    },
    {
        "id": "d7606ecee68f5096",
        "type": "change",
        "z": "3c7bdc336f76b0ee",
        "name": "uptime",
        "rules": [
            {
                "t": "change",
                "p": "payload",
                "pt": "msg",
                "from": "up",
                "fromt": "str",
                "to": "",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "topic",
                "pt": "msg",
                "to": "Uptime",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1270,
        "y": 940,
        "wires": [
            [
                "41b1d7edcb6332ab"
            ]
        ]
    },
    {
        "id": "4518276a78e11f22",
        "type": "ui_toast",
        "z": "3c7bdc336f76b0ee",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": false,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "mensaje",
        "x": 700,
        "y": 1440,
        "wires": [
            []
        ]
    },
    {
        "id": "f76a5a08e0cd3eef",
        "type": "ui_button",
        "z": "3c7bdc336f76b0ee",
        "name": "ayuda",
        "group": "bda7e38372e6dfe8",
        "order": 10,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "Mostrar ayuda",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "info",
        "payload": "<p> <b>Modos de control de suministro</b> <ul>   <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>   <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li> </ul>   <b>Modos de voltaje</b> <ul>   <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>   <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li> </ul>   <b>Límite de corriente</b><br> El suministro se cortará una vez la corriente alcance el límite seleccionado.<br> <br>  <b>Reiniciar dispositivo</b><br> Permite reiniciar el dispositivo de manera remota.<br> <br>  <b>Reiniciar energía</b><br> Permite reiniciar el contador de consumo de energía.<br> </p>",
        "payloadType": "str",
        "topic": "Ayuda",
        "topicType": "str",
        "x": 470,
        "y": 1440,
        "wires": [
            [
                "4518276a78e11f22"
            ]
        ],
        "info": "<p>\n<b>Modos de control de suministro</b>\n<ul>\n  <li><b>Automático:</b> El suministro eléctrico estará activo si el voltaje y la corriente están dentro de los rangos especificados. Habrá un tiempo de espera una vez estos lleguen a un nivel adecuado.</li>\n  <li><b>Bloqueo manual:</b> El suministro se cortará y no se reanudará sino hasta que se cambie este modo.</li>\n</ul> \n<br>\n\n<b>Modos de voltaje</b>\n<ul>\n  <li><b>120 V:</b> Valores aceptados de voltaje 120 V &#177;15%.</li>\n  <li><b>220 V:</b> Valores aceptados de voltaje 220 V &#177;15%.</li>\n</ul> \n<br>\n\n<b>Límite de corriente</b><br>\nEl suministro se cortará una vez la corriente alcance el límite seleccionado.<br>\n<br>\n\n<b>Reiniciar dispositivo</b><br>\nPermite reiniciar el dispositivo de manera remota.<br>\n<br>\n\n<b>Reiniciar energía</b><br>\nPermite reiniciar el contador de consumo de energía.<br>\n</p>\n"
    },
    {
        "id": "13612fed55517a4b",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "e92599370e509ead",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 350,
        "y": 720,
        "wires": []
    },
    {
        "id": "c032869c16df015b",
        "type": "comment",
        "z": "3c7bdc336f76b0ee",
        "name": "Llegada mensaje MQTT",
        "info": "",
        "x": 150,
        "y": 420,
        "wires": []
    },
    {
        "id": "7949335e571da9c6",
        "type": "comment",
        "z": "3c7bdc336f76b0ee",
        "name": "Mostrar datos de estado",
        "info": "",
        "x": 1570,
        "y": 20,
        "wires": []
    },
    {
        "id": "785e25916eb705ec",
        "type": "comment",
        "z": "3c7bdc336f76b0ee",
        "name": "Manejo de botones y control",
        "info": "Se utiliza un habilitador que se envía en caso de que se acepte (confirme) el cambio según el botón que se presionó",
        "x": 980,
        "y": 1020,
        "wires": []
    },
    {
        "id": "3809d3353f8077d9",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "id resumen",
        "label": "ID",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 370,
        "y": 680,
        "wires": []
    },
    {
        "id": "452a76ebe08267f5",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "alias resumen",
        "label": "Alias",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 380,
        "y": 760,
        "wires": []
    },
    {
        "id": "c98668f504112eef",
        "type": "ui_text",
        "z": "3c7bdc336f76b0ee",
        "group": "1ab945836557152a",
        "order": 10,
        "width": 0,
        "height": 0,
        "name": "fp resumen",
        "label": "F. potencia",
        "format": "{{msg.payload}}",
        "layout": "row-spread",
        "className": "",
        "x": 1550,
        "y": 500,
        "wires": []
    },
    {
        "id": "30d81cdf46708d68",
        "type": "inject",
        "z": "3c7bdc336f76b0ee",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "5",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 110,
        "y": 600,
        "wires": [
            [
                "7bf77e2cb32aedf8"
            ]
        ]
    }
]